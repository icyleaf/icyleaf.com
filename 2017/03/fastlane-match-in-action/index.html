<!doctype html><html lang=zh dir=auto></html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>你虐我千百遍，我待你如初恋，直到我遇到 match | icyleaf</title><meta name=keywords content="iOS,Android,CI,CD,Ruby,Fastlane,match"><meta name=description content="系列文章的第三篇，教你如何使用 match 管理名词都分不清的苹果各自开发者证书"><meta name=author content="icyleaf"><link rel=canonical href=https://icyleaf.com/2017/03/fastlane-match-in-action/><link rel=icon href=https://icyleaf.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://icyleaf.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://icyleaf.com/favicon-32x32.png><link rel=icon type=image/png sizes=192x192 href=https://icyleaf.com/android-chrome-192x192.png><link rel=icon type=image/png sizes=512x512 href=https://icyleaf.com/android-chrome-512x512.png><link rel=apple-touch-icon href=https://icyleaf.com/apple-touch-icon.png><link rel=mask-icon href=https://icyleaf.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=stylesheet href=https://icyleaf.com/css/main.min.css><link rel=stylesheet href=https://icyleaf.com/font/iconfont.min.css><link rel=stylesheet href=https://icyleaf.com/font-ali/iconfont.min.css><link rel=stylesheet href=https://icyleaf.com/photoswipe/photoswipe.min.css><link rel=canonical href=https://icyleaf.com/2017/03/fastlane-match-in-action/><meta property="og:title" content="你虐我千百遍，我待你如初恋，直到我遇到 match"><meta property="og:description" content="系列文章的第三篇，教你如何使用 match 管理名词都分不清的苹果各自开发者证书"><meta property="og:type" content="article"><meta property="og:url" content="https://icyleaf.com/2017/03/fastlane-match-in-action/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2017-03-28T20:12:07+08:00"><meta property="article:modified_time" content="2017-03-28T20:12:07+08:00"><meta property="og:see_also" content="https://icyleaf.com/2016/07/fastlane-in-action/"><meta property="og:see_also" content="https://icyleaf.com/2016/07/intro-fastlane-automation-for-ios-and-android/"><meta name=twitter:card content="summary"><meta name=twitter:title content="你虐我千百遍，我待你如初恋，直到我遇到 match"><meta name=twitter:description content="系列文章的第三篇，教你如何使用 match 管理名词都分不清的苹果各自开发者证书"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://icyleaf.com/posts/"},{"@type":"ListItem","position":2,"name":"你虐我千百遍，我待你如初恋，直到我遇到 match","item":"https://icyleaf.com/2017/03/fastlane-match-in-action/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"你虐我千百遍，我待你如初恋，直到我遇到 match","name":"你虐我千百遍，我待你如初恋，直到我遇到 match","description":"系列文章的第三篇，教你如何使用 match 管理名词都分不清的苹果各自开发者证书","keywords":["iOS","Android","CI","CD","Ruby","Fastlane","match"],"articleBody":"前言 通过前两篇的文章大家已经对 fastlane 的概念和基本使用已经有了初步的掌握，在第二篇中也有提到 fastlane 实现的各种功能其实都是基于独立封装设计的各个工具实现。它们即可以单独成为一个体系同时也会被吸纳到 fastlane 的 action 系统之中。match 是在 iOS 开发和持续测试和构建中最重中之重的环节，它维护和管理着 iOS 的各种证书和 profile 的创建、更新工作。想必很多用户听到 iOS 证书和 profile 都会头大脑涨，恨不得要手撕鬼子的技能点来对付他们（如图）\n上图来源于作者专门整理的网站 https://codesigning.guide/，对于 iOS App 签名原理感兴趣的可以参见 JSPatch 作者的分析：http://blog.cnbang.net/tech/3386/\n功能特性 主动/被动创建、更新、Xcode 所需的各种证书和打包所需的 Profiles 托管 Xcode 所需的各种证书和打包所需的 Profiles 统一并共享团队成员统一使用 证书具有密码加密保护（openssl） 支持多团队（账户） 支持单 App 多 Target(identifier) 内测支持企业账户（v0.11.0 还在测试可用，并没有正式支持） 原理 match 其实是在 fastlane 基础包 cert、sign、spaceship、credentials_manager 之上把 iOS 开发者证书流程化的工具。为了实现团队内共享项目的开发者证书，它使用 git 仓库对证书进行托管，首先需要进行初始化，配置 git 仓库、项目的 iDP 信息之后，下载 Development、AppStore、AdHoc 的开发者证书和项目的 Profile files，并通过 openssl 的方式进行安全加密后提交并推送到 git 仓库，其他成员（或自动化构建系统）使用时需要输入密钥后才能把证书解密并导入到 keychain 和 Profiles 目录。\n如果对于证书加密策略感兴趣的可以在本文底部资料参考的第一个链接查看详情。\n使用 最新 fastlane 已经包含了所有的子模块，独立的 match 不在更新，请直接安装 fastlane，使用 fastlane match 代替 match 命令。\n安装就很简单通过 gem install fastlane 会把它的全家桶一并下载安装，首先可以看下帮助：\n1$ fastlane match --help 2 3 match 4 5 Easily sync your certificates and profiles across your team using git 6 7 Commands: 8 adhoc Run match for a adhoc provisioning profile 9 appstore Run match for a appstore provisioning profile 10 change_password Re-encrypt all files with a different password 11 decrypt Decrypts the repository and keeps it on the filesystem 12 development Run match for a development provisioning profile 13 help Display global or [command] help documentation 14 init Create the Matchfile for you 15 nuke Delete all certificates and provisioning profiles from the Apple Dev Portal 16 nuke development Delete all certificates and provisioning profiles from the Apple Dev Portal of the type development 17 nuke distribution Delete all certificates and provisioning profiles from the Apple Dev Portal of the type distribution 18 run Easily sync your certificates and profiles across your team using git 19 20 Global Options: 21 --verbose 22 -r, --git_url STRING URL to the git repo containing all the certificates (MATCH_GIT_URL) 23 --git_branch STRING Specific git branch to use (MATCH_GIT_BRANCH) 24 -y, --type STRING Create a development certificate instead of a distribution one (MATCH_TYPE) 25 -a, --app_identifier [VALUE] The bundle identifier(s) of your app (comma-separated) (MATCH_APP_IDENTIFIER) 26 -u, --username STRING Your Apple ID Username (MATCH_USERNAME) 27 -s, --keychain_name STRING Keychain the items should be imported to (MATCH_KEYCHAIN_NAME) 28 -p, --keychain_password STRING This might be required the first time you access certificates on a new mac. For the login/default keychain this is your account password (MATCH_KEYCHAIN_PASSWORD) 29 --readonly [VALUE] Only fetch existing certificates and profiles, don't generate new ones (MATCH_READONLY) 30 -b, --team_id STRING The ID of your Developer Portal team if you're in multiple teams (FASTLANE_TEAM_ID) 31 -l, --team_name STRING The name of your Developer Portal team if you're in multiple teams (FASTLANE_TEAM_NAME) 32 --verbose [VALUE] Print out extra information and all commands (MATCH_VERBOSE) 33 --force [VALUE] Renew the provisioning profiles every time you run match (MATCH_FORCE) 34 --skip_confirmation [VALUE] Disables confirmation prompts during nuke, answering them with yes (MATCH_SKIP_CONFIRMATION) 35 --shallow_clone [VALUE] Make a shallow clone of the repository (truncate the history to 1 revision) (MATCH_SHALLOW_CLONE) 36 --force_for_new_devices [VALUE] Renew the provisioning profiles if the device count on the developer portal has changed (MATCH_FORCE_FOR_NEW_DEVICES) 37 --skip_docs [VALUE] Skip generation of a README.md for the created git repository (MATCH_SKIP_DOCS) 38 -h, --help Display help documentation 39 -v, --version Display version information 建议大家在项目中创建并配置 fastlane/Matchfile 文件可以把命令需要的参数省略：\n1$ fastlane match init 设置好 git_url(git 仓库地址）、type（默认同步证书类型）、app_identifier、username（iDP 的账户名）即可。\n生成和同步证书 1# 开发环境证书 2$ fastlane match development 3# 产品环境证书 4$ fastlane match appstore 5# 内测环境证书 6$ fastlane match adhoc 初次使用的时候会提示需要输入 iDP 的账户密码，校验成功后可以保存到 keychain 中后续可以不在重复输入（好贴心）密码（也可通过设置变量 FASTLANE_PASSWORD），该密码就是上面提到的证书加密的密钥，请妥善保存。\n提示：如果担心密码泄露可设置 FASTLANE_DONT_STORE_PASSWORD = true 不进行密码保存至 keychain，在 keychain 可通过关键词 “deliver.” 检索。\n有的童鞋说我们有 299 的企业证书，为什么不做支持呢？起初作者并没有打算进行支持是担心滥用以及代码结构需要较大的变更，随着开发者呼声太高，其实还是做了支持，只不过并没有正式的纳入，需要通过配置环境变量支持：\n1# 企业环境证书 2$ ENV['MATCH_FORCE_ENTERPRISE'] = '1' \u0026\u0026 fastlane match enterprise 修改密钥 建议密码定期更换或再人员发生变更之后进行密码变更：\n1$ fastlane match change_password 重新生成 慎用：match 提供一个命令允许把当前的证书撤销后并全新的重新生成一份，这个事项是会把证书和 Profiles 全部包含在内，如果单纯的想只重设 Profles 并同步是不支持的。我想这也是为什么该命名叫做 nuke\n我这里可给大家提供一种只同步 profile 的方法：首先在 git 仓库中找到你要重设的 profile 文件，并把它从仓库中删除提交，然后在执行该类型的命令即可，命令发现没有 profile 会自动再生成一个 profile 并下载同步至 git 仓库。\n资料参考 http://macoscope.com/blog/simplify-your-life-with-fastlane-match/ https://github.com/fastlane/fastlane/issues/2007 ","wordCount":"1784","inLanguage":"zh","datePublished":"2017-03-28T20:12:07+08:00","dateModified":"2017-03-28T20:12:07+08:00","author":{"@type":"Person","name":"icyleaf"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://icyleaf.com/2017/03/fastlane-match-in-action/"},"publisher":{"@type":"Organization","name":"icyleaf","logo":{"@type":"ImageObject","url":"https://icyleaf.com/favicon.ico"}}}</script></head><body><div class=wrapper><nav class=navbar><progress class=content_progress max=0 value=0></progress><div class=container><div class="navbar-header header-logo"><a href=https://icyleaf.com/>icyleaf</a></div><div class=navbar-right><span class=menu><a class=menu-item href=https://icyleaf.com/about title>About</a>
<a class=menu-item href=https://icyleaf.com/projects title>Projects</a>
<a class=menu-item href=https://icyleaf.com/index.xml title>Feed</a>
<span class=divide></span>
<a href=javascript:void(0); class=theme-switch><i class="iconfont icon-dark-mode"></i></a></span></div></div></nav><nav class=navbar-mobile id=nav-mobile style=display:none><progress class=content_progress max=0 value=0></progress><div class=container><div class=navbar><div class="navbar-header header-logo"><a href=https://icyleaf.com/>icyleaf</a></div><div class=navbar-right><div><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-dark-mode"></i></a></div><div class=menu-toggle><span></span><span></span><span></span></div></div></div><div class=menu id=mobile-menu><nav class=mb-md><a class=menu-item href=https://icyleaf.com/about title><h3>About</h3><div class=menu-active></div></a><a class=menu-item href=https://icyleaf.com/projects title><h3>Projects</h3><div class=menu-active></div></a><a class=menu-item href=https://icyleaf.com/index.xml title><h3>Feed</h3><div class=menu-active></div></a></nav></div></div></nav><main class=main><div class=post-cover><img src=https://icyleaf.com/uploads/2017/03/28/match.png loading=lazy></div><div class=container><article class=post-warp itemscope itemtype=http://schema.org/Article><header class=post-header><h1 class=post-title itemprop=description>你虐我千百遍，我待你如初恋，直到我遇到 match</h1><div class=post-description>系列文章的第三篇，教你如何使用 match 管理名词都分不清的苹果各自开发者证书</div><div class=post-meta><time datetime=2017-03-28 itemprop=datePublished>2017-03-28</time>
·
<span class=tags>iOS, Android, CI, CD, Ruby, Fastlane, match</span>
·
<span class=post-word-count>1784 words · 8 minutes</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>目录</h2><div class="post-toc-content always-active"><nav id=TableOfContents><ul><li><a href=#前言>前言</a></li><li><a href=#功能特性>功能特性</a></li><li><a href=#原理>原理</a></li><li><a href=#使用>使用</a></li><li><a href=#生成和同步证书>生成和同步证书</a></li><li><a href=#修改密钥>修改密钥</a></li><li><a href=#重新生成>重新生成</a></li><li><a href=#资料参考>资料参考</a></li></ul></nav></div></div><div class=post-content><div class=post-series><h4 class=series-title><a href=https://icyleaf.com/series/fastlane/>fastlane（3 篇）</a></h4><ol class=series-list><li class=series-item><a href=https://icyleaf.com/2016/07/intro-fastlane-automation-for-ios-and-android/>Fastlane - iOS 和 Android 的自动化构建工具</a></li><li class=series-item><a href=https://icyleaf.com/2016/07/fastlane-in-action/>深入浅出 Fastlane 一看你就懂</a></li><li class=series-item><span class=current-serie>你虐我千百遍，我待你如初恋，直到我遇到 match</span></li></ol></div><div id=post-gallery><h2 id=前言>前言</h2><p>通过前两篇的文章大家已经对 fastlane 的概念和基本使用已经有了初步的掌握，在第二篇中也有提到 fastlane 实现的各种功能其实都是基于独立封装设计的各个工具实现。它们即可以单独成为一个体系同时也会被吸纳到 fastlane 的 action 系统之中。<code>match</code> 是在 iOS 开发和持续测试和构建中最重中之重的环节，它维护和管理着 iOS 的各种证书和 profile 的创建、更新工作。想必很多用户听到 iOS 证书和 profile 都会头大脑涨，恨不得要手撕鬼子的技能点来对付他们（如图）</p><p><img loading=lazy src=https://codesigning.guide/assets/img/cs-the-problem.png alt=code-signing-problem></img></p><p>上图来源于作者专门整理的网站 <a href=https://codesigning.guide/>https://codesigning.guide/</a>，对于 iOS App 签名原理感兴趣的可以参见 JSPatch 作者的分析：http://blog.cnbang.net/tech/3386/</p><h2 id=功能特性>功能特性</h2><ol><li>主动/被动创建、更新、Xcode 所需的各种证书和打包所需的 Profiles</li><li>托管 Xcode 所需的各种证书和打包所需的 Profiles</li><li>统一并共享团队成员统一使用</li><li>证书具有密码加密保护（openssl）</li><li>支持多团队（账户）</li><li>支持单 App 多 Target(identifier)</li><li>内测支持企业账户（v0.11.0 还在测试可用，并没有正式支持）</li></ol><h2 id=原理>原理</h2><p>match 其实是在 fastlane 基础包 cert、sign、spaceship、credentials_manager 之上把 iOS 开发者证书流程化的工具。为了实现团队内共享项目的开发者证书，它使用 git 仓库对证书进行托管，首先需要进行初始化，配置 git 仓库、项目的 iDP 信息之后，下载 Development、AppStore、AdHoc 的开发者证书和项目的 Profile files，并通过 openssl 的方式进行安全加密后提交并推送到 git 仓库，其他成员（或自动化构建系统）使用时需要输入密钥后才能把证书解密并导入到 keychain 和 Profiles 目录。</p><p>如果对于证书加密策略感兴趣的可以在本文底部资料参考的第一个链接查看详情。</p><h2 id=使用>使用</h2><blockquote><p>最新 fastlane 已经包含了所有的子模块，独立的 match 不在更新，请直接安装 fastlane，使用 fastlane match 代替 match 命令。</p></blockquote><p>安装就很简单通过 <code>gem install fastlane</code> 会把它的全家桶一并下载安装，首先可以看下帮助：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln> 1</span><span class=cl>$ fastlane match --help
</span></span><span class=line><span class=ln> 2</span><span class=cl>
</span></span><span class=line><span class=ln> 3</span><span class=cl>  match
</span></span><span class=line><span class=ln> 4</span><span class=cl>
</span></span><span class=line><span class=ln> 5</span><span class=cl>  Easily sync your certificates and profiles across your team using git
</span></span><span class=line><span class=ln> 6</span><span class=cl>
</span></span><span class=line><span class=ln> 7</span><span class=cl>  Commands:
</span></span><span class=line><span class=ln> 8</span><span class=cl>    adhoc             Run match <span class=k>for</span> a adhoc provisioning profile
</span></span><span class=line><span class=ln> 9</span><span class=cl>    appstore          Run match <span class=k>for</span> a appstore provisioning profile
</span></span><span class=line><span class=ln>10</span><span class=cl>    change_password   Re-encrypt all files with a different password
</span></span><span class=line><span class=ln>11</span><span class=cl>    decrypt           Decrypts the repository and keeps it on the filesystem
</span></span><span class=line><span class=ln>12</span><span class=cl>    development       Run match <span class=k>for</span> a development provisioning profile
</span></span><span class=line><span class=ln>13</span><span class=cl>    <span class=nb>help</span>              Display global or <span class=o>[</span>command<span class=o>]</span> <span class=nb>help</span> documentation
</span></span><span class=line><span class=ln>14</span><span class=cl>    init              Create the Matchfile <span class=k>for</span> you
</span></span><span class=line><span class=ln>15</span><span class=cl>    nuke              Delete all certificates and provisioning profiles from the Apple Dev Portal
</span></span><span class=line><span class=ln>16</span><span class=cl>    nuke development  Delete all certificates and provisioning profiles from the Apple Dev Portal of the <span class=nb>type</span> development
</span></span><span class=line><span class=ln>17</span><span class=cl>    nuke distribution Delete all certificates and provisioning profiles from the Apple Dev Portal of the <span class=nb>type</span> distribution
</span></span><span class=line><span class=ln>18</span><span class=cl>    run               Easily sync your certificates and profiles across your team using git
</span></span><span class=line><span class=ln>19</span><span class=cl>
</span></span><span class=line><span class=ln>20</span><span class=cl>  Global Options:
</span></span><span class=line><span class=ln>21</span><span class=cl>    --verbose
</span></span><span class=line><span class=ln>22</span><span class=cl>    -r, --git_url STRING URL to the git repo containing all the certificates <span class=o>(</span>MATCH_GIT_URL<span class=o>)</span>
</span></span><span class=line><span class=ln>23</span><span class=cl>    --git_branch STRING  Specific git branch to use <span class=o>(</span>MATCH_GIT_BRANCH<span class=o>)</span>
</span></span><span class=line><span class=ln>24</span><span class=cl>    -y, --type STRING    Create a development certificate instead of a distribution one <span class=o>(</span>MATCH_TYPE<span class=o>)</span>
</span></span><span class=line><span class=ln>25</span><span class=cl>    -a, --app_identifier <span class=o>[</span>VALUE<span class=o>]</span> The bundle identifier<span class=o>(</span>s<span class=o>)</span> of your app <span class=o>(</span>comma-separated<span class=o>)</span> <span class=o>(</span>MATCH_APP_IDENTIFIER<span class=o>)</span>
</span></span><span class=line><span class=ln>26</span><span class=cl>    -u, --username STRING Your Apple ID Username <span class=o>(</span>MATCH_USERNAME<span class=o>)</span>
</span></span><span class=line><span class=ln>27</span><span class=cl>    -s, --keychain_name STRING Keychain the items should be imported to <span class=o>(</span>MATCH_KEYCHAIN_NAME<span class=o>)</span>
</span></span><span class=line><span class=ln>28</span><span class=cl>    -p, --keychain_password STRING This might be required the first <span class=nb>time</span> you access certificates on a new mac. For the login/default keychain this is your account password <span class=o>(</span>MATCH_KEYCHAIN_PASSWORD<span class=o>)</span>
</span></span><span class=line><span class=ln>29</span><span class=cl>    --readonly <span class=o>[</span>VALUE<span class=o>]</span>   Only fetch existing certificates and profiles, don<span class=s1>&#39;t generate new ones (MATCH_READONLY)
</span></span></span><span class=line><span class=ln>30</span><span class=cl><span class=s1>    -b, --team_id STRING The ID of your Developer Portal team if you&#39;</span>re in multiple teams <span class=o>(</span>FASTLANE_TEAM_ID<span class=o>)</span>
</span></span><span class=line><span class=ln>31</span><span class=cl>    -l, --team_name STRING The name of your Developer Portal team <span class=k>if</span> you<span class=err>&#39;</span>re in multiple teams <span class=o>(</span>FASTLANE_TEAM_NAME<span class=o>)</span>
</span></span><span class=line><span class=ln>32</span><span class=cl>    --verbose <span class=o>[</span>VALUE<span class=o>]</span>    Print out extra information and all commands <span class=o>(</span>MATCH_VERBOSE<span class=o>)</span>
</span></span><span class=line><span class=ln>33</span><span class=cl>    --force <span class=o>[</span>VALUE<span class=o>]</span>      Renew the provisioning profiles every <span class=nb>time</span> you run match <span class=o>(</span>MATCH_FORCE<span class=o>)</span>
</span></span><span class=line><span class=ln>34</span><span class=cl>    --skip_confirmation <span class=o>[</span>VALUE<span class=o>]</span> Disables confirmation prompts during nuke, answering them with yes <span class=o>(</span>MATCH_SKIP_CONFIRMATION<span class=o>)</span>
</span></span><span class=line><span class=ln>35</span><span class=cl>    --shallow_clone <span class=o>[</span>VALUE<span class=o>]</span> Make a shallow clone of the repository <span class=o>(</span>truncate the <span class=nb>history</span> to <span class=m>1</span> revision<span class=o>)</span> <span class=o>(</span>MATCH_SHALLOW_CLONE<span class=o>)</span>
</span></span><span class=line><span class=ln>36</span><span class=cl>    --force_for_new_devices <span class=o>[</span>VALUE<span class=o>]</span> Renew the provisioning profiles <span class=k>if</span> the device count on the developer portal has changed <span class=o>(</span>MATCH_FORCE_FOR_NEW_DEVICES<span class=o>)</span>
</span></span><span class=line><span class=ln>37</span><span class=cl>    --skip_docs <span class=o>[</span>VALUE<span class=o>]</span>  Skip generation of a README.md <span class=k>for</span> the created git repository <span class=o>(</span>MATCH_SKIP_DOCS<span class=o>)</span>
</span></span><span class=line><span class=ln>38</span><span class=cl>    -h, --help           Display <span class=nb>help</span> documentation
</span></span><span class=line><span class=ln>39</span><span class=cl>    -v, --version        Display version information
</span></span></code></pre></div><p>建议大家在项目中创建并配置 <code>fastlane/Matchfile</code> 文件可以把命令需要的参数省略：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>$ fastlane match init
</span></span></code></pre></div><p>设置好 git_url(git 仓库地址）、type（默认同步证书类型）、app_identifier、username（iDP 的账户名）即可。</p><h2 id=生成和同步证书>生成和同步证书</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl><span class=c1># 开发环境证书</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>$ fastlane match development
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=c1># 产品环境证书</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>$ fastlane match appstore
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=c1># 内测环境证书</span>
</span></span><span class=line><span class=ln>6</span><span class=cl>$ fastlane match adhoc
</span></span></code></pre></div><p>初次使用的时候会提示需要输入 iDP 的账户密码，校验成功后可以保存到 keychain 中后续可以不在重复输入（好贴心）密码（也可通过设置变量 FASTLANE_PASSWORD），该密码就是上面提到的证书加密的密钥，请妥善保存。</p><blockquote><p>提示：如果担心密码泄露可设置 FASTLANE_DONT_STORE_PASSWORD = true 不进行密码保存至 keychain，在 keychain 可通过关键词 &ldquo;deliver.&rdquo; 检索。</p></blockquote><p>有的童鞋说我们有 299 的企业证书，为什么不做支持呢？起初作者并没有打算进行支持是担心滥用以及代码结构需要较大的变更，随着开发者呼声太高，其实还是做了支持，只不过并没有正式的纳入，需要通过配置环境变量支持：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl><span class=c1># 企业环境证书</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>$ ENV<span class=o>[</span><span class=s1>&#39;MATCH_FORCE_ENTERPRISE&#39;</span><span class=o>]</span> <span class=o>=</span> <span class=s1>&#39;1&#39;</span> <span class=o>&amp;&amp;</span> fastlane match enterprise
</span></span></code></pre></div><h2 id=修改密钥>修改密钥</h2><p>建议密码定期更换或再人员发生变更之后进行密码变更：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>$ fastlane match change_password
</span></span></code></pre></div><h2 id=重新生成>重新生成</h2><p><strong>慎用</strong>：match 提供一个命令允许把当前的证书撤销后并全新的重新生成一份，这个事项是会把证书和 Profiles 全部包含在内，如果单纯的想只重设 Profles 并同步是不支持的。我想这也是为什么该命名叫做 <code>nuke</code></p><p>我这里可给大家提供一种只同步 profile 的方法：首先在 git 仓库中找到你要重设的 profile 文件，并把它从仓库中删除提交，然后在执行该类型的命令即可，命令发现没有 profile 会自动再生成一个 profile 并下载同步至 git 仓库。</p><h2 id=资料参考>资料参考</h2><ul><li><a href=http://macoscope.com/blog/simplify-your-life-with-fastlane-match/>http://macoscope.com/blog/simplify-your-life-with-fastlane-match/</a></li><li><a href=https://github.com/fastlane/fastlane/issues/2007>https://github.com/fastlane/fastlane/issues/2007</a></li></ul></div></div><div class=post-nav><a href=https://icyleaf.com/2017/03/how-to-get-temporary-car-license-in-beijing/ class=prev rel=prev title=北京上临时牌照流程><i class="iconfont icon-left"></i>&nbsp;北京上临时牌照流程</a>
<a href=https://icyleaf.com/2017/04/sidekiq-works-in-ruby-togethor-with-crystal/ class=next rel=next title="打通 Sidekiq 的任督二脉 Ruby 和 Crystal">打通 Sidekiq 的任督二脉 Ruby 和 Crystal&nbsp;<i class="iconfont icon-right"></i></a></div><div class=post-comment><script src=https://giscus.app/client.js data-repo=icyleaf/icyleaf.com data-repo-id="MDEwOlJlcG9zaXRvcnk1NDg4MDA5Mg==" data-category=Announcements data-category-id=DIC_kwDOA0VnXM4CQ0mH data-mapping=title data-strict=0 data-reactions-enabled="MDEwOlJlcG9zaXRvcnk1NDg4MDA5Mg==" data-emit-metadata=0 data-input-position=top data-theme=preferred_color_scheme data-lang=zh-CN data-loading=lazy crossorigin=anonymous async></script></div></article></div></main><footer class=footer><div class=copyright>&copy;
<span itemprop=copyrightYear>2005 - 2022</span>
<span>🍺</span>
<span class=author itemprop=copyrightHolder><a href=https://icyleaf.com/>icyleaf</a></span></div></footer><script defer src=https://fastly.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.min.js crossorigin=anonymous></script>
<script defer src=https://icyleaf.com/js/vendor_main.min.js></script>
<script type=module>
  
  import PhotoSwipeLightbox from '\/photoswipe\/photoswipe-lightbox.esm.js';

  const lightbox = new PhotoSwipeLightbox({
    gallery: '#post-gallery',
    children: 'a.gallery-item',
    pswpModule: () => import('\/photoswipe\/photoswipe.esm.js'),
  });
  lightbox.init();
</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-TKQBZ7R259"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-TKQBZ7R259")</script></div></body></html>