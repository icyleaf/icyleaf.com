<!doctype html><html lang=zh-cn></html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Docker æ‘¸çˆ¬æ»šæ‰“å¯¹æŠ— CentOS 6 | icyleaf</title><meta name=keywords content="docker,centos"><meta name=description content="èƒ½ä¸ç”¨ CentOS å°±åˆ«äº†å§ï¼Œå•Šä¸è¡Œï¼Ÿé‚£å°±ç‚¹è¿›æ¥çœ‹çœ‹å§"><meta name=author content="icyleaf"><link rel=canonical href=https://icyleaf.com/2016/12/docker-with-centos/><link rel=icon href=https://icyleaf.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://icyleaf.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://icyleaf.com/favicon-32x32.png><link rel=icon type=image/png sizes=192x192 href=https://icyleaf.com/android-chrome-192x192.png><link rel=icon type=image/png sizes=512x512 href=https://icyleaf.com/android-chrome-512x512.png><link rel=apple-touch-icon href=https://icyleaf.com/apple-touch-icon.png><link rel=mask-icon href=https://icyleaf.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=stylesheet href=https://icyleaf.com/css/main.min.css><link rel=stylesheet href=https://icyleaf.com/font/iconfont.min.css><link rel=stylesheet href=https://icyleaf.com/font-ali/iconfont.min.css><link rel=stylesheet href=https://icyleaf.com/photoswipe/photoswipe.min.css><link rel=canonical href=https://icyleaf.com/2016/12/docker-with-centos/><meta property="og:title" content="Docker æ‘¸çˆ¬æ»šæ‰“å¯¹æŠ— CentOS 6"><meta property="og:description" content="èƒ½ä¸ç”¨ CentOS å°±åˆ«äº†å§ï¼Œå•Šä¸è¡Œï¼Ÿé‚£å°±ç‚¹è¿›æ¥çœ‹çœ‹å§"><meta property="og:type" content="article"><meta property="og:url" content="https://icyleaf.com/2016/12/docker-with-centos/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2016-12-30T17:52:30+08:00"><meta property="article:modified_time" content="2016-12-30T17:52:30+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Docker æ‘¸çˆ¬æ»šæ‰“å¯¹æŠ— CentOS 6"><meta name=twitter:description content="èƒ½ä¸ç”¨ CentOS å°±åˆ«äº†å§ï¼Œå•Šä¸è¡Œï¼Ÿé‚£å°±ç‚¹è¿›æ¥çœ‹çœ‹å§"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://icyleaf.com/posts/"},{"@type":"ListItem","position":2,"name":"Docker æ‘¸çˆ¬æ»šæ‰“å¯¹æŠ— CentOS 6","item":"https://icyleaf.com/2016/12/docker-with-centos/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Docker æ‘¸çˆ¬æ»šæ‰“å¯¹æŠ— CentOS 6","name":"Docker æ‘¸çˆ¬æ»šæ‰“å¯¹æŠ— CentOS 6","description":"èƒ½ä¸ç”¨ CentOS å°±åˆ«äº†å§ï¼Œå•Šä¸è¡Œï¼Ÿé‚£å°±ç‚¹è¿›æ¥çœ‹çœ‹å§","keywords":["docker","centos"],"articleBody":" æ›´æ–° Oct 9, 2018\nå›½åº†æœŸé—´æ°å·§æœåŠ¡å™¨ç¡¬ç›˜æ•…éšœä¸”è¿ç»´å¹¶æ²¡æœ‰åš raid å¤‡ä»½ï¼Œç»™æ›´æ¢äº†ä¸€å°æ–°å†…éƒ¨æœåŠ¡å™¨ï¼Œç´¢æ€§å‡çº§åˆ°äº† CentOS 7ï¼Œå› æ­¤é’ˆå¯¹ CentOS 6 å®‰è£… Docker çš„ç­”ç–‘ä¸å†æ›´æ–°ã€‚ å‰è¨€ å‰ä¸ä¹…ç»ˆäºæŠŠæˆ‘ä»¬ç§»åŠ¨å›¢é˜Ÿå†…éƒ¨æœåŠ¡å™¨ä» CentOS 5.x å‡çº§åˆ°äº† 6.8ã€‚æœ¬æ¥æ˜¯æ‹œæ‰˜è®©å‡çº§è‡³ 7.0 ç‰ˆæœ¬èµ·ç èƒ½ç”¨ä¸Š docker 1.12 ç‰ˆæœ¬è¿˜æ˜¯é è°±çš„äº‹æƒ…ã€‚ äº‹æƒ…å¾€å¾€éš¾ä»¥é¢„æ–™çš„è¢«å‘ŠçŸ¥å…¶ä»–å›¢é˜Ÿåœ¨å®‰è£… 7.0 ä¹‹åé€ æˆå†…éƒ¨æœåŠ¡å™¨ç¾¤çš„ç½‘å¡å¤±çµçš„è¯¡å¼‚æ•…éšœåªèƒ½ä½œç½¢ï¼Œæƒ³æƒ³èµ·ç è¿˜æœ‰ä¸ªæ—©æœŸ docker ç‰ˆæœ¬å¯å®‰è£…ä¹Ÿå°±å…ˆè¿™ä¹ˆç€å§ã€‚\nè¿™ä¸ªæ˜¯åœ¨ å¦‚ä½•åœ¨CentOS ä¸Šå®‰è£…Gitlab ä¹‹åæœ‰ä¸€ä¸ªæ— å¥ˆçš„ä½¿ç”¨æŒ‡å—ï¼Œ å› ä¸ºè¿ç»´ä¹Ÿæœ‰ä»–çš„è€ƒè™‘æ–¹é¢ï¼Œå‚è§çŸ¥ä¹è®¨è®ºï¼šå¦‚ä½•è¯´æœè¿ç»´é€‰æ‹© Debian/Ubuntu è€Œä¸æ˜¯ CentOS\nå®‰è£… Docker 1.7.1 Docker æœ€åä¸€ä¸ªæ”¯æŒ CentOS 6 çš„ç‰ˆæœ¬æ˜¯ 1.7.1 è¿˜å¿…é¡»å®‰è£… epel æºä¹‹åå°±è¢«å¤§å®¶æ¬¢å¤©å–œåœ°çš„æŠ›å¼ƒäº† 6 çš„æ”¯æŒã€‚\n1sudo rpm -ivh http://download.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm 2sudo yum -y remove docker 3sudo yum install libselinux-python docker-io ç”±äº yum å†… docker å·²ç»è¢«å…¶ä»–ä½¿ç”¨ï¼Œä¸ç”¨å®‰è£…é”™è¯¯äº†ã€‚\n1.7.1 ä»¥ä¸Šç‰ˆæœ¬ è¯·æœæ–­æ”¾å¼ƒè¿™ç§æƒ³æ³•ï¼Œè™½ç„¶ä½ å¯èƒ½åœ¨ç½‘ä¸Šæœç´¢æœ‰ä¸ªåˆ«çš„æ–‡ç« è¯´æŠŠå†…æ ¸å‡çº§åˆ° 3.10 åå¯ä»¥å®‰è£… docker 1.9 ç‰ˆæœ¬ï¼Œç»è¿‡æˆ‘ä¸ªäººåå¤æµ‹è¯•æ ¹æœ¬ä¸å¯è¡Œï¼\nå½“ç„¶å¦‚æœä½ è¿˜æ˜¯åšæŒæƒ³å°è¯•ï¼Œè¯·å‚è€ƒå¦‚ä¸‹é“¾æ¥ï¼š\nhttp://www.pangxie.space/docker/364 http://www.cnblogs.com/dongdongwq/p/5381752.html http://0evin.com/2016/06/17/%5B%E5%8E%9F%E5%88%9B%5DCentOS6.5%E5%AE%89%E8%A3%85Docker1.11.X%E7%89%88%E6%9C%AC/ é…ç½® Docker å®‰è£…æˆåŠŸåå…ˆä¸è¦é…ç½®å¼€æœºè‡ªå¯åŠ¨å’Œå¯åŠ¨æœåŠ¡ï¼Œdocker çš„å®˜æ–¹é•œåƒåœ¨å›½å†…ä¼—æ‰€å‘¨çŸ¥çš„æ…¢çš„ä¸€å¡Œç³Šæ¶‚ï¼Œå¦‚æœä½ æ˜¯åœ¨å›½å†…æœåŠ¡å™¨ä½¿ç”¨è¯·å‚è€ƒå¦‚ä¸‹é…ç½®ã€‚\næˆ‘è¿™é‡ŒæŠŠæˆ‘ä¸ªäººç§è—å·²ä¹…çš„å¥½ç”¨çš„é•œåƒå‘Šè¯‰å¤§å®¶ï¼Œå¤§å®¶å¯ä¸è¦ä»¥ä¸ºæˆ‘ç”¨çš„æ˜¯é˜¿é‡Œäº‘æˆ–è€… DaoCloud è¿™ç±»æœ‰å¾ˆå¤šé™åˆ¶çš„ç©æ„ï¼š\nä¸­å›½ç§‘æŠ€å¤§å­¦é•œåƒï¼šhttps://docker.mirrors.ustc.edu.cn ç½‘æ˜“èœ‚å·¢é•œåƒï¼šhttp://hub-mirror.c.163.com åŒæ ·éœ€è¦æ³¨æ„çš„æ˜¯ 1.7.1 ç‰ˆæœ¬çš„ docker é…ç½®æ–‡ä»¶æ˜¯åœ¨ /etc/sysconfig/docker è€Œä¸æ˜¯ç½‘ä¸Šå’Œå®˜æ–¹è¯´çš„ /etc/default/docker æ‰“å¼€æ­¤æ–‡ä»¶åœ¨ other_args é…ç½®å¯¹äºçš„æºå³å¯ã€‚\n1# /etc/sysconfig/docker 2# 3# Other arguments to pass to the docker daemon process 4# These will be parsed by the sysv initscript and appended 5# to the arguments list passed to docker -d 6 7#other_args= 8#other_args=\"--registry-mirror=http://hub-mirror.c.163.com\" 9other_args=\"--registry-mirror=https://docker.mirrors.ustc.edu.cn\" 10 11DOCKER_CERT_PATH=/etc/docker 12 13# Resolves: rhbz#1176302 (docker issue #407) 14DOCKER_NOWARN_KERNEL_VERSION=1 15 16# Location used for temporary files, such as those created by 17# # docker load and build operations. Default is /var/lib/docker/tmp 18# # Can be overriden by setting the following environment variable. 19# # DOCKER_TMPDIR=/var/tmp åé¢å°±æ²¡ä»€ä¹ˆå¥½è¯´çš„äº†ï¼Œå¯åŠ¨æœåŠ¡å’Œè®¾ç½®å¼€æœºè‡ªå¯åŠ¨å°±å®Œäº‹äº†\n1sudo chkconfig docker on 2sudo service docker start éªŒè¯ä¸‹å¯åŠ¨çš„æœåŠ¡æ˜¯å¦å·²ç»é…ç½®äº†å›½å†…é•œåƒæº\n1$ ps aux | grep \"docker -d\" 2 3root 16992 0.1 0.1 1239860 32276 ? Sl Dec29 2:02 /usr/bin/docker -d --registry-mirror=https://docker.mirrors.ustc.edu.cn 4root 26873 0.0 0.0 103332 876 pts/2 S+ 18:16 0:00 grep docker -d ç–‘éš¾æ‚ç—‡ 1. ä½¿ç”¨å›½å†…é•œåƒæº pull é•œåƒå¶å°”ä¼šå¤±è´¥ï¼Œåå¤å‡ æ¬¡å°±å¯ä»¥è§£å†³ é¢‘æ¬¡ä¸é«˜åŸå› æœªçŸ¥ï¼Œå› æ­¤è¿˜æœªé‡è§†ã€‚\n2. Docker Web ç®¡ç†å·¥å…· æ¨èä½¿ç”¨ portainer ï¼Œå…¼å®¹ 1.7 çš„éƒ¨åˆ†åŠŸèƒ½å¯èƒ½ä¼šå‘ç”Ÿéƒ¨åˆ†åŠŸèƒ½å’Œå‚æ•°æ— æ³•æ˜¾ç¤ºä½†ä¸å½±å“ä½¿ç”¨ã€‚ä¹‹å‰æˆ‘æœ‰æ¨è rancherï¼ˆå¯å‚è€ƒå‰ç¯‡æ–‡ç« ï¼šå¦‚ä½•åœ¨ OS X ä¸Šå®‰è£… Rancher ï¼‰ï¼Œä½† rancher å®˜æ–¹è¦æ±‚ docker æœ€ä½ç‰ˆæœ¬æ˜¯ 1.9+ã€‚\n3. Docker è¿›ç¨‹æŒ‚äº†é‡å¯åæ— æ³•æ¢å¤ä¹‹å‰çš„ containers 1$ docker start c39206003c7a 2Error: Cannot start container c39206003c7a: Error getting container c39206003c7ae8992a554a9ac2ea130327fc4af1b2c389656c34baf9a56c84b5 from driver devicemapper: Error mounting '/dev/mapper/docker-253:0-267081-c39206003c7ae8992a554a9ac2ea130327fc4af1b2c389656c34baf9a56c84b5' on '/var/lib/docker/devicemapper/mnt/c39206003c7ae8992a554a9ac2ea130327fc4af1b2c389656c34baf9a56c84b5': device or resource busy 32014/05/08 19:14:57 Error: failed to start one or more containers è¿™ç§ä¸€èˆ¬æ˜¯å› ä¸ºæ„å¤–ç»ˆæ­¢è¿›ç¨‹é€ æˆä¸Šæ¬¡çš„ volume æ²¡æœ‰æ­£å¸¸ unmountï¼Œåªéœ€æ‰‹åŠ¨æ“ä½œä¸‹å³å¯ï¼š\n1unmount /var/lib/docker/devicemapper/mnt/d640aea67108b04c6a5ba14645966b092db1f807f3e3f41dca7a1470f76b68fb d640aea67108b04c6a5ba14645966b092db1f807f3e3f41dca7a1470f76b68fb æ˜¯æ ¹æ®ä¸åŒ container ç”Ÿæˆçš„ï¼Œè¯·æ ¹æ®å®é™…æƒ…å†µå¤åˆ¶å’Œæ‰§è¡Œã€‚\nè¿™ä¸ªçœŸæ²¡åŠæ³•ï¼Œåªèƒ½åœ¨ Dockerfile æˆ–è€…è¿›å®ä¾‹é‡Œé¢è¿›è¡Œä¿®æ”¹æ—¶åŒºï¼Œè¿™ä¸ªæˆ‘å°±ä¸è¿‡å¤šèµ˜è¿°äº†ã€‚\n4. å‡çº§è¿è¡Œçš„ container ç‰ˆæœ¬ 1$ docker stop xxxx 2$ docker create --volumes-from \\ --name xxx-data image/name: 3$ docker pull image/name:latest 4$ docker run -d --volumes-from xxx-data --restart=unless-stopped \\ -p 8080:8080 image/namel.:latest 5. é root ç”¨æˆ·æ‰§è¡Œ docker åˆ›å»º docker ç”¨æˆ·ç»„å¹¶é‡å¯ docker æœåŠ¡ï¼Œä¹‹åæŠŠä½ æƒ³è¦çš„ç”¨æˆ·åŠ åˆ° docker ç”¨æˆ·ç»„å³å¯ã€‚\n1$ groupadd docker 2$ service docker restart 3$ usermod -a -G docker icyleaf 6. å®¿ä¸»æœº CST æ—¶é—´ä¼šé€ æˆ docker å®ä¾‹æ—¶é—´ä¸å‡† è¿™ä¸ªçœŸæ²¡åŠæ³•ï¼Œåªèƒ½åœ¨ Dockerfile æˆ–è€…è¿›å®ä¾‹é‡Œé¢è¿›è¡Œä¿®æ”¹æ—¶åŒºï¼Œè¿™ä¸ªæˆ‘å°±ä¸è¿‡å¤šèµ˜è¿°äº†ã€‚\n","wordCount":"1283","inLanguage":"zh-cn","datePublished":"2016-12-30T17:52:30+08:00","dateModified":"2016-12-30T17:52:30+08:00","author":{"@type":"Person","name":"icyleaf"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://icyleaf.com/2016/12/docker-with-centos/"},"publisher":{"@type":"Organization","name":"icyleaf","logo":{"@type":"ImageObject","url":"https://icyleaf.com/favicon.ico"}}}</script></head><body><div class=wrapper><nav class=navbar><progress class=content_progress max=0 value=0></progress><div class=container><div class="navbar-header header-logo"><a href=https://icyleaf.com/>icyleaf</a></div><div class=navbar-right><span class=menu><a class=menu-item href=https://icyleaf.com/series/homelab title>homelab ç³»åˆ—</a>
<a class=menu-item href=https://icyleaf.com/projects title>å¼€æºé¡¹ç›®</a>
<a class=menu-item href=https://icyleaf.com/about title>å…³äº</a>
<span class=divide></span>
<a href=javascript:void(0); class=theme-switch><i class="iconfont icon-dark-mode"></i></a></span></div></div></nav><nav class=navbar-mobile id=nav-mobile style=display:none><progress class=content_progress max=0 value=0></progress><div class=container><div class=navbar><div class="navbar-header header-logo"><a href=https://icyleaf.com/>icyleaf</a></div><div class=navbar-right><div><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-dark-mode"></i></a></div><div class=menu-toggle><span></span><span></span><span></span></div></div></div><div class=menu id=mobile-menu><nav class=mb-md><a class=menu-item href=https://icyleaf.com/series/homelab title><h3>homelab ç³»åˆ—</h3><div class=menu-active></div></a><a class=menu-item href=https://icyleaf.com/projects title><h3>å¼€æºé¡¹ç›®</h3><div class=menu-active></div></a><a class=menu-item href=https://icyleaf.com/about title><h3>å…³äº</h3><div class=menu-active></div></a></nav></div></div></nav><main class=main><div class=container><article class=post-warp itemscope itemtype=http://schema.org/Article><header class=post-header><h1 class=post-title itemprop=description>Docker æ‘¸çˆ¬æ»šæ‰“å¯¹æŠ— CentOS 6</h1><div class=post-description>èƒ½ä¸ç”¨ CentOS å°±åˆ«äº†å§ï¼Œå•Šä¸è¡Œï¼Ÿé‚£å°±ç‚¹è¿›æ¥çœ‹çœ‹å§</div><div class=post-meta><time datetime=2016-12-30 itemprop=datePublished>2016-12-30</time>
Â·
<span class=tags>docker, centos</span>
Â·
<span class=post-word-count>1283 words Â· 5 minutes</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>ç›®å½•</h2><div class="post-toc-content always-active"><nav id=TableOfContents><ul><li><a href=#å‰è¨€>å‰è¨€</a></li><li><a href=#å®‰è£…-docker>å®‰è£… Docker</a><ul><li><a href=#171>1.7.1</a></li><li><a href=#171-ä»¥ä¸Šç‰ˆæœ¬>1.7.1 ä»¥ä¸Šç‰ˆæœ¬</a></li></ul></li><li><a href=#é…ç½®-docker>é…ç½® Docker</a></li><li><a href=#ç–‘éš¾æ‚ç—‡>ç–‘éš¾æ‚ç—‡</a><ul><li></li></ul></li></ul></nav></div></div><div class=post-content><div id=post-gallery><div class=updated><header class=updated-header><h4 class=updated-title>æ›´æ–°</h4><p class=updated-meta>Oct 9, 2018</p></header><article class=updated-body>å›½åº†æœŸé—´æ°å·§æœåŠ¡å™¨ç¡¬ç›˜æ•…éšœä¸”è¿ç»´å¹¶æ²¡æœ‰åš raid å¤‡ä»½ï¼Œç»™æ›´æ¢äº†ä¸€å°æ–°å†…éƒ¨æœåŠ¡å™¨ï¼Œç´¢æ€§å‡çº§åˆ°äº† CentOS 7ï¼Œå› æ­¤é’ˆå¯¹ CentOS 6 å®‰è£… Docker çš„ç­”ç–‘ä¸å†æ›´æ–°ã€‚</article></div><h2 id=å‰è¨€>å‰è¨€</h2><p>å‰ä¸ä¹…ç»ˆäºæŠŠæˆ‘ä»¬ç§»åŠ¨å›¢é˜Ÿå†…éƒ¨æœåŠ¡å™¨ä» CentOS 5.x å‡çº§åˆ°äº† 6.8ã€‚æœ¬æ¥æ˜¯æ‹œæ‰˜è®©å‡çº§è‡³ 7.0 ç‰ˆæœ¬èµ·ç èƒ½ç”¨ä¸Š docker 1.12 ç‰ˆæœ¬è¿˜æ˜¯é è°±çš„äº‹æƒ…ã€‚
äº‹æƒ…å¾€å¾€éš¾ä»¥é¢„æ–™çš„è¢«å‘ŠçŸ¥å…¶ä»–å›¢é˜Ÿåœ¨å®‰è£… 7.0 ä¹‹åé€ æˆå†…éƒ¨æœåŠ¡å™¨ç¾¤çš„ç½‘å¡å¤±çµçš„è¯¡å¼‚æ•…éšœåªèƒ½ä½œç½¢ï¼Œæƒ³æƒ³èµ·ç è¿˜æœ‰ä¸ªæ—©æœŸ docker ç‰ˆæœ¬å¯å®‰è£…ä¹Ÿå°±å…ˆè¿™ä¹ˆç€å§ã€‚</p><p>è¿™ä¸ªæ˜¯åœ¨ <a href=http://icyleaf.com/2013/09/how-to-install-gitlab-on-centos/>å¦‚ä½•åœ¨CentOS ä¸Šå®‰è£…Gitlab</a> ä¹‹åæœ‰ä¸€ä¸ªæ— å¥ˆçš„ä½¿ç”¨æŒ‡å—ï¼Œ
å› ä¸ºè¿ç»´ä¹Ÿæœ‰ä»–çš„è€ƒè™‘æ–¹é¢ï¼Œå‚è§çŸ¥ä¹è®¨è®ºï¼š<a href=https://www.zhihu.com/question/29191794>å¦‚ä½•è¯´æœè¿ç»´é€‰æ‹© Debian/Ubuntu è€Œä¸æ˜¯ CentOS</a></p><h2 id=å®‰è£…-docker>å®‰è£… Docker</h2><h3 id=171>1.7.1</h3><p>Docker æœ€åä¸€ä¸ªæ”¯æŒ CentOS 6 çš„ç‰ˆæœ¬æ˜¯ 1.7.1 è¿˜å¿…é¡»å®‰è£… epel æºä¹‹åå°±<a href=https://github.com/docker/docker/issues/14365>è¢«å¤§å®¶æ¬¢å¤©å–œåœ°çš„æŠ›å¼ƒäº† 6 çš„æ”¯æŒ</a>ã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>sudo rpm -ivh http://download.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm
</span></span><span class=line><span class=ln>2</span><span class=cl>sudo yum -y remove docker
</span></span><span class=line><span class=ln>3</span><span class=cl>sudo yum install libselinux-python docker-io
</span></span></code></pre></div><blockquote><p>ç”±äº yum å†… docker å·²ç»è¢«å…¶ä»–ä½¿ç”¨ï¼Œä¸ç”¨å®‰è£…é”™è¯¯äº†ã€‚</p></blockquote><h3 id=171-ä»¥ä¸Šç‰ˆæœ¬>1.7.1 ä»¥ä¸Šç‰ˆæœ¬</h3><p><strong>è¯·æœæ–­æ”¾å¼ƒè¿™ç§æƒ³æ³•</strong>ï¼Œè™½ç„¶ä½ å¯èƒ½åœ¨ç½‘ä¸Šæœç´¢æœ‰ä¸ªåˆ«çš„æ–‡ç« è¯´æŠŠå†…æ ¸å‡çº§åˆ° 3.10 åå¯ä»¥å®‰è£… docker 1.9 ç‰ˆæœ¬ï¼Œç»è¿‡æˆ‘ä¸ªäººåå¤æµ‹è¯•æ ¹æœ¬ä¸å¯è¡Œï¼</p><p>å½“ç„¶å¦‚æœä½ è¿˜æ˜¯åšæŒæƒ³å°è¯•ï¼Œè¯·å‚è€ƒå¦‚ä¸‹é“¾æ¥ï¼š</p><ul><li><a href=http://www.pangxie.space/docker/364>http://www.pangxie.space/docker/364</a></li><li><a href=http://www.cnblogs.com/dongdongwq/p/5381752.html>http://www.cnblogs.com/dongdongwq/p/5381752.html</a></li><li><a href=http://0evin.com/2016/06/17/%5B%E5%8E%9F%E5%88%9B%5DCentOS6.5%E5%AE%89%E8%A3%85Docker1.11.X%E7%89%88%E6%9C%AC/>http://0evin.com/2016/06/17/%5B%E5%8E%9F%E5%88%9B%5DCentOS6.5%E5%AE%89%E8%A3%85Docker1.11.X%E7%89%88%E6%9C%AC/</a></li></ul><h2 id=é…ç½®-docker>é…ç½® Docker</h2><p>å®‰è£…æˆåŠŸåå…ˆä¸è¦é…ç½®å¼€æœºè‡ªå¯åŠ¨å’Œå¯åŠ¨æœåŠ¡ï¼Œdocker çš„å®˜æ–¹é•œåƒåœ¨å›½å†…ä¼—æ‰€å‘¨çŸ¥çš„æ…¢çš„ä¸€å¡Œç³Šæ¶‚ï¼Œå¦‚æœä½ æ˜¯åœ¨å›½å†…æœåŠ¡å™¨ä½¿ç”¨è¯·å‚è€ƒå¦‚ä¸‹é…ç½®ã€‚</p><p>æˆ‘è¿™é‡ŒæŠŠæˆ‘ä¸ªäººç§è—å·²ä¹…çš„å¥½ç”¨çš„é•œåƒå‘Šè¯‰å¤§å®¶ï¼Œå¤§å®¶å¯ä¸è¦ä»¥ä¸ºæˆ‘ç”¨çš„æ˜¯é˜¿é‡Œäº‘æˆ–è€… DaoCloud è¿™ç±»æœ‰å¾ˆå¤šé™åˆ¶çš„ç©æ„ï¼š</p><ul><li>ä¸­å›½ç§‘æŠ€å¤§å­¦é•œåƒï¼šhttps://docker.mirrors.ustc.edu.cn</li><li>ç½‘æ˜“èœ‚å·¢é•œåƒï¼šhttp://hub-mirror.c.163.com</li></ul><p>åŒæ ·éœ€è¦æ³¨æ„çš„æ˜¯ 1.7.1 ç‰ˆæœ¬çš„ docker é…ç½®æ–‡ä»¶æ˜¯åœ¨ <code>/etc/sysconfig/docker</code> è€Œä¸æ˜¯ç½‘ä¸Šå’Œå®˜æ–¹è¯´çš„ <code>/etc/default/docker</code> æ‰“å¼€æ­¤æ–‡ä»¶åœ¨ other_args é…ç½®å¯¹äºçš„æºå³å¯ã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln> 1</span><span class=cl><span class=c1># /etc/sysconfig/docker</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl><span class=c1># Other arguments to pass to the docker daemon process</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl><span class=c1># These will be parsed by the sysv initscript and appended</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl><span class=c1># to the arguments list passed to docker -d</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>
</span></span><span class=line><span class=ln> 7</span><span class=cl><span class=c1>#other_args=</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl><span class=c1>#other_args=&#34;--registry-mirror=http://hub-mirror.c.163.com&#34;</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl><span class=nv>other_args</span><span class=o>=</span><span class=s2>&#34;--registry-mirror=https://docker.mirrors.ustc.edu.cn&#34;</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>
</span></span><span class=line><span class=ln>11</span><span class=cl><span class=nv>DOCKER_CERT_PATH</span><span class=o>=</span>/etc/docker
</span></span><span class=line><span class=ln>12</span><span class=cl>
</span></span><span class=line><span class=ln>13</span><span class=cl><span class=c1># Resolves: rhbz#1176302 (docker issue #407)</span>
</span></span><span class=line><span class=ln>14</span><span class=cl><span class=nv>DOCKER_NOWARN_KERNEL_VERSION</span><span class=o>=</span><span class=m>1</span>
</span></span><span class=line><span class=ln>15</span><span class=cl>
</span></span><span class=line><span class=ln>16</span><span class=cl><span class=c1># Location used for temporary files, such as those created by</span>
</span></span><span class=line><span class=ln>17</span><span class=cl><span class=c1># # docker load and build operations. Default is /var/lib/docker/tmp</span>
</span></span><span class=line><span class=ln>18</span><span class=cl><span class=c1># # Can be overriden by setting the following environment variable.</span>
</span></span><span class=line><span class=ln>19</span><span class=cl><span class=c1># # DOCKER_TMPDIR=/var/tmp</span>
</span></span></code></pre></div><p>åé¢å°±æ²¡ä»€ä¹ˆå¥½è¯´çš„äº†ï¼Œå¯åŠ¨æœåŠ¡å’Œè®¾ç½®å¼€æœºè‡ªå¯åŠ¨å°±å®Œäº‹äº†</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>sudo chkconfig docker on
</span></span><span class=line><span class=ln>2</span><span class=cl>sudo service docker start
</span></span></code></pre></div><p>éªŒè¯ä¸‹å¯åŠ¨çš„æœåŠ¡æ˜¯å¦å·²ç»é…ç½®äº†å›½å†…é•œåƒæº</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>$ ps aux <span class=p>|</span> grep <span class=s2>&#34;docker -d&#34;</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>
</span></span><span class=line><span class=ln>3</span><span class=cl>root     <span class=m>16992</span>  0.1  0.1 <span class=m>1239860</span> <span class=m>32276</span> ?       Sl   Dec29   2:02 /usr/bin/docker -d --registry-mirror<span class=o>=</span>https://docker.mirrors.ustc.edu.cn
</span></span><span class=line><span class=ln>4</span><span class=cl>root     <span class=m>26873</span>  0.0  0.0 <span class=m>103332</span>   <span class=m>876</span> pts/2    S+   18:16   0:00 grep docker -d
</span></span></code></pre></div><h2 id=ç–‘éš¾æ‚ç—‡>ç–‘éš¾æ‚ç—‡</h2><h4 id=1-ä½¿ç”¨å›½å†…é•œåƒæº-pull-é•œåƒå¶å°”ä¼šå¤±è´¥åå¤å‡ æ¬¡å°±å¯ä»¥è§£å†³>1. ä½¿ç”¨å›½å†…é•œåƒæº pull é•œåƒå¶å°”ä¼šå¤±è´¥ï¼Œåå¤å‡ æ¬¡å°±å¯ä»¥è§£å†³</h4><p>é¢‘æ¬¡ä¸é«˜åŸå› æœªçŸ¥ï¼Œå› æ­¤è¿˜æœªé‡è§†ã€‚</p><h4 id=2-docker-web-ç®¡ç†å·¥å…·>2. Docker Web ç®¡ç†å·¥å…·</h4><p>æ¨èä½¿ç”¨ <a href=https://github.com/portainer/portainer>portainer</a> ï¼Œå…¼å®¹ 1.7 çš„éƒ¨åˆ†åŠŸèƒ½å¯èƒ½ä¼šå‘ç”Ÿéƒ¨åˆ†åŠŸèƒ½å’Œå‚æ•°æ— æ³•æ˜¾ç¤ºä½†ä¸å½±å“ä½¿ç”¨ã€‚ä¹‹å‰æˆ‘æœ‰æ¨è rancherï¼ˆå¯å‚è€ƒå‰ç¯‡æ–‡ç« ï¼š<a href=http://icyleaf.com/2016/08/how-to-install-rancher-on-osx/>å¦‚ä½•åœ¨ OS X ä¸Šå®‰è£… Rancher
</a>ï¼‰ï¼Œä½† rancher å®˜æ–¹è¦æ±‚ docker æœ€ä½ç‰ˆæœ¬æ˜¯ 1.9+ã€‚</p><h4 id=3-docker-è¿›ç¨‹æŒ‚äº†é‡å¯åæ— æ³•æ¢å¤ä¹‹å‰çš„-containers>3. Docker è¿›ç¨‹æŒ‚äº†é‡å¯åæ— æ³•æ¢å¤ä¹‹å‰çš„ containers</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>$ docker start c39206003c7a
</span></span><span class=line><span class=ln>2</span><span class=cl>Error: Cannot start container c39206003c7a: Error getting container c39206003c7ae8992a554a9ac2ea130327fc4af1b2c389656c34baf9a56c84b5 from driver devicemapper: Error mounting <span class=s1>&#39;/dev/mapper/docker-253:0-267081-c39206003c7ae8992a554a9ac2ea130327fc4af1b2c389656c34baf9a56c84b5&#39;</span> on <span class=s1>&#39;/var/lib/docker/devicemapper/mnt/c39206003c7ae8992a554a9ac2ea130327fc4af1b2c389656c34baf9a56c84b5&#39;</span>: device or resource busy
</span></span><span class=line><span class=ln>3</span><span class=cl>2014/05/08 19:14:57 Error: failed to start one or more containers
</span></span></code></pre></div><p>è¿™ç§ä¸€èˆ¬æ˜¯å› ä¸ºæ„å¤–ç»ˆæ­¢è¿›ç¨‹é€ æˆä¸Šæ¬¡çš„ volume æ²¡æœ‰æ­£å¸¸ unmountï¼Œåªéœ€æ‰‹åŠ¨æ“ä½œä¸‹å³å¯ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>unmount /var/lib/docker/devicemapper/mnt/d640aea67108b04c6a5ba14645966b092db1f807f3e3f41dca7a1470f76b68fb
</span></span></code></pre></div><blockquote><p><code>d640aea67108b04c6a5ba14645966b092db1f807f3e3f41dca7a1470f76b68fb</code> æ˜¯æ ¹æ®ä¸åŒ container ç”Ÿæˆçš„ï¼Œè¯·æ ¹æ®å®é™…æƒ…å†µå¤åˆ¶å’Œæ‰§è¡Œã€‚</p></blockquote><p>è¿™ä¸ªçœŸæ²¡åŠæ³•ï¼Œåªèƒ½åœ¨ Dockerfile æˆ–è€…è¿›å®ä¾‹é‡Œé¢è¿›è¡Œä¿®æ”¹æ—¶åŒºï¼Œè¿™ä¸ªæˆ‘å°±ä¸è¿‡å¤šèµ˜è¿°äº†ã€‚</p><h4 id=4-å‡çº§è¿è¡Œçš„-container-ç‰ˆæœ¬>4. å‡çº§è¿è¡Œçš„ container ç‰ˆæœ¬</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>$ docker stop xxxx
</span></span><span class=line><span class=ln>2</span><span class=cl>$ docker create --volumes-from &lt;container_name_of_original_server&gt; <span class=se>\ </span>--name xxx-data image/name:&lt;tag_of_previous_rancher_server&gt;
</span></span><span class=line><span class=ln>3</span><span class=cl>$ docker pull image/name:latest
</span></span><span class=line><span class=ln>4</span><span class=cl>$ docker run -d --volumes-from xxx-data --restart<span class=o>=</span>unless-stopped <span class=se>\ </span>-p 8080:8080 image/namel.:latest
</span></span></code></pre></div><h4 id=5-é-root-ç”¨æˆ·æ‰§è¡Œ-docker>5. é root ç”¨æˆ·æ‰§è¡Œ docker</h4><p>åˆ›å»º docker ç”¨æˆ·ç»„å¹¶é‡å¯ docker æœåŠ¡ï¼Œä¹‹åæŠŠä½ æƒ³è¦çš„ç”¨æˆ·åŠ åˆ° docker ç”¨æˆ·ç»„å³å¯ã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>$ groupadd docker
</span></span><span class=line><span class=ln>2</span><span class=cl>$ service docker restart
</span></span><span class=line><span class=ln>3</span><span class=cl>$ usermod -a -G docker icyleaf
</span></span></code></pre></div><h4 id=6-å®¿ä¸»æœº-cst-æ—¶é—´ä¼šé€ æˆ-docker-å®ä¾‹æ—¶é—´ä¸å‡†>6. å®¿ä¸»æœº CST æ—¶é—´ä¼šé€ æˆ docker å®ä¾‹æ—¶é—´ä¸å‡†</h4><p>è¿™ä¸ªçœŸæ²¡åŠæ³•ï¼Œåªèƒ½åœ¨ Dockerfile æˆ–è€…è¿›å®ä¾‹é‡Œé¢è¿›è¡Œä¿®æ”¹æ—¶åŒºï¼Œè¿™ä¸ªæˆ‘å°±ä¸è¿‡å¤šèµ˜è¿°äº†ã€‚</p></div></div><div class=post-nav><a href=https://icyleaf.com/2016/08/how-to-install-rancher-on-osx/ class=prev rel=prev title="å¦‚ä½•åœ¨ OS X ä¸Šå®‰è£… Rancher"><i class="iconfont icon-left"></i>&nbsp;å¦‚ä½•åœ¨ OS X ä¸Šå®‰è£… Rancher</a>
<a href=https://icyleaf.com/2017/03/how-to-get-temporary-car-license-in-beijing/ class=next rel=next title=åŒ—äº¬ä¸Šä¸´æ—¶ç‰Œç…§æµç¨‹>åŒ—äº¬ä¸Šä¸´æ—¶ç‰Œç…§æµç¨‹&nbsp;<i class="iconfont icon-right"></i></a></div><div class=post-comment><script>var getTheme=window.localStorage&&window.localStorage.getItem("blog-dark-mode"),getTheme=getTheme??"github-light";let theme=getTheme==="dark"?"github-dark":"github-light",s=document.createElement("script");s.src="https://utteranc.es/client.js",s.setAttribute("repo","icyleaf/icyleaf.com"),s.setAttribute("issue-term","pathname"),s.setAttribute("theme",theme),s.setAttribute("crossorigin","anonymous"),s.setAttribute("async",""),document.querySelector("div.post-comment").innerHTML="",document.querySelector("div.post-comment").appendChild(s)</script></div></article></div></main><footer class=footer><div class=copyright>&copy;
<span itemprop=copyrightYear>2005 - 2023</span>
<span>ğŸº</span>
<span class=author itemprop=copyrightHolder><a href=https://icyleaf.com/>icyleaf</a></span></div></footer><script defer src=https://fastly.jsdelivr.net/npm/jquery@3.6.4/dist/jquery.min.js crossorigin=anonymous></script><script defer src=https://icyleaf.com/js/vendor_main.min.js></script>
<script type=module>
  
  import PhotoSwipeLightbox from '\/photoswipe\/photoswipe-lightbox.esm.js';

  const lightbox = new PhotoSwipeLightbox({
    gallery: '#post-gallery',
    children: 'a.gallery-item',
    pswpModule: () => import('\/photoswipe\/photoswipe.esm.js'),
  });
  lightbox.init();
</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-TKQBZ7R259"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-TKQBZ7R259")</script></div></body></html>