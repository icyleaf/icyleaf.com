<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>深入浅出 Fastlane 一看你就懂 | icyleaf</title><link rel=prev href=https://icyleaf.com/2016/07/gitlab-api-wrapper-for-crystal/><link rel=next href=https://icyleaf.com/2016/08/how-to-install-rancher-on-osx/><link rel=canonical href=https://icyleaf.com/2016/07/fastlane-in-action/><link rel=apple-touch-icon sizes=180x180 href=https://icyleaf.com/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://icyleaf.com/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://icyleaf.com/favicon-16x16.png><link rel=manifest href=https://icyleaf.com/site.webmanifest><link rel=mask-icon href=https://icyleaf.com/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#000000"><link rel=stylesheet href=https://icyleaf.com/css/main.min.css><link rel=stylesheet href=https://icyleaf.com/font/iconfont.css><link rel=stylesheet href=https://icyleaf.com/font-ali/iconfont.css><meta name=title content="深入浅出 Fastlane 一看你就懂 | icyleaf"><meta name=author content="icyleaf"><meta name=description content="日常写代码热爱户外的梦想家"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/icyleaf.com\/"},"articleSection":"posts","name":"深入浅出 Fastlane 一看你就懂","headline":"深入浅出 Fastlane 一看你就懂","description":"这是《 Fastlane - iOS 和 Android 的自动化构建工具》系列的第二篇。 本篇我想着重介绍 fastlane 本身的基本使用，这里使用 fastlane v1.98.0 作为演示版本。 系列索引 Fastlane - iOS 和 Android 的自动化构建工","inLanguage":"zh-cn","author":"icyleaf","creator":"icyleaf","publisher":"icyleaf","accountablePerson":"icyleaf","copyrightHolder":"icyleaf","copyrightYear":"2016","datePublished":"2016-07-19 20:12:07 \u002b0800 \u002b0800","dateModified":"2016-07-19 20:12:07 \u002b0800 \u002b0800","url":"https:\/\/icyleaf.com\/2016\/07\/fastlane-in-action\/","wordCount":"3589","keywords":["iOS","Android","CI","CD","Ruby","Fastlane","icyleaf"]}</script></head><body><div class=wrapper><nav class=navbar><progress class=content_progress max=0 value=0></progress><div class=container><div class="navbar-header header-back2home-logo"><span class=logo_mark>>$</span>
<a href=https://icyleaf.com/><span class=logo_text>cd /home/</span>
<span class=logo_cursor></span></a></div><div class=navbar-right><span class=menu><a class=menu-item href=https://icyleaf.com/posts title>Posts</a>
<a class=menu-item href=https://icyleaf.com/categories title>Categories</a>
<a class=menu-item href=https://icyleaf.com/tags title>Tags</a>
<a class=menu-item href=https://icyleaf.com/about title>About</a>
<span class=divide></span><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-dark-mode"></i></a></span></div></div></nav><nav class=navbar-mobile id=nav-mobile style=display:none><progress class=content_progress max=0 value=0></progress><div class=container><div class=navbar><div class="navbar-header header-logo"><a href=https://icyleaf.com/>icyleaf</a></div><div class=navbar-right><div><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-dark-mode"></i></a></div><div class=menu-toggle><span></span><span></span><span></span></div></div></div><div class=menu id=mobile-menu><nav class=mb-md><a class=menu-item href=https://icyleaf.com/posts title><h3>Posts</h3><div class=menu-active></div></a><a class=menu-item href=https://icyleaf.com/categories title><h3>Categories</h3><div class=menu-active></div></a><a class=menu-item href=https://icyleaf.com/tags title><h3>Tags</h3><div class=menu-active></div></a><a class=menu-item href=https://icyleaf.com/about title><h3>About</h3><div class=menu-active></div></a></nav></div></div></nav><main class=main><div class=container><article class=post-warp itemscope itemtype=http://schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline">深入浅出 Fastlane 一看你就懂</h1><div class=post-meta>Written by <a itemprop=name href=https://icyleaf.com/ rel=author>icyleaf</a> with ♥
<span class=post-time>on <time datetime=2016-07-19 itemprop=datePublished>July 19, 2016</time></span>
in
<i class="iconfont icon-folder"></i>
<span class=post-category><a href=https://icyleaf.com/categories/technology/>Technology,</a></span>
<span class=post-word-count>3589 words</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title></h2><div class="post-toc-content always-active"><nav id=TableOfContents><ul><li><ul><li><a href=#系列索引>系列索引</a></li></ul></li><li><a href=#命令行工具>命令行工具</a></li><li><a href=#生命周期>生命周期</a></li><li><a href=#任务lane>任务（lane）</a><ul><li><a href=#任务定义>任务定义</a></li><li><a href=#任务执行>任务执行</a></li><li><a href=#任务互调>任务互调</a></li><li><a href=#任务返回值>任务返回值</a></li><li><a href=#引入外部任务文件>引入外部任务文件</a></li><li><a href=#任务查看>任务查看</a></li></ul></li><li><a href=#扩展action>扩展（Action）</a><ul><li><a href=#扩展列表>扩展列表</a></li><li><a href=#扩展使用帮助>扩展使用帮助</a></li><li><a href=#创建自定义扩展>创建自定义扩展</a></li><li><a href=#引入外部扩展>引入外部扩展</a></li><li><a href=#扩展的命令行调用>扩展的命令行调用</a></li></ul></li><li><a href=#辅助功能>辅助功能</a><ul><li><a href=#自动更新>自动更新</a></li><li><a href=#环境变量>环境变量</a></li></ul></li></ul></nav></div></div><div class=post-content><p>这是《 <a href=https://icyleaf.com/2016/07/intro-fastlane-automation-for-ios-and-android/>Fastlane - iOS 和 Android 的自动化构建工具</a>》系列的第二篇。</p><p>本篇我想着重介绍 <code>fastlane</code> 本身的基本使用，这里使用 fastlane v1.98.0 作为演示版本。</p><h3 id=系列索引>系列索引</h3><ol><li><a href=https://icyleaf.com/2016/07/intro-fastlane-automation-for-ios-and-android/>Fastlane - iOS 和 Android 的自动化构建工具</a></li><li><a href=https://icyleaf.com/2016/07/fastlane-in-action/>深入浅出 Fastlane 一看你就懂</a></li><li><a href=https://icyleaf.com/2017/03/fastlane-match-in-action/>你虐我千百遍，我待你如初恋，直到我遇到 match</a></li></ol><h2 id=命令行工具>命令行工具</h2><p>安装之后默认会安装一个命令行工具 <code>fastlane</code>，利用它可以初始化、执行任务、查看任务定义、查看可用的动作和动作的详细定义，甚至可以用它来创建自定义的动作、插件以及一些辅助功能。想了解的话可以先看看它的帮助：</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash><span class=ln> 1</span>$ fastlane --help
<span class=ln> 2</span>
<span class=ln> 3</span>  fastlane
<span class=ln> 4</span>
<span class=ln> 5</span>  CLI <span class=k>for</span> <span class=s1>&#39;fastlane&#39;</span> - The easiest way to automate building and releasing your iOS and Android apps
<span class=ln> 6</span>
<span class=ln> 7</span>        Run using <span class=sb>`</span>fastlane <span class=o>[</span>platform<span class=o>]</span> <span class=o>[</span>lane_name<span class=o>]</span><span class=sb>`</span>
<span class=ln> 8</span>        To pass values to the lanes use <span class=sb>`</span>fastlane <span class=o>[</span>platform<span class=o>]</span> <span class=o>[</span>lane_name<span class=o>]</span> key:value key2:value2<span class=sb>`</span>
<span class=ln> 9</span>
<span class=ln>10</span>  Commands:
<span class=ln>11</span>    action                  Shows more information <span class=k>for</span> a specific <span class=nb>command</span>
<span class=ln>12</span>    actions                 Lists all available fastlane actions
<span class=ln>13</span>    add_plugin              Add a new plugin to your fastlane setup
<span class=ln>14</span>    disable_crash_reporting Deprecated: fastlane doesn<span class=s1>&#39;t use a crash reporter any more
</span><span class=ln>15</span><span class=s1>    docs                    Generate a markdown based documentation based on the Fastfile
</span><span class=ln>16</span><span class=s1>    enable_auto_complete    Enable tab auto completion
</span><span class=ln>17</span><span class=s1>    enable_crash_reporting  Deprecated: fastlane doesn&#39;</span>t use a crash reporter any more
<span class=ln>18</span>    <span class=nb>help</span>                    Display global or <span class=o>[</span>command<span class=o>]</span> <span class=nb>help</span> documentation
<span class=ln>19</span>    init                    Helps you with your initial fastlane setup
<span class=ln>20</span>    install_plugins         Install all plugins <span class=k>for</span> this project
<span class=ln>21</span>    lanes                   Lists all available lanes and shows their description
<span class=ln>22</span>    list                    Lists all available lanes without description
<span class=ln>23</span>    new_action              Create a new custom action <span class=k>for</span> fastlane.
<span class=ln>24</span>    new_plugin              Create a new plugin that can be used with fastlane
<span class=ln>25</span>    run                     Run a fastlane one-off action without a full lane
<span class=ln>26</span>    search_plugins          Search <span class=k>for</span> plugins, search query is optional
<span class=ln>27</span>    trigger                 Run a sepcific lane. Pass the lane name and optionally the platform first.
<span class=ln>28</span>    update_plugins          Update all plugin dependencies
<span class=ln>29</span>
<span class=ln>30</span>  Global Options:
<span class=ln>31</span>    --verbose
<span class=ln>32</span>    -h, --help           Display <span class=nb>help</span> documentation
<span class=ln>33</span>    -v, --version        Display version information
<span class=ln>34</span>
<span class=ln>35</span>  Author:
<span class=ln>36</span>    Felix Krause &lt;fastlane@krausefx.com&gt;
<span class=ln>37</span>
<span class=ln>38</span>  Website:
<span class=ln>39</span>    https://fastlane.tools
<span class=ln>40</span>
<span class=ln>41</span>  GitHub:
<span class=ln>42</span>    https://github.com/fastlane/fastlane
</code></pre></div><p>我会随着下面每个概念的解释和展开来配合上面的命令一起讲解。</p><h2 id=生命周期>生命周期</h2><table><thead><tr><th>执行顺序</th><th>方法名</th><th>说明</th></tr></thead><tbody><tr><td>1</td><td>before_all</td><td>在执行 lane 之前只执行一次</td></tr><tr><td>2</td><td>before_each</td><td>每次执行 lane 之前都会执行一次</td></tr><tr><td>3</td><td>lane</td><td>自定义的任务</td></tr><tr><td>4</td><td>after_each</td><td>每次执行 lane 之后都会执行一次</td></tr><tr><td>5</td><td>after_all</td><td>在执行 lane 成功结束之后执行一次</td></tr><tr><td>6</td><td>error</td><td>在执行上述情况任意环境报错都会中止并执行一次</td></tr></tbody></table><p>以上的部分大家在上一篇已经见识过了，有些还没接触到，不用着急都会一一说明。</p><h2 id=任务lane>任务（lane）</h2><p>正常情况下你可能只会是用到一种任务方法 <code>lane</code> 但其实它会包含很多中高级用法。在文章的末尾会详细描述。</p><h3 id=任务定义>任务定义</h3><p>定义任务的方法类似于 rake 的 task，但使用上缺比前者要好用很多，见下表：</p><table><thead><tr><th>定义</th><th>是否必须</th><th>说明</th><th>备注</th></tr></thead><tbody><tr><td>desc</td><td><code>false</code></td><td>方法描述</td><td>可多次使用打到换行的目的</td></tr><tr><td>name</td><td><code>true</code></td><td>方法名</td><td>符号化的方法名</td></tr><tr><td>options</td><td><code>false</code></td><td>方法参数</td><td>返回 Hash 类型</td></tr><tr><td>task</td><td><code>true</code></td><td>方法主体</td><td>参考 ruby 的方法代码且支持 ruby 代码</td></tr></tbody></table><div class=highlight><pre class=chroma><code class=language-ruby data-lang=ruby><span class=ln> 1</span><span class=n>desc</span> <span class=s1>&#39;定义一个 build 方法&#39;</span>
<span class=ln> 2</span><span class=n>desc</span> <span class=s1>&#39;参数 adhoc 判断是否为内测版本, 默认为 false&#39;</span>
<span class=ln> 3</span><span class=n>desc</span> <span class=s1>&#39;fastlane build&#39;</span>
<span class=ln> 4</span><span class=n>desc</span> <span class=s1>&#39;fastlane build adhoc:true&#39;</span>
<span class=ln> 5</span><span class=n>lane</span> <span class=ss>:build</span> <span class=k>do</span> <span class=o>|</span><span class=n>options</span><span class=o>|</span>
<span class=ln> 6</span>  <span class=c1># task to do something</span>
<span class=ln> 7</span>  <span class=n>adhoc</span> <span class=o>=</span> <span class=n>options</span><span class=o>[</span><span class=ss>:adhoc</span><span class=o>]</span> <span class=o>||</span> <span class=kp>false</span>
<span class=ln> 8</span>  <span class=nb>puts</span> <span class=s2>&#34;adhoc: </span><span class=si>#{</span><span class=n>adhoc</span><span class=si>}</span><span class=s2>&#34;</span>
<span class=ln> 9</span>
<span class=ln>10</span>  <span class=n>gym</span><span class=p>(</span><span class=ss>type</span><span class=p>:</span> <span class=n>adhoc</span> <span class=p>?</span> <span class=s1>&#39;adhoc&#39;</span> <span class=p>:</span> <span class=s1>&#39;appstore&#39;</span><span class=p>)</span>
<span class=ln>11</span><span class=k>end</span>
</code></pre></div><h3 id=任务执行>任务执行</h3><p>一般情况下它需要配合定义好的 lane 才能使用，刚刚我们定义的一个 build 方法，我们这里就试着执行一下吧。</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash><span class=ln>1</span><span class=c1># 默认执行</span>
<span class=ln>2</span>$ fastlane build
<span class=ln>3</span><span class=c1># 传递参数</span>
<span class=ln>4</span>$ fastlane build adhoc:true
</code></pre></div><h3 id=任务互调>任务互调</h3><p><code>lane</code> 其实可以理解为 <code>def</code> 的别名，因此多个 lane 的话实际上是可以相互调用的，这个其实特别实用，这样其实我就可以把 cocoapods 的执行放到单独的 lane 里面而不是 <code>before_all</code>，这样执行非构建的任务就不会执行不相关的任务或动作，因此 fastlane 而产生了一个私有任务用内部使用 <code>private_lane</code></p><div class=highlight><pre class=chroma><code class=language-ruby data-lang=ruby><span class=ln> 1</span>
<span class=ln> 2</span><span class=n>default_platform</span> <span class=ss>:ios</span>
<span class=ln> 3</span>
<span class=ln> 4</span><span class=n>platform</span> <span class=ss>:ios</span> <span class=k>do</span>
<span class=ln> 5</span>  <span class=n>desc</span> <span class=s1>&#39;构建前的准备工作&#39;</span>
<span class=ln> 6</span>  <span class=n>desc</span> <span class=s1>&#39;这是一个私有任务，仅供 Fastfile 内部 lane 调用使用&#39;</span>
<span class=ln> 7</span>  <span class=n>lane</span> <span class=ss>:prepare</span> <span class=k>do</span>
<span class=ln> 8</span>    <span class=n>cocoapods</span>
<span class=ln> 9</span>    <span class=n>match</span>
<span class=ln>10</span>  <span class=k>end</span>
<span class=ln>11</span>
<span class=ln>12</span>  <span class=n>desc</span> <span class=s1>&#39;通用的构建任务&#39;</span>
<span class=ln>13</span>  <span class=n>desc</span> <span class=s1>&#39;fastlane build&#39;</span>
<span class=ln>14</span>  <span class=n>desc</span> <span class=s1>&#39;fastlane build type:adhoc&#39;</span>
<span class=ln>15</span>  <span class=n>lane</span> <span class=ss>:build</span> <span class=k>do</span> <span class=o>|</span><span class=n>options</span><span class=o>|</span>
<span class=ln>16</span>    <span class=c1># 调用上面 prepare 私有任务</span>
<span class=ln>17</span>    <span class=n>prepare</span>
<span class=ln>18</span>
<span class=ln>19</span>    <span class=k>case</span> <span class=n>options</span><span class=o>[</span><span class=ss>:type</span><span class=o>]</span>
<span class=ln>20</span>    <span class=k>when</span> <span class=s1>&#39;adhoc&#39;</span>
<span class=ln>21</span>      <span class=c1># 调用 下面 adhoc 任务</span>
<span class=ln>22</span>      <span class=n>adhoc</span>
<span class=ln>23</span>    <span class=k>else</span>
<span class=ln>24</span>      <span class=c1># 调用下面 appstore 任务</span>
<span class=ln>25</span>      <span class=n>appstore</span>
<span class=ln>26</span>    <span class=k>end</span>
<span class=ln>27</span>  <span class=k>end</span>
<span class=ln>28</span>
<span class=ln>29</span>  <span class=n>desc</span> <span class=s1>&#39;构建 adhoc 任务&#39;</span>
<span class=ln>30</span>  <span class=n>desc</span> <span class=s1>&#39;fastlane adhoc&#39;</span>
<span class=ln>31</span>  <span class=n>lane</span> <span class=ss>:adhoc</span> <span class=k>do</span>
<span class=ln>32</span>    <span class=n>gym</span><span class=p>(</span><span class=ss>type</span><span class=p>:</span> <span class=s1>&#39;adhoc&#39;</span><span class=p>)</span>
<span class=ln>33</span>  <span class=k>end</span>
<span class=ln>34</span>
<span class=ln>35</span>  <span class=n>desc</span> <span class=s1>&#39;构建 appstore 任务&#39;</span>
<span class=ln>36</span>  <span class=n>desc</span> <span class=s1>&#39;fastlane appstore&#39;</span>
<span class=ln>37</span>  <span class=n>lane</span> <span class=ss>:appstore</span> <span class=k>do</span>
<span class=ln>38</span>    <span class=n>gym</span><span class=p>(</span><span class=ss>type</span><span class=p>:</span> <span class=s1>&#39;appstore&#39;</span><span class=p>)</span>
<span class=ln>39</span>  <span class=k>end</span>
<span class=ln>40</span><span class=k>end</span>
</code></pre></div><p>上面的任务中，<code>build</code>/<code>adhoc</code>/<code>appstore</code> 都可以执行，只有 <code>prepare</code> 是无法通过命令行外部执行，如果执行会直接报错：</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash><span class=ln>1</span>$ fastlane prepare
<span class=ln>2</span><span class=o>[</span>19:17:42<span class=o>]</span>: You can<span class=s1>&#39;t call the private lane &#39;</span>prepare<span class=err>&#39;</span> directly
</code></pre></div><h3 id=任务返回值>任务返回值</h3><p>和 ruby 的方法一致，每个 lane 最后一行会默认作为返回值（无需 <a href=http://learnrubythehardway.org/book/ex21.html>return</a>）。</p><div class=highlight><pre class=chroma><code class=language-ruby data-lang=ruby><span class=ln>1</span>
<span class=ln>2</span><span class=n>lane</span> <span class=ss>:sum</span> <span class=k>do</span> <span class=o>|</span><span class=n>options</span><span class=o>|</span>
<span class=ln>3</span>  <span class=n>options</span><span class=o>[</span><span class=ss>:a</span><span class=o>]</span> <span class=o>+</span> <span class=n>optiona</span><span class=o>[</span><span class=ss>:b</span><span class=o>]</span>
<span class=ln>4</span><span class=k>end</span>
<span class=ln>5</span>
<span class=ln>6</span><span class=n>lane</span> <span class=ss>:calculate</span> <span class=k>do</span>
<span class=ln>7</span>  <span class=n>value</span> <span class=o>=</span> <span class=n>sum</span><span class=p>(</span><span class=ss>a</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span> <span class=ss>b</span><span class=p>:</span> <span class=mi>5</span><span class=p>)</span>
<span class=ln>8</span>  <span class=nb>puts</span> <span class=n>value</span> <span class=c1>#=&gt; 8</span>
<span class=ln>9</span><span class=k>end</span>
</code></pre></div><h3 id=引入外部任务文件>引入外部任务文件</h3><p><code>Fastfile</code> 除了自身以外还能够引入外部其他的 <code>Fastfile</code> 并调用任务，只需要导入外部文件并使用特殊的方法标识即可：</p><h4 id=1-import---导入本地文件>1. import - 导入本地文件</h4><div class=highlight><pre class=chroma><code class=language-ruby data-lang=ruby><span class=ln>1</span><span class=c1># 导入 lanes 目录的 AndroidFastfile</span>
<span class=ln>2</span><span class=n>import</span> <span class=s2>&#34;lanes/AndroidFastfile&#34;</span>
</code></pre></div><h4 id=2-import_from_git---导入-git-仓库文件>2. import_from_git - 导入 git 仓库文件</h4><p>可以直接引入 git 仓库的 Fastfile 文件是一个非常赞的功能，通过使用发现其实现原理是先把 git 仓库克隆下来后在引入相对于的文件，因此建议国内在没有网络加速（翻墙）的情况下尽量不用引入比较大的 git 仓库，否则使用会需要漫长的等待&mldr;</p><div class=highlight><pre class=chroma><code class=language-ruby data-lang=ruby><span class=ln>1</span><span class=c1># 导入 mozilla/firefox-ios 项目下 fastlane 下面 Fastfile 文件</span>
<span class=ln>2</span><span class=n>import_from_git</span><span class=p>(</span><span class=ss>url</span><span class=p>:</span> <span class=s1>&#39;https://github.com/mozilla/firefox-ios&#39;</span><span class=p>)</span>
<span class=ln>3</span><span class=c1># 或者</span>
<span class=ln>4</span><span class=n>import_from_git</span><span class=p>(</span><span class=ss>url</span><span class=p>:</span> <span class=s1>&#39;git@github.com:mozilla/firefox-ios.git&#39;</span><span class=p>,</span>
<span class=ln>5</span>               <span class=ss>path</span><span class=p>:</span> <span class=s1>&#39;fastlane/Fastfile&#39;</span><span class=p>)</span>
</code></pre></div><p>假若外部引入的 <code>Fastfile</code> 有个方法是 <strong>build</strong>，在命令行工具直接执行即可，如果外部和内部都有相同的任务名，执行会直接报错：</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash><span class=ln>1</span>$ fastlane ios build
<span class=ln>2</span>
<span class=ln>3</span><span class=o>[</span>!<span class=o>]</span> Lane <span class=s1>&#39;gradle&#39;</span> was defined multiple times!
</code></pre></div><p>如果发生这样的事情且你希望在主体 <code>Fastfile</code> 也调用的话需要使用特殊的方法定义：<code>override_lane</code></p><blockquote><p>注意：此方法只会覆盖外部的相同方法名的代码执行，目前暂时无法使用类似 ruby 的 <code>super</code> 继承原由方法！</p></blockquote><div class=highlight><pre class=chroma><code class=language-ruby data-lang=ruby><span class=ln>1</span><span class=n>override_lane</span> <span class=ss>:build</span> <span class=k>do</span>
<span class=ln>2</span>  <span class=o>...</span>
<span class=ln>3</span><span class=k>end</span>
</code></pre></div><h3 id=任务查看>任务查看</h3><p>只需执行下面这行命令就可以看到非私有任务的可用列表信息</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash><span class=ln> 1</span>$ fastlane lanes
<span class=ln> 2</span>
<span class=ln> 3</span>--------- ios---------
<span class=ln> 4</span>----- fastlane ios build
<span class=ln> 5</span>通用的构建任务
<span class=ln> 6</span>fastlane build
<span class=ln> 7</span>fastlane build type:adhoc
<span class=ln> 8</span>
<span class=ln> 9</span>----- fastlane ios adhoc
<span class=ln>10</span>构建 adhoc 任务
<span class=ln>11</span>
<span class=ln>12</span>----- fastlane ios appstore
<span class=ln>13</span>构建 appstore 任务
<span class=ln>14</span>
<span class=ln>15</span>Execute using <span class=sb>`</span>fastlane <span class=o>[</span>lane_name<span class=o>]</span><span class=sb>`</span>
</code></pre></div><h2 id=扩展action>扩展（Action）</h2><p>扩展是 fastlane 的杀手锏，重在集成了众多非常优秀好用的方法供 lane 内部使用，截至 fastlane v<code>1.98.0</code> 版本以包含 175 个扩展，这个数量还在陆续增加中。扩展初期是由发起人一个人完成，后续的大部分都是社区共享，如果你发现没有你想要的扩展，可以先去 <a href="https://github.com/fastlane/fastlane/issues?q=is%3Aopen+is%3Aissue+label%3Aaction">issues</a> 搜索下没有要么自己动手提交要么只有等待了.</p><h3 id=扩展列表>扩展列表</h3><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash><span class=ln> 1</span>$ fastlane actions
<span class=ln> 2</span>+--------------------+-------------------------------------------------------------+------------------+
<span class=ln> 3</span><span class=p>|</span>                                   Available fastlane actions                                        <span class=p>|</span>
<span class=ln> 4</span>+--------------------+-------------------------------------------------------------+------------------+
<span class=ln> 5</span><span class=p>|</span> Action             <span class=p>|</span> Description                                                 <span class=p>|</span> Author           <span class=p>|</span>
<span class=ln> 6</span>+--------------------+-------------------------------------------------------------+------------------+
<span class=ln> 7</span><span class=p>|</span> adb                <span class=p>|</span> Run ADB Actions                                             <span class=p>|</span> hjanuschka       <span class=p>|</span>
<span class=ln> 8</span><span class=p>|</span> adb_devices        <span class=p>|</span> Get an Array of Connected android device serials            <span class=p>|</span> hjanuschka       <span class=p>|</span>
<span class=ln> 9</span><span class=p>|</span> add_git_tag        <span class=p>|</span> This will add an annotated git tag to the current branch    <span class=p>|</span> Multiple         <span class=p>|</span>
<span class=ln>10</span>...
<span class=ln>11</span>+--------------------+-------------------------------------------------------------+------------------+
<span class=ln>12</span>  Total of <span class=m>175</span> actions
<span class=ln>13</span>
<span class=ln>14</span>Get more information <span class=k>for</span> one specific action using <span class=sb>`</span>fastlane action <span class=o>[</span>name<span class=o>]</span><span class=sb>`</span>
</code></pre></div><h3 id=扩展使用帮助>扩展使用帮助</h3><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash><span class=ln> 1</span><span class=c1># 查看 adb 扩展的使用帮助</span>
<span class=ln> 2</span>$ fastlane action adb
<span class=ln> 3</span>Loading documentation <span class=k>for</span> adb:
<span class=ln> 4</span>
<span class=ln> 5</span>+---------------------------------+
<span class=ln> 6</span><span class=p>|</span>               adb               <span class=p>|</span>
<span class=ln> 7</span>+---------------------------------+
<span class=ln> 8</span><span class=p>|</span> Run ADB Actions                 <span class=p>|</span>
<span class=ln> 9</span><span class=p>|</span>                                 <span class=p>|</span>
<span class=ln>10</span><span class=p>|</span> see adb --help <span class=k>for</span> more details <span class=p>|</span>
<span class=ln>11</span><span class=p>|</span>                                 <span class=p>|</span>
<span class=ln>12</span><span class=p>|</span> Created by hjanuschka           <span class=p>|</span>
<span class=ln>13</span>+---------------------------------+
<span class=ln>14</span>
<span class=ln>15</span>+----------+----------------------------------------------------------------------+-------------------+---------+
<span class=ln>16</span><span class=p>|</span>                                                  adb Options                                                  <span class=p>|</span>
<span class=ln>17</span>+----------+----------------------------------------------------------------------+-------------------+---------+
<span class=ln>18</span><span class=p>|</span> Key      <span class=p>|</span> Description                                                          <span class=p>|</span> Env Var           <span class=p>|</span> Default <span class=p>|</span>
<span class=ln>19</span>+----------+----------------------------------------------------------------------+-------------------+---------+
<span class=ln>20</span><span class=p>|</span> serial   <span class=p>|</span> Android serial, which device should be used <span class=k>for</span> this <span class=nb>command</span>         <span class=p>|</span> FL_ANDROID_SERIAL <span class=p>|</span>         <span class=p>|</span>
<span class=ln>21</span><span class=p>|</span> <span class=nb>command</span>  <span class=p>|</span> All commands you want to pass to the adb command, e.g. <span class=sb>`</span>kill-server<span class=sb>`</span> <span class=p>|</span> FL_ADB_COMMAND    <span class=p>|</span>         <span class=p>|</span>
<span class=ln>22</span><span class=p>|</span> adb_path <span class=p>|</span> The path to your <span class=sb>`</span>adb<span class=sb>`</span> binary                                        <span class=p>|</span> FL_ADB_PATH       <span class=p>|</span> adb     <span class=p>|</span>
<span class=ln>23</span>+----------+----------------------------------------------------------------------+-------------------+---------+
<span class=ln>24</span>
<span class=ln>25</span>+-------------------------------+
<span class=ln>26</span><span class=p>|</span>       adb Return Value        <span class=p>|</span>
<span class=ln>27</span>+-------------------------------+
<span class=ln>28</span><span class=p>|</span> The output of the adb <span class=nb>command</span> <span class=p>|</span>
<span class=ln>29</span>+-------------------------------+
<span class=ln>30</span>
<span class=ln>31</span>More information can be found on https://github.com/fastlane/fastlane/blob/master/fastlane/docs/Actions.md
</code></pre></div><h3 id=创建自定义扩展>创建自定义扩展</h3><p>通过内置的命令创建你需要的扩展，扩展名必须是全部小写且只能使用下划线分割词组，生成好的扩展文件会在 <code>fastlane/actions</code> 目录找到:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash><span class=ln>1</span>$ fastlane new_action
<span class=ln>2</span>Must be lower <span class=k>case</span>, and use a <span class=s1>&#39;_&#39;</span> between words. Do not use <span class=s1>&#39;.&#39;</span>
<span class=ln>3</span>examples: <span class=s1>&#39;testflight&#39;</span>, <span class=s1>&#39;upload_to_s3&#39;</span>
<span class=ln>4</span>Name of your action: hello
<span class=ln>5</span><span class=o>[</span>15:33:15<span class=o>]</span>: Created new action file <span class=s1>&#39;./fastlane/actions/hello.rb&#39;</span>. Edit it to implement your custom action.
</code></pre></div><p>这块会占比较大的篇幅，尽情期待后续的展开。</p><h3 id=引入外部扩展>引入外部扩展</h3><p>这块其实也有两种方法可以引入，文件引入是官方教程提供的方法，第二种是我个人尝试出来的，第三种是最近版本才官方支持的。</p><h4 id=1-本地文件引入>1. 本地文件引入</h4><p>自定义的扩展其实也算是本地文件引入的一种形式，当然位于其他路径的通过指定方法也能做到</p><div class=highlight><pre class=chroma><code class=language-ruby data-lang=ruby><span class=ln>1</span><span class=c1># 引入项目根目录 script/share_actions 路径</span>
<span class=ln>2</span><span class=n>actions_path</span> <span class=s1>&#39;../script/share_actions&#39;</span>
</code></pre></div><h4 id=2-rubygem-引入>2. rubygem 引入</h4><blockquote><p>不再建议使用本方法，请看第三种插件引入。</p></blockquote><p>我在团队内部创建了一个自定义的扩展，仅限于团队内部使用而无法贡献社区，我只能采取封装成 ruby gem 包，通过 ruby 的 <code>require</code> 方式引入，最终可以完美支持，目前已在项目中使用大半年之久。最重要的是我是开源的：<a href=https://github.com/icyleaf/fastlane-qyer>fastlane-qyer</a></p><div class=highlight><pre class=chroma><code class=language-ruby data-lang=ruby><span class=ln>1</span><span class=c1># 首先安装需要的 rubygem: gem install fastlane-qyer</span>
<span class=ln>2</span><span class=nb>require</span> <span class=s1>&#39;fastlane-qyer&#39;</span>
<span class=ln>3</span>
<span class=ln>4</span><span class=n>lane</span> <span class=ss>:upload</span> <span class=k>do</span>
<span class=ln>5</span>  <span class=n>qyer</span><span class=p>(</span><span class=ss>api_key</span><span class=p>:</span> <span class=s1>&#39;[token]&#39;</span><span class=p>)</span>
<span class=ln>6</span><span class=k>end</span>
</code></pre></div><p>注意，使用 rubygem 引入的无法在 fastlane actions 中显示出来，也无法使用 fastlane action [name] 查看使用帮助。我猜想一是官方没有这样提供思路，二是就算你引入了 gem 也不是特别好判断里面的文件结构。</p><h4 id=3-插件引入>3. 插件引入</h4><p>我注意到 <a href=https://github.com/fastlane/fastlane/releases/tag/1.93.0>1.93.0</a> 增加了插件机制，很好的解决第二种出现的一些问题。大概看了一下主要是采用 <code>Gemfile</code> 的方式使用 <code>Pluginfile</code> 维护了引入第三方插件列表。实现原理还是属于第二种方法。</p><p>通过 <code>fastlane search_plugins</code> 查看当前支持的插件，并使用 <code>fastlane add_plugins [name]</code> 引入。</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash><span class=ln> 1</span>$ fastlane search_plugins
<span class=ln> 2</span><span class=o>[</span>16:04:33<span class=o>]</span>: Listing all available fastlane plugins
<span class=ln> 3</span>
<span class=ln> 4</span>+--------------------------+---------------------------------------------------+-----------+
<span class=ln> 5</span><span class=p>|</span>                                Available fastlane plugins                                <span class=p>|</span>
<span class=ln> 6</span>+--------------------------+---------------------------------------------------+-----------+
<span class=ln> 7</span><span class=p>|</span> Name                     <span class=p>|</span> Description                                       <span class=p>|</span> Downloads <span class=p>|</span>
<span class=ln> 8</span>+--------------------------+---------------------------------------------------+-----------+
<span class=ln> 9</span><span class=p>|</span> ruby                     <span class=p>|</span> Useful fastlane actions <span class=k>for</span> Ruby projects         <span class=p>|</span> <span class=m>782</span>       <span class=p>|</span>
<span class=ln>10</span><span class=p>|</span> versioning               <span class=p>|</span> Allows to work set/get app version directly       <span class=p>|</span> <span class=m>758</span>       <span class=p>|</span>
<span class=ln>11</span><span class=p>|</span>                          <span class=p>|</span> to/from Info.plist                                <span class=p>|</span>           <span class=p>|</span>
<span class=ln>12</span><span class=p>|</span> branding                 <span class=p>|</span> Add some branding to your fastlane output         <span class=p>|</span> <span class=m>716</span>       <span class=p>|</span>
<span class=ln>13</span><span class=p>|</span> instrumented_tests       <span class=p>|</span> New action to run instrumented tests <span class=k>for</span> android. <span class=p>|</span> <span class=m>590</span>       <span class=p>|</span>
<span class=ln>14</span><span class=p>|</span>                          <span class=p>|</span> This basically creates and boots an emulator      <span class=p>|</span>           <span class=p>|</span>
<span class=ln>15</span><span class=p>|</span>                          <span class=p>|</span> before running an gradle commands so that you can <span class=p>|</span>           <span class=p>|</span>
<span class=ln>16</span><span class=p>|</span>                          <span class=p>|</span> run instrumented tests against that emulator.     <span class=p>|</span>           <span class=p>|</span>
<span class=ln>17</span><span class=p>|</span>                          <span class=p>|</span> After the gradle <span class=nb>command</span> is executed, the avd     <span class=p>|</span>           <span class=p>|</span>
<span class=ln>18</span><span class=p>|</span>                          <span class=p>|</span> gets shut down and deleted. This is really        <span class=p>|</span>           <span class=p>|</span>
<span class=ln>19</span><span class=p>|</span>                          <span class=p>|</span> helpful on CI services, keeping them clean and    <span class=p>|</span>           <span class=p>|</span>
<span class=ln>20</span><span class=p>|</span>                          <span class=p>|</span> always having a fresh avd <span class=k>for</span> testing.            <span class=p>|</span>           <span class=p>|</span>
<span class=ln>21</span><span class=p>|</span> xamarin_build            <span class=p>|</span> Build xamarin android<span class=se>\i</span>os projects                <span class=p>|</span> <span class=m>582</span>       <span class=p>|</span>
<span class=ln>22</span><span class=p>|</span> appicon                  <span class=p>|</span> Generate required icon sizes and iconset from a   <span class=p>|</span> <span class=m>509</span>       <span class=p>|</span>
<span class=ln>23</span><span class=p>|</span>                          <span class=p>|</span> master application icon.                          <span class=p>|</span>           <span class=p>|</span>
<span class=ln>24</span>...
<span class=ln>25</span><span class=p>|</span> download_file            <span class=p>|</span> This action downloads a file from an HTTP/HTTPS   <span class=p>|</span> <span class=m>171</span>       <span class=p>|</span>
<span class=ln>26</span><span class=p>|</span>                          <span class=p>|</span> url <span class=o>(</span>e.g. ZIP file<span class=o>)</span> and puts it in a destination  <span class=p>|</span>           <span class=p>|</span>
<span class=ln>27</span><span class=p>|</span>                          <span class=p>|</span> path                                              <span class=p>|</span>           <span class=p>|</span>
<span class=ln>28</span>+--------------------------+---------------------------------------------------+-----------+
<span class=ln>29</span>
<span class=ln>30</span><span class=c1># 添加 sentry 插件</span>
<span class=ln>31</span>$ fastlane add_plugin sentry
<span class=ln>32</span><span class=o>[</span>16:16:23<span class=o>]</span>: Plugin <span class=s1>&#39;fastlane-plugin-sentry&#39;</span> was added to <span class=s1>&#39;./fastlane/Pluginfile&#39;</span>
<span class=ln>33</span><span class=o>[</span>16:16:23<span class=o>]</span>: It looks like fastlane plugins are not yet <span class=nb>set</span> up <span class=k>for</span> this project.
<span class=ln>34</span><span class=o>[</span>16:16:23<span class=o>]</span>: fastlane will create a new Gemfile at path <span class=s1>&#39;Gemfile&#39;</span>
<span class=ln>35</span><span class=o>[</span>16:16:23<span class=o>]</span>: This change is neccessary <span class=k>for</span> fastlane plugins to work
<span class=ln>36</span>Should fastlane modify the Gemfile at path <span class=s1>&#39;Gemfile&#39;</span> <span class=k>for</span> you? <span class=o>(</span>y/n<span class=o>)</span>
<span class=ln>37</span>y
<span class=ln>38</span><span class=o>[</span>16:16:29<span class=o>]</span>: Successfully modified <span class=s1>&#39;Gemfile&#39;</span>
<span class=ln>39</span><span class=o>[</span>16:16:29<span class=o>]</span>: Make sure to commit your Gemfile, Gemfile.lock and Pluginfile to version control
<span class=ln>40</span>Installing plugin dependencies...
<span class=ln>41</span>Successfully installed plugins
<span class=ln>42</span>
<span class=ln>43</span>$ cat fastlane/Pluginfile
<span class=ln>44</span><span class=c1># Autogenerated by fastlane</span>
<span class=ln>45</span><span class=c1>#</span>
<span class=ln>46</span><span class=c1># Ensure this file is checked in to source control!</span>
<span class=ln>47</span>
<span class=ln>48</span>gem <span class=s1>&#39;fastlane-plugin-sentry&#39;</span>
</code></pre></div><p>更详细的继续期待后续报道，我要挖坑无数。</p><h3 id=扩展的命令行调用>扩展的命令行调用</h3><p>社区的力量果然是很强大的，陆续添加了那么多功能，早期用户表示不开心！嗯，由于社区的呼声和贡献目前可以通过命令调用扩展：</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash><span class=ln>1</span><span class=c1># 使用 notification 扩展发送一个通知消息</span>
<span class=ln>2</span>$ fastlane run notification message:<span class=s2>&#34;Hi macOS&#34;</span> title:<span class=s2>&#34;Fastlane Notification&#34;</span>
<span class=ln>3</span><span class=o>[</span>15:58:05<span class=o>]</span>: --------------------------
<span class=ln>4</span><span class=o>[</span>15:58:05<span class=o>]</span>: --- Step: notification ---
<span class=ln>5</span><span class=o>[</span>15:58:05<span class=o>]</span>: --------------------------
<span class=ln>6</span><span class=o>[</span>15:58:05<span class=o>]</span>: Result: <span class=nb>true</span>
</code></pre></div><h2 id=辅助功能>辅助功能</h2><h3 id=自动更新>自动更新</h3><p>fastlane 提供一个方法 <code>update_fastlane</code> 用于对于自身的版本检查和更新，这个第一篇文章我也有提到过。它其实一个是一个扩展，使用 <code>fastlane action update_fastlane</code> 能够看到使用帮助。它有一个参数是可以指定检查特定的 fastlane 工具并进行更新，但其实它是使用 rubygems 进行对 gem 的更新，因此这块其实可以传入任何需要检查并更新的 gem：</p><div class=highlight><pre class=chroma><code class=language-ruby data-lang=ruby><span class=ln>1</span><span class=n>update_fastlane</span><span class=p>(</span><span class=ss>tools</span><span class=p>:</span><span class=s1>&#39;fastlane,gym,match,cocoapods,rest-client&#39;</span><span class=p>)</span>
</code></pre></div><h3 id=环境变量>环境变量</h3><p>从 fastlane 的设计体系上在各个地方都加入了环境变量的支持，每个扩展的参数、以及扩展需要共享给其他扩展和任务读取的数据都是通过环境变量获取，如下是我收集的比较常用的列表：</p><table><thead><tr><th>环境变量</th><th>来源</th><th>说明</th><th>备注</th></tr></thead><tbody><tr><td>FASTLANE_USER</td><td>credentials_manager</td><td>Apple 开发者账户名</td><td>验证通过后会保存 Keychain</td></tr><tr><td>FASTLANE_PASSWORD</td><td>credentials_manager</td><td>Apple 开发者账户密码</td><td>验证通过后会保存 Keychain</td></tr><tr><td>FASTLANE_TEAM_IDCERT_TEAM_ID</td><td>producesigh</td><td>Apple 团队 ID</td><td></td></tr><tr><td>DELIVER_USER&lt;br >PRODUCE_USERNAME</td><td>deliverproduce</td><td>iTunesConnect 账户名</td><td></td></tr><tr><td>DELIVER_PASSWORD</td><td>deliver</td><td>iTunesConnect 账户密码</td><td></td></tr><tr><td>MATCH_PASSWORD</td><td>match</td><td>证书加/解密密码</td><td></td></tr><tr><td>FASTLANE_XCODE_LIST_TIMEOUT</td><td>fastlane_core</td><td>获取 iOS Scheme 的超时时间</td><td>默认 10s</td></tr></tbody></table></div><div class=post-copyright><p class=copyright-item><span>Author:</span>
<span>icyleaf</span></p><p class=copyright-item><span>Link:</span>
<a href=https://icyleaf.com/2016/07/fastlane-in-action/>https://icyleaf.com/2016/07/fastlane-in-action/</a></p></div><div class=post-tags><section><i class="iconfont icon-tag"></i>Tag(s):
<span class=tag><a href=https://icyleaf.com/tags/ios/>#iOS</a></span>
<span class=tag><a href=https://icyleaf.com/tags/android/>#Android</a></span>
<span class=tag><a href=https://icyleaf.com/tags/ci/>#CI</a></span>
<span class=tag><a href=https://icyleaf.com/tags/cd/>#CD</a></span>
<span class=tag><a href=https://icyleaf.com/tags/ruby/>#Ruby</a></span>
<span class=tag><a href=https://icyleaf.com/tags/fastlane/>#Fastlane</a></span></section><section><a href=javascript:window.history.back();>back</a></span> ·
<span><a href=https://icyleaf.com/>home</a></span></section></div><div class=post-nav><a href=https://icyleaf.com/2016/07/gitlab-api-wrapper-for-crystal/ class=prev rel=prev title="Gitlab API Wrapper for Crystal"><i class="iconfont icon-left"></i>&nbsp;Gitlab API Wrapper for Crystal</a>
<a href=https://icyleaf.com/2016/08/how-to-install-rancher-on-osx/ class=next rel=next title="如何在 OS X 上安装 Rancher">如何在 OS X 上安装 Rancher&nbsp;<i class="iconfont icon-right"></i></a></div><div class=post-social><div class=social-links><style type=text/css>@font-face{font-family:iconfont;src:url(//at.alicdn.com/t/font_1910062_4213q7gpkpy.eot);src:url(//at.alicdn.com/t/font_1910062_4213q7gpkpy.eot?#iefix)format('embedded-opentype'),url(//at.alicdn.com/t/font_1910062_4213q7gpkpy.woff2)format('woff2'),url(//at.alicdn.com/t/font_1910062_4213q7gpkpy.woff)format('woff'),url(//at.alicdn.com/t/font_1910062_4213q7gpkpy.ttf)format('truetype'),url(//at.alicdn.com/t/font_1910062_4213q7gpkpy.svg#iconfont)format('svg')}</style><a class=bloglogo href=https://github.com/icyleaf target=_blank rel="me noopener"><i class="iconfont icon-github" alt=github></i></a>
<a class=bloglogo href=https://twitter.com/icyleaf target=_blank rel="me noopener"><i class="iconfont icon-twitter" alt=twitter></i></a>
<a class=bloglogo href=https://www.facebook.com/icyleaf target=_blank rel="me noopener"><i class="iconfont icon-facebook" alt=facebook></i></a>
<a class=bloglogo href=https://www.linkedin.com/in/icyleaf target=_blank rel="me noopener"><i class="iconfont icon-linkedin" alt=linkedin></i></a>
<a class=bloglogo href=https://www.instagram.com/icyleaf/ target=_blank rel="me noopener"><i class="iconfont icon-instagram" alt=instagram></i></a>
<a class=bloglogo href=https://www.douban.com/people/icyleaf target=_blank rel="me noopener"><i class="iconfont icon-douban" alt=douban></i></a></div></div><div class=post-comment><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//icyleaf.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></article></div></main><footer class=footer><div class=copyright>&copy;
<span itemprop=copyrightYear>2005 - 2021</span>
<span>🍺</span>
<span class=author itemprop=copyrightHolder><a href=https://icyleaf.com/>icyleaf</a></span>
| <span>Powered by <a href=https://gohugo.io/ target=_blank rel="external nofollow">Hugo</a> & <a href=https://github.com/icyleaf/hugo-theme-nicesima target=_blank rel="external nofollow">nicesima</a></span></div></footer><script src=https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js crossorigin=anonymous></script><script defer src=https://icyleaf.com/js/vendor_main.min.js></script><script src=https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin=anonymous></script><script>pangu.spacingPage()</script><script>(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)})(window,document,'script','//www.google-analytics.com/analytics.js','ga'),ga('create','UA-2570916-5','auto'),ga('send','pageview')</script></div></body></html>