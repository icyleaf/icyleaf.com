<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>CSS on icyleaf</title><link>https://icyleaf.com/tags/css/</link><description>Recent content in CSS on icyleaf</description><language>zh</language><lastBuildDate>Tue, 01 Nov 2022 11:24:24 +0800</lastBuildDate><atom:link href="https://icyleaf.com/tags/css/index.xml" rel="self" type="application/rss+xml"/><item><title>使用 CSS 支持图片黑暗模式动态切换</title><link>https://icyleaf.com/2022/11/how-to-render-image-between-light-and-dark-mode-with-css/</link><pubDate>Tue, 01 Nov 2022 11:24:24 +0800</pubDate><guid>https://icyleaf.com/2022/11/how-to-render-image-between-light-and-dark-mode-with-css/</guid><description>不用 Javascript 就不用 Javascript（傲娇）</description><content:encoded><![CDATA[<p><a href="https://github.com/tryzealot/zealot">Zealot</a> 项目是我个人长期以来的 Side Project，<a href="https://zealot.ews.im/zh-Hans/docs/user-guide/changelog#450-2022-08-19">4.5.0</a> 版本开始支持了黑暗模式并提供明亮、黑暗和随系统自动切换三种设置，前两种非常明确可以强制设定，随系统自动切换略微棘手 Javascript 一直是我的弱项，还好 CSS 提供 <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/@media/prefers-color-scheme">prefers-color-scheme</a> 能够很容易的判断系统主题。受益于 <a href="https://github.com/ColorlibHQ/AdminLTE/releases/tag/v3.2.0">AdminLTE</a> 支持黑暗模式，我只需要把用户设定的值传递给 Javascript 并动态<a href="https://github.com/tryzealot/zealot/blob/4.5.0/app/javascript/controllers/global_controller.js#L26-L37">设置特定的 CSS class 变量</a>。</p>
<h2 id="效果">效果</h2>
<p>尝试修改系统设置的主题，切换明亮和黑暗模式下面的结果有什么变化：</p>






<script
  data-slug-hash="mdKVOMy"
  data-user="your_username"
  data-height="500"
  data-default-tab="result"
  data-theme-id="8862"
  class='codepen'
  async
  src="//codepen.io/assets/embed/ei.js"
></script>

<p>如果看不到上面的演示，请<a href="https://codepen.io/icyleaf/pen/mdKVOMy">点击这里</a>打开新窗口预览。</p>
<h2 id="原理">原理</h2>
<h3 id="样式适配">样式适配</h3>
<p>CSS 样式的模式切换使用的是额外添加的 <code>@media (prefers-color-scheme: dark)</code> 作用域，在它里面对样式重新设置就可以完成对黑暗模式的修改：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-css" data-lang="css"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nt">body</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">  <span class="k">font-family</span><span class="p">:</span> <span class="n">system-ui</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">  <span class="k">background</span><span class="p">:</span> <span class="mh">#FFFFFF</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">  <span class="k">text-align</span><span class="p">:</span> <span class="kc">center</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="c">/* 黑暗模式作用域 */</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="p">@</span><span class="k">media</span> <span class="o">(</span><span class="nt">prefers-color-scheme</span><span class="o">:</span> <span class="nt">dark</span><span class="o">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">  <span class="nt">body</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="k">background</span><span class="p">:</span> <span class="mh">#000000</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>默认情况下 body 会设置系统字体、白色背景色和字体居中，黑暗模式下会覆盖背景色为黑色。</p>
<h3 id="图片适配">图片适配</h3>
<p>根据 CSS 样式的规则理论上可以把图片设置为 <code>background-image</code> ：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-css" data-lang="css"><span class="line"><span class="ln">1</span><span class="cl"><span class="p">.</span><span class="nc">intro-image</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">  <span class="k">background-image</span><span class="p">:</span> <span class="nb">url</span><span class="p">(</span><span class="sx">intro-light.png</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="p">@</span><span class="k">media</span> <span class="o">(</span><span class="nt">prefers-color-scheme</span><span class="o">:</span> <span class="nt">dark</span><span class="o">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">  <span class="p">.</span><span class="nc">intro-image</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">    <span class="k">background-image</span><span class="p">:</span> <span class="nb">url</span><span class="p">(</span><span class="sx">intro-dark.png</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">8</span><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="ln">9</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>这个方案能实现却多了额外的设置，设置图片大小和缩放方式，也不太符合 HTML 的规范，图片建议设置到 HTML 标签中，<a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/picture"><!-- raw HTML omitted --></a> 标签就出现了。</p>
<p>它允许设置多个源 <code>source</code> 来应对不同的环境变量，如果都没有匹配或浏览器不支持再通过 img 标签兜底，利用该特性把 <code>prefers-color-scheme: dark</code> 添加到 <code>source</code> 中：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="ln">1</span><span class="cl"><span class="p">&lt;</span><span class="nt">picture</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">  <span class="c">&lt;!-- 如果是黑暗模式使用该地址 --&gt;</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">  <span class="p">&lt;</span><span class="nt">source</span> <span class="na">srcset</span><span class="o">=</span><span class="s">&#34;https://zealot.ews.im/img/showcase-dark.png&#34;</span> <span class="na">media</span><span class="o">=</span><span class="s">&#34;(prefers-color-scheme: dark)&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">  <span class="c">&lt;!-- 兜底方案 --&gt;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">  <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;https://zealot.ews.im/img/showcase-light.png&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="p">&lt;/</span><span class="nt">picture</span><span class="p">&gt;</span>
</span></span></code></pre></div><h2 id="实践">实践</h2>
<p>Zealot 在对图片适配手动设置和自动匹配黑暗模式是<a href="https://github.com/tryzealot/zealot/commit/b48573ce439c07be2eed305a4aac91f4475c2b27">这么做的</a>。项目主要适配的只有图片二维码，简单分解下实现步骤：</p>
<ol>
<li>动态二维码生成支持黑暗模式</li>
<li>判断系统是指定明亮或黑暗模式直接强制设定二维码图片对应的主题</li>
<li>随系统自动切换的情况下，追加 <code>picture</code> 标签做判断区分两种主题的图片地址</li>
</ol>
]]></content:encoded></item><item><title>与SPAM战斗到底：CSS篇</title><link>https://icyleaf.com/2009/02/fighting-spam-with-css/</link><pubDate>Sun, 08 Feb 2009 12:34:56 +0800</pubDate><guid>https://icyleaf.com/2009/02/fighting-spam-with-css/</guid><description>SPAM，现在还没有一个非常严格的定义。一般来说，凡是未经用户许可就强行发送到用户的邮箱中的任何电子邮件。现在应该已经广泛各种网络应用上面。...</description><content:encoded><![CDATA[<p>SPAM，现在还没有一个非常严格的定义。一般来说，凡是未经用户许可就强行发送到用户的邮箱中的任何电子邮件。现在应该已经广泛各种网络应用上面。对于网站来说，网站知名度小的时候或许还可以免于“侵犯”，可是一旦在搜索引擎收录的数量做出一些成绩，SPAM 就会主动找上门来，各种垃圾信息就会扑面而来，然而对SPAM 的战斗一起在进行，这是一场没有硝烟的战争，为了防范
SPAM，大家各显其能，招招新颖，当然还有一些专门为 SPAM 创建防御服务的网站，比如说 WordPress 自带的 <a href="http://akismet.com/">Akismet</a>。对于各种防御方法，我想应该可以写成一个系列，这个系列的内容或许是从网络上搜集或许是自己突发奇想想出来的奇招（目前应该还不可能哈）。</p>
<p>今天我带给大家的是方法另辟其境：<strong>CSS</strong>。总所周知，CSS 是一种层样式表，只是为了网站界面的展现做出重要贡献的角色。那么它怎么实现防御 SPAM 的呢？ok，接着下看。</p>
<p><strong>原理</strong></p>
<p>为了不上了就代码让大家感到迷惑，先讲一下原理：首先在创建表单的时候，添加一个对
SPAM 校验的 input
标签，然后再提交的时候进行对这个标签进行判断其值是否为空，因判断是否为
SPAM（如果你不明白 SPAM 的实现原理请看<a href="http://www.codewall.cn/blog/?p=7">这里</a>）。（看官：不就是设置成
hidden 类型吗，这谁都知道）错！我承认这是一个最常见的判断 SPAM
的流程，但这里添加的 input 类型使用的是 text 类型，这是为了防止 SPAM
在进行抓取页面进行对 input 类型判断是否有 hidden
类型为设置的，那么怎么隐藏这个 input 标签呢？那么就可以利用到 CSS 的
display 属性，哈哈，是不是明白了？好吧，看代码吧。</p>
<p><strong>代码</strong></p>
<p>HTML 代码：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln">1</span><span class="cl">Name:&lt;input name=&#34;name&#34; /&gt;&lt;br /&gt;
</span></span><span class="line"><span class="ln">2</span><span class="cl">Email:&lt;input name=&#34;email&#34; /&gt;&lt;br /&gt;
</span></span><span class="line"><span class="ln">3</span><span class="cl">Comment:&lt;input name=&#34;comment&#34; /&gt;&lt;br /&gt;
</span></span><span class="line"><span class="ln">4</span><span class="cl">&lt;input type=&#34;hidden&#34; class=&#34;special&#34; /&gt;
</span></span><span class="line"><span class="ln">5</span><span class="cl">&lt;input type=&#34;submit&#34; value=&#34;Post it&#34; /&gt;
</span></span></code></pre></div><p>CSS 代码：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln">1</span><span class="cl">body {line-height:35px;font-family:Arial, Helvetica, sans-serif;color:#333;font-size:14px;}
</span></span><span class="line"><span class="ln">2</span><span class="cl">.special {display:none;}
</span></span></code></pre></div><p>上述代码中 class 为 special 的 input 标签即为判断 SPAM 的标志。使用 CSS
对其隐藏，就在提交表单后进行对这个 input 进行判断是否为空即可。这样就简单避免 SPAM 对 input 的 hidden 判断的避免而轻松达到防御的目的。</p>
<p><strong>声明</strong></p>
<p>CSS 防御 SPAM 的实现方法来自<a href="http://www.modernblue.com/web-design-blog/fighting-spam-with-css/">Modernblue</a>
网站发布的文章。本人只是做翻译工作，特此声明。</p>
]]></content:encoded></item><item><title>CSS 中 background-image 的另类使用</title><link>https://icyleaf.com/2008/05/css-background-image-in-the-use-of-alternative/</link><pubDate>Sat, 10 May 2008 12:34:56 +0800</pubDate><guid>https://icyleaf.com/2008/05/css-background-image-in-the-use-of-alternative/</guid><description>在CSS众多的样式当中，background可以说是扮演着重要的角色，它可以设置对象的背景样式。如颜色或者使用一张图片代替，今天我要多说两句...</description><content:encoded><![CDATA[<p>在CSS众多的样式当中，background可以说是扮演着重要的角色，它可以设置对象的背景样式。如颜色或者使用一张图片代替，今天我要多说两句的就是使用一张图片的参数：image。准确的来说应该是background-image。我们可以这样用它：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln">1</span><span class="cl">body{background-image: url(http://www.icyleaf.cn/logo.jpg);
</span></span></code></pre></div><p>这都是可以的，所以说css的自由度很高，这点我很喜欢。其实css显示图片分3种，第一种是单纯的显示一个图片；第二种称之为<strong>CSS Sprites</strong>，也就是说把若干小图片合成一个大图片，然后通过background的postion参数实现效果，第三种就是我们今天说的另类用法，它也有学名称之为<strong>Inline images</strong>。实现声明一点，这个方法不适用于IE浏览器，恩，没错，IE，我们都遗弃你了。（关于CSS Sprites 的描述信息来自<a href="http://7career.org/2008/02/hpws-1.html">7career.org</a>）</p>
<p>CSS Sprites是一种把所有的图片都以base64编码以源代码的形式写在CSS文件里，格式是这样的：<strong>data:[&lt;mediatype&gt;][;base64],<!-- raw HTML omitted --></strong></p>
<p><code>data:URL</code> 标签是在1995年第一次提出，按<a href="http://tools.ietf.org/html/rfc2397">RFC2397规范的描述</a>：它是&quot;allows
inclusion of small data items as &lsquo;immediate&rsquo; data.（允许在页面中包含一些小的即时数据）&quot;。如一个内嵌的的图片可以这样引用：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln">1</span><span class="cl">body{background-image:url(data:image/gif;base64,R0lGODlhCAAIAJEAAOnp6eTk5O7m8AAAACH5BAEAAAIALAAAAAAIAAgAAAINjAMJh2q6DnxOVsqmLQA7);}
</span></span></code></pre></div><p>这段代码可以在firefox浏览器运行，恩，图片是我取自[mg12][]当前模板的背景图，呵呵(^___^)</p>
<p>base64编码简单的说是，Base64内容传送编码被设计用来把任意序列的8位字节描述为一种不易被人直接识别的形式。最早使用在windows系统的电子邮件传输的，主要是附件的传输。在那个时候的黑客们也流行过一段base64编码版的木马和病毒。为了简单篇幅，想了解的看<a href="http://www.5dmail.net/html/2004-1-30/200413084348.htm">这里</a>。</p>
<p>第一次我也是通过这个方法获取的图片的base64编码，主要原因是网上没有现成的转换这种编码的工具，估计已经被大家所遗忘掉了。我这里简单的写了个PHP代码，实现了图片编码的转换：</p>
<p>这个在线转换的背景就是上面那段代码，大家可以通过查看网页源码看到。图片的代码转换原理也很简单，通过读取图片的文件并把图片储存在一个数组（或字符串）里面，然后使用base64_encode转换即可～ok，讲解完毕。</p>
]]></content:encoded></item></channel></rss>