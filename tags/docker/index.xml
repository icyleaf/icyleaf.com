<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Docker on icyleaf</title>
    <link>https://icyleaf.com/tags/docker/index.xml</link>
    <description>Recent content in Docker on icyleaf</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh</language>
    <copyright>All rights reserved - 2019</copyright>
    <atom:link href="https://icyleaf.com/tags/docker/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>á¸«pr - æœ€å¥½ç”¨çš„ git ä»“åº“é•œåƒåŒæ­¥å·¥å…·</title>
      <link>https://icyleaf.com/2018/04/intro-hpr</link>
      <pubDate>Fri, 27 Apr 2018 18:12:23 +0800</pubDate>
      
      <guid>https://icyleaf.com/2018/04/intro-hpr</guid>
      <description>

&lt;p&gt;&lt;img src=&#34;https://github.com/icyleaf/hpr/raw/master/docs/_media/icon.png&#34; alt=&#34;icon&#34; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://icyleaf.github.io/hpr/&#34;&gt;á¸«pr&lt;/a&gt; æ˜¯ä¸€ä¸ªæŠŠä»»æ„ git ä»“åº“çš„é•œåƒåˆ° gitlab æœåŠ¡çš„åŒæ­¥å·¥å…·ï¼Œè¿˜æ”¯æŒå®šæœŸåŒæ­¥çš„åŠŸèƒ½ã€‚&lt;/p&gt;

&lt;p&gt;ç‰¹æ€§:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;æ”¯æŒ Web API æ¥å£ï¼Œå¯ç”¨äºè¿œç¨‹æ§åˆ¶ä¸ä»…é™äºç»ˆç«¯ä½¿ç”¨&lt;/li&gt;
&lt;li&gt;æ”¯æŒç»ˆç«¯å‘½ä»¤æ§åˆ¶ï¼Œæ–¹ä¾¿ä¸´æ—¶ä½¿ç”¨&lt;/li&gt;
&lt;li&gt;å®šæ—¶æ›´æ–°é•œåƒçš„ä»“åº“ï¼Œæ—¶é—´å¯è°ƒï¼Œå‘Šåˆ«ä¸é è°±çš„ crontab&lt;/li&gt;
&lt;li&gt;å‡ ä¹æ”¯æŒæ‰€æœ‰çš„ git æ‰˜ç®¡çš„ä»“åº“&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨å¯ç‹¬ç«‹éƒ¨ç½²çš„ Gitlab ä½œä¸ºé•œåƒå¹³å°&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æœ¬å·¥å…·å¯ä»¥ç”¨åˆ°çš„åœ°æ–¹:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;ä»»æ„ git ä»“åº“æºç çš„å®šæœŸåŒæ­¥&lt;/li&gt;
&lt;li&gt;Cocoapods çš„å¢ƒå†…åŠ é€Ÿå’ŒåŒæ­¥&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;å¥‘å­&#34;&gt;å¥‘å­&lt;/h2&gt;

&lt;p&gt;å¦‚æœå…³æ³¨æˆ‘åšå®¢çš„ç”¨æˆ·æˆ–è€…æ›¾ç»çœ‹åˆ°è¿‡å¦å¤–ä¸€ç¯‡æ–‡ç« &lt;a href=&#34;http://icyleaf.com/2015/01/speed-up-cocoapods/&#34;&gt;æé€ŸåŒ– CocoaPods&lt;/a&gt;çš„è¯ä¸”å®è·µçš„ç”¨æˆ·ä¼šæ˜ç™½ä¸ºä»€ä¹ˆä¼šæœ‰å®ƒçš„äº§ç”Ÿã€‚
åœ¨æˆ‘å‘å¸ƒé‚£ç¯‡æ–‡ç« çš„æ—¶å€™é‚£å¥—ä½“ç³»å·²ç»åœ¨æˆ‘ä»¬å…¬å¸çš„æœåŠ¡å™¨ä¸Šè¿è¡Œä¸”æˆªè‡³ç›®å‰å·²ç»æŒç»­è¿è¡Œäº† 3 å¹´å¤šï¼&lt;/p&gt;

&lt;p&gt;é‚£ä¸ªæ–¹æ¡ˆå¹¶ä¸å®Œç¾ï¼Œé™¤äº†è°ƒç”¨å¿…é¡»é€šè¿‡è„šæœ¬çš„è¹©è„šçš„æ–¹æ¡ˆå¤–å‡ºé—®é¢˜æœ€å¤šçš„ä¸»è¦æ˜¯ gitlab-mirrors
åªèƒ½ä½¿ç”¨ crontab åšå®šæ—¶ä»»åŠ¡è¿™æ ·ä¼šå› å¤šä¸ªé•œåƒåœ¨åŒæ­¥æœªå®Œæˆçš„æƒ…å†µä¸‹é‡å¤å¼€å¯æ–°çš„åŒæ­¥ä»»åŠ¡ï¼Œä¸€ä¸ªä»»åŠ¡ä¸æ˜æ˜¾ä¸€æ—¦ç§¯æ”’å¤šäº†èµ·æ¥è¿˜ä¼šæ…¢æ…¢çš„èš•é£Ÿå†…å­˜å› æ­¤åˆä¸å¾—ä¸ ssh åˆ°æœåŠ¡å™¨
å¼€å§‹æ€è¿›ç¨‹ç›¸å½“äºé‡ç½®ã€‚&lt;/p&gt;

&lt;p&gt;å½“æ—¶æƒ³é‡æ–°åšä¸€ä¸ªçš„æƒ³æ³•å…¶å® 2017 å¹´å°±äº§ç”Ÿäº†ç”¨ ruby å†™äº†ä¸ªå¤´å½“æ—¶é¡¹ç›®å‘½åä¸º nightwing ä½† ruby çš„é—®é¢˜åœ¨éƒ¨ç½²ä¸Šé¢æœ‰æ¯”è¾ƒéº»çƒ¦éœ€è¦å„ç§ä¾èµ–ç¯å¢ƒï¼Œ
å½“æ—¶ä¹Ÿè€ƒè™‘è¿‡ Go ä½†ç”±äºåœ¨æ–­æ–­ç»­ç»­å­¦ä¹ æ²¡æœ‰æŒç»­ï¼Œè¿™ä¸ªæ—¶å€™å°±å¼€å§‹å°†æ³¨æ„åŠ›è½¬ç§»åˆ°äº†ç±» Ruby è¯­æ³•çš„ Crystal è¯­è¨€ï¼Œé€šè¿‡ä¸šä½™æ—¶é—´æ…¢æ…¢çš„äº†è§£å’Œç¡®å®šå…¶æ€§èƒ½åè™½ç„¶å’Œ
 Go æ¥æ¯”æ‰“åŒ…è¿˜æ²¡æœ‰é‚£ä¹ˆé«˜çš„é›†æˆåº¦ä½†å®Œæˆæ ¸å¿ƒåŠŸèƒ½å·²ç»å®Œå…¨è¶³å¤Ÿï¼Œä¹Ÿå°±å¼€å§‹äº†å°è£… &lt;a href=&#34;https://github.com/icyleaf/gitlab.cr&#34;&gt;gitlab&lt;/a&gt;ã€
&lt;a href=&#34;https://github.com/icyleaf/halite&#34;&gt;halite&lt;/a&gt; ç½‘ç»œåº“ç›´åˆ°æœ€è¿‘åŸºæœ¬å®Œæˆäº†æ ¸å¿ƒåŠŸèƒ½ã€‚&lt;/p&gt;

&lt;p&gt;&lt;code&gt;á¸«pr&lt;/code&gt; å°±è¿™æ ·è¯ç”Ÿäº†ã€‚é¡¹ç›®åå’Œ Logo å‡ºå¤„æ¥æºäº&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E8%81%96%E7%94%B2%E8%9F%B2&#34;&gt;åœ£ç”²è™«&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;h2 id=&#34;å¿«é€Ÿä¸Šæ‰‹&#34;&gt;å¿«é€Ÿä¸Šæ‰‹&lt;/h2&gt;

&lt;p&gt;é‰´äº Docker çš„ä¾¿åˆ©æ€§ï¼Œç›®å‰æ•™ç¨‹åªæä¾›æ­¤ç§æ–¹æ³•è¿›è¡Œå®‰è£…éƒ¨ç½²ï¼Œé¦–å…ˆå…‹éš†æœ¬é¡¹ç›®ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ git clone https://github.com/icyleaf/hpr.git
$ cd hpr
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¤åˆ¶ &lt;a href=&#34;config/hpr.json.example&#34;&gt;config/hpr.json.example&lt;/a&gt; å¹¶æ”¹å &lt;code&gt;config/config.json&lt;/code&gt; åå¯ä¿®æ”¹&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-json&#34;&gt;{
  &amp;quot;schedule_in&amp;quot;: &amp;quot;1.day&amp;quot;,
  &amp;quot;basic_auth&amp;quot;: {
    &amp;quot;enable&amp;quot;: false,
    &amp;quot;user&amp;quot;: &amp;quot;hpr&amp;quot;,
    &amp;quot;password&amp;quot;: &amp;quot;p@ssw0rd&amp;quot;
  },
  &amp;quot;gitlab&amp;quot;: {
    &amp;quot;ssh_port&amp;quot;: 22,
    &amp;quot;endpoint&amp;quot;: &amp;quot;http://gitlab.example.com/api/v3&amp;quot;,
    &amp;quot;private_token&amp;quot;: &amp;quot;abc&amp;quot;,

    &amp;quot;group_name&amp;quot;: &amp;quot;mirrors&amp;quot;,

    &amp;quot;project_public&amp;quot;: false,
    &amp;quot;project_issue&amp;quot;: false,
    &amp;quot;project_wiki&amp;quot;: false,
    &amp;quot;project_merge_request&amp;quot;: false,
    &amp;quot;project_snippet&amp;quot;: false
  }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ ¸å¿ƒéœ€è¦ä¿®æ”¹çš„å‚æ•°æœ‰å¦‚ä¸‹å››é¡¹ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;endpoint&lt;/code&gt;: Gitlab API çš„åœ°å€ï¼Œ&lt;strong&gt;æ— éœ€ä¿®æ”¹åé¢éƒ¨åˆ†&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;private_token&lt;/code&gt;: åœ¨ä¸ªäººè®¾ç½®çš„ Account é¡µé¢è·å¾—&lt;/li&gt;
&lt;li&gt;&lt;code&gt;group_name&lt;/code&gt;: é¡¹ç›®é•œåƒçš„é¡¹ç›®éƒ½ä¼šå½’å±åˆ°è¿™ä¸ªç»„å†…ï¼Œ&lt;strong&gt;åŠ¡å¿…ç¡®ä¿ä½ çš„è´¦æˆ·æ‹¥æœ‰åˆ›å»ºç»„çš„æƒé™&lt;/strong&gt; (å¦‚æœæ˜¯ç®¡ç†å‘˜è¯·å¿½ç•¥åŠ ç²—å­—æ ·)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ssh_port&lt;/code&gt;: å¦‚æœ SSH ä¸æ˜¯ 22 ç«¯å£çš„è¯éœ€è¦æ ¹æ®ä½ çš„å®é™…æƒ…å†µä¿®æ”¹&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;é…ç½®æ–‡ä»¶ä¿®æ”¹ä¿å­˜åè¿˜éœ€è¦åœ¨ &lt;code&gt;docker-compose.yml&lt;/code&gt; æ–‡ä»¶ä¸­é…ç½®ä¸‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;version: &#39;2&#39;

services:
  hpr:
    image: icyleafcn/hpr
    ports:
      - 8848:8848
    volumes:
      - ./config:/app/config
      - ./repositories:/app/repositories
    environment:
      REDIS_URL: tcp://redis:6379
      REDIS_PROVIDER: REDIS_URL

      HPR_SSH_HOST: git.example.com
      HPR_SSH_PORT: 22
    depends_on:
      - redis
  redis:
    image: redis:alpine
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å…¶ä¸­ &lt;code&gt;HPR_SSH_HOST&lt;/code&gt; å’Œ &lt;code&gt;HPR_SSH_PORT&lt;/code&gt; å˜é‡ç”¨äºè®¾ç½® Docker å®ä¾‹ä¸­çš„ SSH é…ç½®ã€‚å¦‚æœ SSH ç«¯å£æ˜¯ 22 çš„å¯å¿½ç•¥è®¾ç½®è¿™ä¿©å‚æ•°ã€‚&lt;/p&gt;

&lt;p&gt;ç¼–è¾‘å®Œæˆåè¿è¡Œä¸‹é¢å‘½ä»¤å¿«å®Œæˆäº†ï¼&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ docker-compose up
...
hpr_1      | Generating public/private rsa key pair ...
hpr_1      |
hpr_1      | GENERATED SSH PUBLIC KEY:
hpr_1      | ##################################################################
hpr_1      | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDq8O3HbLn9x8Uy8RUotlpOnxdakrmCyDpZrGBeLARmEbd6BOIBQ+UWm8NUKthQ7UOavmlsq4j8lY4kyFW2eFX2qWcbvI+s2gI+05MXax+mAukSszaNSnpAoTyJCRipilSkqiOV99V8JIJhrHPtTO0o/Ui
9WiyyWsUM4M9lEKHpZ486lDGk3IM2XQW+pxAoMKb0TYzqCsrduHUtjzy0M0BqgMPe9EtVQqCbnTMzDLXmRONoTYyTV51NQ12mMwEQcDaLQ28e5gqouQJKS81JaoRpQWa7pHsOCki6Fk9TB+EQFrGz5nOrmYYM+O1MKnFkzmVHv7Fh50Sz7d2nYzzOKAkR hpr@docker
hpr_1      | ##################################################################
hpr_1      |
hpr_1      | Configuring ssh config ...
hpr_1      | Starting hpr server ...
hpr_1      |   _
hpr_1      |  | |__  _ __  _ __
hpr_1      |  | &#39;_ \| &#39;_ \| &#39;__|
hpr_1      |  | | | | |_) | |
hpr_1      |  |_| |_| .__/|_|
hpr_1      |        |_|
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æœ€åä»æ‰§è¡Œå‘½ä»¤çš„è¾“å‡ºæ‰¾åˆ°ç”Ÿæˆçš„ SSH PUBLIC KEYï¼ˆä¸¤ä¸ªäº•å·ä¸­é—´çš„éƒ¨åˆ†ï¼Œä»¥ &lt;code&gt;ssh-rsa&lt;/code&gt; å¼€å¤´ï¼Œ&lt;code&gt;hpr@docker&lt;/code&gt; ç»“å°¾ï¼‰ï¼Œ
å¤åˆ¶æ·»åŠ åˆ° gitlab çš„è´¦æˆ· SSH Keys é¡µé¢ä¸­ã€‚&lt;/p&gt;

&lt;h2 id=&#34;æ›´å¤šèµ„æº&#34;&gt;æ›´å¤šèµ„æº&lt;/h2&gt;

&lt;p&gt;å†å¤šçš„å†…å®¹æˆ‘å·²ç»æ•´ç†åˆ°æ–‡æ¡£ä¸­ï¼Œæ¬¢è¿ç§»æ­¥æµè§ˆï¼š&lt;a href=&#34;https://icyleaf.github.io/hpr/&#34;&gt;https://icyleaf.github.io/hpr/&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>å¦‚ä½•ä½¿ç”¨ Docker ç®¡ç† Jenkins</title>
      <link>https://icyleaf.com/2018/04/how-to-manage-jenkins-with-docker</link>
      <pubDate>Wed, 18 Apr 2018 14:44:32 +0800</pubDate>
      
      <guid>https://icyleaf.com/2018/04/how-to-manage-jenkins-with-docker</guid>
      <description>

&lt;p&gt;å®˜æ–¹çš„ &lt;a href=&#34;https://hub.docker.com/_/jenkins&#34;&gt;jenkins&lt;/a&gt; é•œåƒå·²ç»ä¸å†ç»´æŠ¤ç®¡ç†è€Œæ˜¯ç”± Jenkins Community è¿›è¡Œæ›´æ–°ï¼Œé‰´äº Jenkins çš„æ›´æ–°é¢‘ç‡ç‰¹åˆ«å¿«ç¤¾åŒºç‰ˆæœ¬ä¼šæä¾›ä¸¤ä¸ªç‰ˆæœ¬ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;lts&lt;/code&gt; é•¿æœŸç¨³å®šç‰ˆæœ¬ï¼Œä½†è¿˜æ˜¯ä¼šæœ‰æ–°ç‰ˆæé†’&lt;/li&gt;
&lt;li&gt;&lt;code&gt;latest&lt;/code&gt; æ¯å‘¨æ›´æ–°ç‰ˆæœ¬&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;éƒ½æ˜¯åŸºäº alpine ç³»ç»Ÿå°è£…å› æ­¤é•œåƒçš„ä½“ç§¯ä¼šå¤§å¤§å‡å°å¾ˆå¤šã€‚å¦‚æœä½ æ˜¯å†…ç½‘ä½¿ç”¨å¯ä»¥ä¸ç”¨åœ¨æ„æ›´æ–°é—®é¢˜é•¿æœŸä½¿ç”¨ä¸€ä¸ªç‰ˆæœ¬ä¹Ÿæ²¡å¤ªå¤§é—®é¢˜ã€‚&lt;/p&gt;

&lt;h2 id=&#34;å®‰è£…&#34;&gt;å®‰è£…&lt;/h2&gt;

&lt;p&gt;åˆ›å»ºé•œåƒæ—¶éœ€è¦æ³¨æ„å‡ ä¸ªåœ°æ–¹ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;å…³è”æœ¬åœ° volumes&lt;/li&gt;
&lt;li&gt;è®¾ç½®æ—¶åŒºï¼ˆé»˜è®¤æ˜¯ UTC æ—¶é—´ï¼‰&lt;/li&gt;
&lt;li&gt;æ˜ å°„ 50000 ç«¯å£ï¼ˆè¿™ä¸ªæ˜¯ master å’Œ slave çš„é€šè®¯ç«¯å£ï¼‰å’Œ 8000 ç«¯å£ï¼ˆWebï¼‰&lt;/li&gt;
&lt;/ol&gt;

&lt;pre&gt;&lt;code&gt;docker run -d --restart=always
    -p 8000:8080 -p 50000:50000
    -v /var/lib/docker/jenkins:/var/jenkins_home
    -e JAVA_OPTS=-Duser.timezone=Asia/Shanghai
    jenkins/jenkins:lts
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¯¹äºè¿›è¡Œè®¾ç½® JAVA çš„å‚æ•°å¯ä»¥å‚è€ƒï¼š&lt;a href=&#34;https://github.com/jenkinsci/docker/issues/45&#34;&gt;https://github.com/jenkinsci/docker/issues/45&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&#34;é…ç½®-jenkins-çš„æ’ä»¶æº&#34;&gt;é…ç½® Jenkins çš„æ’ä»¶æº&lt;/h2&gt;

&lt;p&gt;ä½¿ç”¨è¿‡å®ƒçš„äººéƒ½çŸ¥é“ç®¡ç†å’Œå®‰è£…æ’ä»¶æ˜¯ä¸€ä¸ªå¥‡æ…¢æ— æ¯”çš„äº‹æƒ…ï¼Œè™½ç„¶æä¾›äº†ä»£ç†æœåŠ¡å™¨ä½†æˆ‘è¿™è¿˜æœ‰ä¸€ä¸ªæ›´å¥½çš„æ–¹æ¡ˆã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘åœ¨ç¿»é˜…å›½å†…é•œåƒæºç½‘ç«™çš„æ—¶å€™å‘ç°æ¸…åå¤§å­¦å¼€æºè½¯ä»¶é•œåƒç«™å…¶å®æä¾›äº†å›½å†… Jenkins æ’ä»¶çš„é•œåƒæºä½†ä¸€ç›´å¾ˆä½è°ƒçš„æ²¡æœ‰å…¬å¸ƒï¼Œé€šè¿‡è¿›å…¥&lt;code&gt;ç®¡ç†æ’ä»¶ -&amp;gt; é«˜çº§&lt;/code&gt;é¡µé¢æ‹‰åˆ°æœ€åº•éƒ¨æœ‰ä¸ªå‡çº§ç«™ç‚¹çš„è‡ªå®šä¹‰æ¡†ï¼Œå¡«å…¥&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å®‰è£…æ’ä»¶çš„æ—¶å€™ç³»ç»Ÿé»˜è®¤ä¼šæµ‹è¯•ç½‘ç»œå°±æ˜¯ ping ä¸‹ Google çš„ç½‘ç«™ï¼Œå®ƒä¼šæç¤ºå¤±è´¥ä½†ä¸ç”¨æ‹…å¿ƒå®ƒä¼šç»§ç»­å°è¯•ä¸‹è½½å’Œå®‰è£…æ’ä»¶ã€‚&lt;/p&gt;

&lt;h2 id=&#34;å‡çº§&#34;&gt;å‡çº§&lt;/h2&gt;

&lt;p&gt;æ­¤æ–¹æ³•é€‚ç”¨äºæ‰€æœ‰çš„å®¹å™¨çš„å‡çº§æ­¥éª¤ã€‚&lt;/p&gt;

&lt;p&gt;é¦–å…ˆéœ€è¦æ‰¾åˆ°å®¹å™¨çš„åå­—ï¼Œè¿™é‡Œæˆ‘æƒ³ä¼šæœ‰ä¸å°‘äººä¼šé—®ä¸ºä»€ä¹ˆä½ åœ¨åˆ›å»ºä¸€ä¸ªå®¹å™¨çš„æ—¶å€™ä¸æŒ‡å®šä¸€ä¸ªåå­—ï¼Œ
é‚£æ˜¯å› ä¸ºåé¢è¿˜éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°ç‰ˆæœ¬çš„å®¹å™¨è€Œåå­—ä¸èƒ½ä¸€æ ·ï¼Œå› æ­¤æˆ‘ç°åœ¨åˆ›å»ºéƒ½è®© docker éšæœºåˆ†é…ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ docker ps
CONTAINER ID  ...   NAMES
8f48718fdd07  ...   naughty_pasteur
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ‹¿åˆ°ä¹‹åå…ˆåœæ­¢è¿è¡Œåï¼Œåˆ›å»ºä¸€ä¸ªæ•°æ®å¤‡ä»½å®¹å™¨å†è¿›è¡Œæ‹‰å–æœ€æ–°ç‰ˆæœ¬&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ docker stop naughty_pasteur
$ docker docker create --volumes-from naughty_pasteur --name jenkins-data jenkins/jenkins:lts
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ‹‰å–æœ€æ–°ç‰ˆæœ¬åæ¢å¤æ•°æ®ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ docker pull jenkins/jenkins:lts
$ docker run -d --restart=always
    --volumes-from jenkins-data
    -p 8000:8080 -p 50000:50000
    -v /var/lib/docker/jenkins:/var/jenkins_home
    -e JAVA_OPTS=-Duser.timezone=Asia/Shanghai
    jenkins/jenkins:lts
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç¡®ä¿é€šè¿‡ web è®¿é—®å’Œ build æ­£å¸¸ååˆ é™¤è€çš„å’Œæ•°æ®å¤‡ä»½çš„å®¹å™¨&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ docker rm naughty_pasteur
$ docker rm jenkins-data
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;ç–‘æƒ‘è§£ç­”&#34;&gt;ç–‘æƒ‘è§£ç­”&lt;/h2&gt;

&lt;h3 id=&#34;1-æˆ‘å¿˜è®°è®¾ç½®æ—¶åŒºä½†æˆ‘è¿›å®ä¾‹ä¿®æ”¹äº†æ—¶åŒºåœ¨-jenkins-é‡Œä¸ç”Ÿæ•ˆ&#34;&gt;1. æˆ‘å¿˜è®°è®¾ç½®æ—¶åŒºä½†æˆ‘è¿›å®ä¾‹ä¿®æ”¹äº†æ—¶åŒºåœ¨ Jenkins é‡Œä¸ç”Ÿæ•ˆ&lt;/h3&gt;

&lt;p&gt;åœ¨ Jenkins çš„ç³»ç»Ÿè®¾ç½®é¡µé¢æ‰¾åˆ°è„šæœ¬å‘½ä»¤è¡Œè¿è¡Œï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;System.setProperty(&#39;org.apache.commons.jelly.tags.fmt.timeZone&#39;, &#39;Asia/Shanghai&#39;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ‰§è¡Œåå³æ—¶ç”Ÿæ•ˆæ— éœ€é‡å¯ï¼Œæ–¹æ³•æ¥è‡ª&lt;a href=&#34;https://wiki.jenkins.io/display/JENKINS/Change+time+zone&#34;&gt;å®˜æ–¹æ–‡æ¡£&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&#34;å®˜æ–¹æ–‡æ¡£&#34;&gt;å®˜æ–¹æ–‡æ¡£&lt;/h2&gt;

&lt;p&gt;&lt;a href=&#34;https://github.com/jenkinsci/docker/blob/master/README.md&#34;&gt;https://github.com/jenkinsci/docker/blob/master/README.md&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Docker æ‘¸çˆ¬æ»šæ‰“å¯¹æŠ— CentOS 6</title>
      <link>https://icyleaf.com/2016/12/docker-with-centos</link>
      <pubDate>Fri, 30 Dec 2016 17:52:30 +0800</pubDate>
      
      <guid>https://icyleaf.com/2016/12/docker-with-centos</guid>
      <description>

&lt;blockquote&gt;
&lt;p&gt;2018å¹´10æœˆ18æ—¥æ›´æ–°ï¼š&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;å›½åº†æœŸé—´æ°å·§æœåŠ¡å™¨ç¡¬ç›˜æ•…éšœä¸”è¿ç»´å¹¶æ²¡æœ‰åš raid å¤‡ä»½ï¼Œç»™æ›´æ¢äº†ä¸€å°æ–°å†…éƒ¨æœåŠ¡å™¨ï¼Œç´¢æ€§å‡çº§åˆ°äº† CentOS 7ï¼Œå› æ­¤é’ˆå¯¹ CentOS 6 å®‰è£… Docker çš„ç­”ç–‘ä¸å†æ›´æ–°ã€‚&lt;/p&gt;

&lt;h2 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h2&gt;

&lt;p&gt;å‰ä¸ä¹…ç»ˆäºæŠŠæˆ‘ä»¬ç§»åŠ¨å›¢é˜Ÿå†…éƒ¨æœåŠ¡å™¨ä» CentOS 5.x å‡çº§åˆ°äº† 6.8ã€‚æœ¬æ¥æ˜¯æ‹œæ‰˜è®©å‡çº§è‡³ 7.0 ç‰ˆæœ¬èµ·ç èƒ½ç”¨ä¸Š docker 1.12 ç‰ˆæœ¬è¿˜æ˜¯é è°±çš„äº‹æƒ…ã€‚
äº‹æƒ…å¾€å¾€éš¾ä»¥é¢„æ–™çš„è¢«å‘ŠçŸ¥å…¶ä»–å›¢é˜Ÿåœ¨å®‰è£… 7.0 ä¹‹åé€ æˆå†…éƒ¨æœåŠ¡å™¨ç¾¤çš„ç½‘å¡å¤±çµçš„è¯¡å¼‚æ•…éšœåªèƒ½ä½œç½¢ï¼Œæƒ³æƒ³èµ·ç è¿˜æœ‰ä¸ªæ—©æœŸ docker ç‰ˆæœ¬å¯å®‰è£…ä¹Ÿå°±å…ˆè¿™ä¹ˆç€å§ã€‚&lt;/p&gt;

&lt;p&gt;è¿™ä¸ªæ˜¯åœ¨ &lt;a href=&#34;http://icyleaf.com/2013/09/how-to-install-gitlab-on-centos/&#34;&gt;å¦‚ä½•åœ¨CentOS ä¸Šå®‰è£…Gitlab&lt;/a&gt; ä¹‹åæœ‰ä¸€ä¸ªæ— å¥ˆçš„ä½¿ç”¨æŒ‡å—ï¼Œ
å› ä¸ºè¿ç»´ä¹Ÿæœ‰ä»–çš„è€ƒè™‘æ–¹é¢ï¼Œå‚è§çŸ¥ä¹è®¨è®ºï¼š&lt;a href=&#34;https://www.zhihu.com/question/29191794&#34;&gt;å¦‚ä½•è¯´æœè¿ç»´é€‰æ‹© Debian/Ubuntu è€Œä¸æ˜¯ CentOS&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&#34;å®‰è£…-docker&#34;&gt;å®‰è£… Docker&lt;/h2&gt;

&lt;h3 id=&#34;1-7-1&#34;&gt;1.7.1&lt;/h3&gt;

&lt;p&gt;Docker æœ€åä¸€ä¸ªæ”¯æŒ CentOS 6 çš„ç‰ˆæœ¬æ˜¯ 1.7.1 è¿˜å¿…é¡»å®‰è£… epel æºä¹‹åå°±&lt;a href=&#34;https://github.com/docker/docker/issues/14365&#34;&gt;è¢«å¤§å®¶æ¬¢å¤©å–œåœ°çš„æŠ›å¼ƒäº† 6 çš„æ”¯æŒ&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;sudo rpm -ivh http://download.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm
sudo yum -y remove docker
sudo yum install libselinux-python docker-io
&lt;/code&gt;&lt;/pre&gt;

&lt;blockquote&gt;
&lt;p&gt;ç”±äº yum å†… docker å·²ç»è¢«å…¶ä»–ä½¿ç”¨ï¼Œä¸ç”¨å®‰è£…é”™è¯¯äº†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;1-7-1-ä»¥ä¸Šç‰ˆæœ¬&#34;&gt;1.7.1 ä»¥ä¸Šç‰ˆæœ¬&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;è¯·æœæ–­æ”¾å¼ƒè¿™ç§æƒ³æ³•&lt;/strong&gt;ï¼Œè™½ç„¶ä½ å¯èƒ½åœ¨ç½‘ä¸Šæœç´¢æœ‰ä¸ªåˆ«çš„æ–‡ç« è¯´æŠŠå†…æ ¸å‡çº§åˆ° 3.10 åå¯ä»¥å®‰è£… docker 1.9 ç‰ˆæœ¬ï¼Œç»è¿‡æˆ‘ä¸ªäººåå¤æµ‹è¯•æ ¹æœ¬ä¸å¯è¡Œï¼&lt;/p&gt;

&lt;p&gt;å½“ç„¶å¦‚æœä½ è¿˜æ˜¯åšæŒæƒ³å°è¯•ï¼Œè¯·å‚è€ƒå¦‚ä¸‹é“¾æ¥ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://www.pangxie.space/docker/364&#34;&gt;http://www.pangxie.space/docker/364&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.cnblogs.com/dongdongwq/p/5381752.html&#34;&gt;http://www.cnblogs.com/dongdongwq/p/5381752.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://0evin.com/2016/06/17/%5B%E5%8E%9F%E5%88%9B%5DCentOS6.5%E5%AE%89%E8%A3%85Docker1.11.X%E7%89%88%E6%9C%AC/&#34;&gt;http://0evin.com/2016/06/17/%5B%E5%8E%9F%E5%88%9B%5DCentOS6.5%E5%AE%89%E8%A3%85Docker1.11.X%E7%89%88%E6%9C%AC/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;é…ç½®-docker&#34;&gt;é…ç½® Docker&lt;/h2&gt;

&lt;p&gt;å®‰è£…æˆåŠŸåå…ˆä¸è¦é…ç½®å¼€æœºè‡ªå¯åŠ¨å’Œå¯åŠ¨æœåŠ¡ï¼Œdocker çš„å®˜æ–¹é•œåƒåœ¨å›½å†…ä¼—æ‰€å‘¨çŸ¥çš„æ…¢çš„ä¸€å¡Œç³Šæ¶‚ï¼Œå¦‚æœä½ æ˜¯åœ¨å›½å†…æœåŠ¡å™¨ä½¿ç”¨è¯·å‚è€ƒå¦‚ä¸‹é…ç½®ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘è¿™é‡ŒæŠŠæˆ‘ä¸ªäººç§è—å·²ä¹…çš„å¥½ç”¨çš„é•œåƒå‘Šè¯‰å¤§å®¶ï¼Œå¤§å®¶å¯ä¸è¦ä»¥ä¸ºæˆ‘ç”¨çš„æ˜¯é˜¿é‡Œäº‘æˆ–è€… DaoCloud è¿™ç±»æœ‰å¾ˆå¤šé™åˆ¶çš„ç©æ„ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;ä¸­å›½ç§‘æŠ€å¤§å­¦é•œåƒï¼š&lt;a href=&#34;https://docker.mirrors.ustc.edu.cn&#34;&gt;https://docker.mirrors.ustc.edu.cn&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ç½‘æ˜“èœ‚å·¢é•œåƒï¼š&lt;a href=&#34;http://hub-mirror.c.163.com&#34;&gt;http://hub-mirror.c.163.com&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;åŒæ ·éœ€è¦æ³¨æ„çš„æ˜¯ 1.7.1 ç‰ˆæœ¬çš„ docker é…ç½®æ–‡ä»¶æ˜¯åœ¨ &lt;code&gt;/etc/sysconfig/docker&lt;/code&gt; è€Œä¸æ˜¯ç½‘ä¸Šå’Œå®˜æ–¹è¯´çš„ &lt;code&gt;/etc/default/docker&lt;/code&gt; æ‰“å¼€æ­¤æ–‡ä»¶åœ¨ other_args é…ç½®å¯¹äºçš„æºå³å¯ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# /etc/sysconfig/docker
#
# Other arguments to pass to the docker daemon process
# These will be parsed by the sysv initscript and appended
# to the arguments list passed to docker -d

#other_args=
#other_args=&amp;quot;--registry-mirror=http://hub-mirror.c.163.com&amp;quot;
other_args=&amp;quot;--registry-mirror=https://docker.mirrors.ustc.edu.cn&amp;quot;

DOCKER_CERT_PATH=/etc/docker

# Resolves: rhbz#1176302 (docker issue #407)
DOCKER_NOWARN_KERNEL_VERSION=1

# Location used for temporary files, such as those created by
# # docker load and build operations. Default is /var/lib/docker/tmp
# # Can be overriden by setting the following environment variable.
# # DOCKER_TMPDIR=/var/tmp
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åé¢å°±æ²¡ä»€ä¹ˆå¥½è¯´çš„äº†ï¼Œå¯åŠ¨æœåŠ¡å’Œè®¾ç½®å¼€æœºè‡ªå¯åŠ¨å°±å®Œäº‹äº†&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo chkconfig docker on
sudo service docker start
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;éªŒè¯ä¸‹å¯åŠ¨çš„æœåŠ¡æ˜¯å¦å·²ç»é…ç½®äº†å›½å†…é•œåƒæº&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ ps aux | grep &amp;quot;docker -d&amp;quot;

root     16992  0.1  0.1 1239860 32276 ?       Sl   Dec29   2:02 /usr/bin/docker -d --registry-mirror=https://docker.mirrors.ustc.edu.cn
root     26873  0.0  0.0 103332   876 pts/2    S+   18:16   0:00 grep docker -d
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;ç–‘éš¾æ‚ç—‡&#34;&gt;ç–‘éš¾æ‚ç—‡&lt;/h2&gt;

&lt;h4 id=&#34;1-ä½¿ç”¨å›½å†…é•œåƒæº-pull-é•œåƒå¶å°”ä¼šå¤±è´¥-åå¤å‡ æ¬¡å°±å¯ä»¥è§£å†³&#34;&gt;1. ä½¿ç”¨å›½å†…é•œåƒæº pull é•œåƒå¶å°”ä¼šå¤±è´¥ï¼Œåå¤å‡ æ¬¡å°±å¯ä»¥è§£å†³&lt;/h4&gt;

&lt;p&gt;é¢‘æ¬¡ä¸é«˜åŸå› æœªçŸ¥ï¼Œå› æ­¤è¿˜æœªé‡è§†ã€‚&lt;/p&gt;

&lt;h4 id=&#34;2-docker-web-ç®¡ç†å·¥å…·&#34;&gt;2. Docker Web ç®¡ç†å·¥å…·&lt;/h4&gt;

&lt;blockquote&gt;
&lt;p&gt;2018å¹´10æœˆæ›´æ–°ï¼š&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;æ¨èä½¿ç”¨ &lt;a href=&#34;https://github.com/portainer/portainer&#34;&gt;portainer&lt;/a&gt; ï¼Œå…¼å®¹ 1.7 çš„éƒ¨åˆ†åŠŸèƒ½å¯èƒ½ä¼šå‘ç”Ÿéƒ¨åˆ†åŠŸèƒ½å’Œå‚æ•°æ— æ³•æ˜¾ç¤ºä½†ä¸å½±å“ä½¿ç”¨ã€‚ä¹‹å‰æˆ‘æœ‰æ¨è rancherï¼ˆå¯å‚è€ƒå‰ç¯‡æ–‡ç« ï¼š&lt;a href=&#34;http://icyleaf.com/2016/08/how-to-install-rancher-on-osx/&#34;&gt;å¦‚ä½•åœ¨ OS X ä¸Šå®‰è£… Rancher
&lt;/a&gt;ï¼‰ï¼Œä½† rancher å®˜æ–¹è¦æ±‚ docker æœ€ä½ç‰ˆæœ¬æ˜¯ 1.9+ã€‚&lt;/p&gt;

&lt;h4 id=&#34;3-docker-è¿›ç¨‹æŒ‚äº†é‡å¯åæ— æ³•æ¢å¤ä¹‹å‰çš„-containers&#34;&gt;3. Docker è¿›ç¨‹æŒ‚äº†é‡å¯åæ— æ³•æ¢å¤ä¹‹å‰çš„ containers&lt;/h4&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ docker start c39206003c7a
Error: Cannot start container c39206003c7a: Error getting container c39206003c7ae8992a554a9ac2ea130327fc4af1b2c389656c34baf9a56c84b5 from driver devicemapper: Error mounting &#39;/dev/mapper/docker-253:0-267081-c39206003c7ae8992a554a9ac2ea130327fc4af1b2c389656c34baf9a56c84b5&#39; on &#39;/var/lib/docker/devicemapper/mnt/c39206003c7ae8992a554a9ac2ea130327fc4af1b2c389656c34baf9a56c84b5&#39;: device or resource busy
2014/05/08 19:14:57 Error: failed to start one or more containers
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™ç§ä¸€èˆ¬æ˜¯å› ä¸ºæ„å¤–ç»ˆæ­¢è¿›ç¨‹é€ æˆä¸Šæ¬¡çš„ volume æ²¡æœ‰æ­£å¸¸ unmountï¼Œåªéœ€æ‰‹åŠ¨æ“ä½œä¸‹å³å¯ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;unmount /var/lib/docker/devicemapper/mnt/d640aea67108b04c6a5ba14645966b092db1f807f3e3f41dca7a1470f76b68fb
&lt;/code&gt;&lt;/pre&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;d640aea67108b04c6a5ba14645966b092db1f807f3e3f41dca7a1470f76b68fb&lt;/code&gt; æ˜¯æ ¹æ®ä¸åŒ container ç”Ÿæˆçš„ï¼Œè¯·æ ¹æ®å®é™…æƒ…å†µå¤åˆ¶å’Œæ‰§è¡Œã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;è¿™ä¸ªçœŸæ²¡åŠæ³•ï¼Œåªèƒ½åœ¨ Dockerfile æˆ–è€…è¿›å®ä¾‹é‡Œé¢è¿›è¡Œä¿®æ”¹æ—¶åŒºï¼Œè¿™ä¸ªæˆ‘å°±ä¸è¿‡å¤šèµ˜è¿°äº†ã€‚&lt;/p&gt;

&lt;h4 id=&#34;4-å‡çº§è¿è¡Œçš„-container-ç‰ˆæœ¬&#34;&gt;4. å‡çº§è¿è¡Œçš„ container ç‰ˆæœ¬&lt;/h4&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ docker stop xxxx
$ docker create --volumes-from &amp;lt;container_name_of_original_server&amp;gt; \ --name xxx-data image/name:&amp;lt;tag_of_previous_rancher_server&amp;gt;
$ docker pull image/name:latest
$ docker run -d --volumes-from xxx-data --restart=unless-stopped \ -p 8080:8080 image/namel.:latest
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;5-é-root-ç”¨æˆ·æ‰§è¡Œ-docker&#34;&gt;5. é root ç”¨æˆ·æ‰§è¡Œ docker&lt;/h4&gt;

&lt;p&gt;åˆ›å»º docker ç”¨æˆ·ç»„å¹¶é‡å¯ docker æœåŠ¡ï¼Œä¹‹åæŠŠä½ æƒ³è¦çš„ç”¨æˆ·åŠ åˆ° docker ç”¨æˆ·ç»„å³å¯ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ groupadd docker
$ service docker restart
$ usermod -a -G docker icyleaf
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;6-å®¿ä¸»æœº-cst-æ—¶é—´ä¼šé€ æˆ-docker-å®ä¾‹æ—¶é—´ä¸å‡†&#34;&gt;6. å®¿ä¸»æœº CST æ—¶é—´ä¼šé€ æˆ docker å®ä¾‹æ—¶é—´ä¸å‡†&lt;/h4&gt;

&lt;p&gt;è¿™ä¸ªçœŸæ²¡åŠæ³•ï¼Œåªèƒ½åœ¨ Dockerfile æˆ–è€…è¿›å®ä¾‹é‡Œé¢è¿›è¡Œä¿®æ”¹æ—¶åŒºï¼Œè¿™ä¸ªæˆ‘å°±ä¸è¿‡å¤šèµ˜è¿°äº†ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>å¦‚ä½•åœ¨ OS X ä¸Šå®‰è£… Rancher</title>
      <link>https://icyleaf.com/2016/08/how-to-install-rancher-on-osx</link>
      <pubDate>Fri, 05 Aug 2016 17:21:08 +0800</pubDate>
      
      <guid>https://icyleaf.com/2016/08/how-to-install-rancher-on-osx</guid>
      <description>

&lt;p&gt;Rancher æ˜¯ Docker ç¼–æ’è§£å†³æ–¹æ¡ˆçš„ä¸€ç§ï¼Œå¥½å¤„åœ¨äºå¯ä»¥åšå®¹å™¨ç¼–æ’ï¼Œç½‘ç»œï¼Œå­˜å‚¨ï¼Œè´Ÿè½½å‡è¡¡ï¼Œè¿˜èƒ½å¤Ÿæ”¯æŒäº‘æœåŠ¡å™¨ï¼ˆæ¯”å¦‚ Amazon EC2/Azure/DigitalOceanï¼‰ä¹Ÿèƒ½å¤Ÿå…¼å®¹ Docker Swarm/Mesos/Kubernetes ç­‰å…¶ä»–çš„è§£å†³æ–¹æ¡ˆã€‚è‡ªå®ƒè¿˜æ²¡æœ‰å‘å¸ƒ &lt;a href=&#34;http://rancher.com/announcing-rancher-1-0-ga/&#34;&gt;1.0&lt;/a&gt; ç‰ˆæœ¬ä¹‹å‰ä¹Ÿæœ‰æŒç»­çš„å…³æ³¨ã€‚å®ƒè‡ªèº«è¿˜æœ‰ä¸ª &lt;a href=&#34;http://www.infoq.com/cn/news/2015/03/rancheros-docker-linux&#34;&gt;RancherOS&lt;/a&gt; å¯¹äº CoreOS ä¹Ÿæ˜¯ä¸€ä¸ªä¸å°çš„å¨èƒã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://docs.rancher.com/img/rancher/rancher_overview_2.png&#34; alt=&#34;rancher-intro&#34; /&gt;&lt;/p&gt;

&lt;p&gt;ç”±äºå®ƒæä¾›éå¸¸ä¼˜åŒ–çš„åå°ç®¡ç†ç•Œé¢ï¼ŒåŒæ—¶ä¹Ÿæä¾› REST APIï¼Œæ—¥å¸¸å¼€å‘ä½¿ç”¨ä¸­å¼‚å¸¸çš„æ–¹ä¾¿ã€‚å¦‚æœéè¦è¯´å‡ºä¸€ç‚¹ä¸å¥½çš„ï¼Œé‚£å¯èƒ½å°±æ˜¯å®ƒå¯¹å†…å­˜æœ‰ç‚¹å°è¦æ±‚ï¼š&lt;strong&gt;æœ€å° 1GB å†…å­˜&lt;/strong&gt;ï¼Œå› æ­¤å¦‚æœæƒ³æ”¾åœ¨è‡ªå·± VPS ä¸Šçš„ç«¥é‹éœ€è¦è¯„ä¼°ä¸‹äº†ã€‚&lt;/p&gt;

&lt;h2 id=&#34;mac-å®‰è£…&#34;&gt;Mac å®‰è£…&lt;/h2&gt;

&lt;p&gt;è¿™å—ä¹Ÿè¶ç€ &lt;a href=&#34;https://docs.docker.com/docker-for-mac/&#34;&gt;Docker for Mac&lt;/a&gt; çš„å¥½å¤„ï¼Œç»ˆäºæ‘†è„±çš„ &lt;code&gt;docker-machine&lt;/code&gt; çš„æŠ˜ç£¨ï¼Œä¸ç”¨åœ¨ä¾èµ– VirtualBoxï¼Œä¹Ÿä¸åœ¨æ¯æ¬¡è£…è½½ machine çš„å˜é‡å’ŒæŸ¥æ‰¾è™šæ‹Ÿæœºçš„ IPã€‚æ˜ å°„çš„ç«¯å£ç«¯å£éƒ½é€šè¿‡ &lt;code&gt;localhost&lt;/code&gt; è®¿é—®ã€‚&lt;/p&gt;

&lt;p&gt;Rancher é€šè¿‡ Docker æ¥å®‰è£…æœ¬æ¥è¯´æ˜¯éå¸¸ç®€å•çš„ï¼Œå®ƒåˆ†ä¸ºæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ã€‚æœ¬æ•™ç¨‹ä»¥ &lt;a href=&#34;http://docs.rancher.com/rancher/latest/en/installing-rancher/installing-server/&#34;&gt;Single Node&lt;/a&gt; æ¥è®²è§£ï¼Œä¸è€ƒè™‘ &lt;a href=&#34;http://docs.rancher.com/rancher/latest/en/installing-rancher/installing-server/multi-nodes/&#34;&gt;Multi Node&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;è¿™å—ç½‘ä¸Šä¸€ç›´æ²¡æœ‰å¤ªå¥½çš„è§£å†³æ–¹æ¡ˆï¼Œæˆ‘çœ‹å¾ˆå¤šå›½å¤–ç»™å‡ºçš„&lt;a href=&#34;https://gist.github.com/axnux/09dc375d71398cbbee44ebd23ba35a08&#34;&gt;è§£å†³æ–¹æ¡ˆ&lt;/a&gt;ä¹Ÿæ¯”è¾ƒéº»çƒ¦ï¼Œä¸»è¦æ˜¯ç”±äº Docker for mac ä½¿ç”¨çš„æ˜¯ xhyve ä½œä¸ºè½»é‡åŒ–çš„è™šæ‹ŸåŒ–æ–¹æ¡ˆï¼Œè€Œ rancher å®‰è£… server ç«¯æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œåœ¨æ·»åŠ ä¸»æœºçš„æ—¶å€™éœ€è¦é€šè¿‡ HTTP æ¥è¿æ¥ server ç«¯è€Œå¤±è´¥ã€‚ä¸‹é¢æˆ‘æ¥å¸¦å¤§å®¶ç”¨æœ€ç®€å•çš„æ–¹æ¡ˆæ¥æ‹†è§£ã€‚æ— éœ€ä»»ä½•ç¬¬ä¸‰æ–¹çš„è¾…åŠ©ã€‚&lt;/p&gt;

&lt;h3 id=&#34;æœåŠ¡ç«¯&#34;&gt;æœåŠ¡ç«¯&lt;/h3&gt;

&lt;blockquote&gt;
&lt;p&gt;å¦‚æœç½‘é€Ÿè¿æ¥ docker hub è¿‡æ…¢å¯è€ƒè™‘ä½¿ç”¨ä»£ç†è®¾ç½®æˆ–è€…å›½å†…çš„é•œåƒæœåŠ¡ï¼Œæˆ‘è¿™é‡Œåˆ†äº«ä¸€ä¸ª &lt;code&gt;https://docker.mirrors.ustc.edu.cn&lt;/code&gt;ï¼Œå¯åœ¨ Docker -&amp;gt; Preferences&amp;hellip; -&amp;gt; Advanced -&amp;gt; Registry Mirror æ·»åŠ ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ docker run -d --name rancher-server --restart=always -p 8080:8080 rancher/server
$ docker logs -f rancher-server

time=&amp;quot;2016-08-05T16:48:52Z&amp;quot; level=info msg=&amp;quot;Creating schema machine, roles [service]&amp;quot; id=1ds17
time=&amp;quot;2016-08-05T16:48:53Z&amp;quot; level=info msg=&amp;quot;Creating schema machine, roles [project member owner]&amp;quot; id=1ds18
time=&amp;quot;2016-08-05T16:48:53Z&amp;quot; level=info msg=&amp;quot;Creating schema machine, roles [admin user readAdmin]&amp;quot; id=1ds19
time=&amp;quot;2016-08-05T16:48:53Z&amp;quot; level=info msg=&amp;quot;Creating schema machine, roles [readonly]&amp;quot; id=1ds20
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;çœ‹åˆ°å¦‚ä¸Šç±»ä¼¼çš„æ—¥å¿—è¯´æ˜æœåŠ¡å·²ç»åˆå§‹åŒ–å®Œæ¯•ï¼Œé€šè¿‡æµè§ˆå™¨è®¿é—® &lt;code&gt;http://localhost:8080&lt;/code&gt; å°±å¯ä»¥çœ‹åˆ°åå°ç®¡ç†ç•Œé¢ã€‚&lt;/p&gt;

&lt;h3 id=&#34;å®¢æˆ·ç«¯&#34;&gt;å®¢æˆ·ç«¯&lt;/h3&gt;

&lt;p&gt;å…ˆä¸ç€æ€¥ç»§ç»­é¡µé¢æ“ä½œï¼Œå›åˆ°ç»ˆç«¯ä¸Šæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤è·å– rancher-server å®¹å™¨çš„ IP åœ°å€å¤‡ç”¨&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ docker inspect --format &#39;{{ .NetworkSettings.IPAddress }}&#39; rancher-server
172.17.0.2
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ¥ç€ä¸Šé¢çš„æ­¥éª¤ï¼Œåœ¨æ‰“å¼€é¡µé¢èƒ½çœ‹åˆ° Add Host æŒ‰é’®å¹¶ç‚¹å‡»å¯¹äºå¼¹å‡º â€œHost Registration URLâ€ é€‰æ‹© â€œSomething else:â€ åœ¨åé¢çš„è¾“å…¥æ¡†å¡«å…¥ä¸Šé¢çš„ IP å’Œç«¯å£å· &lt;code&gt;http://172.17.0.2:8080&lt;/code&gt; å¹¶ä¿å­˜ã€‚&lt;/p&gt;

&lt;p&gt;ä¹‹åå°±æ˜¯ç»™ä½ ä¸€ä¸ªå®¢æˆ·ç«¯ï¼ˆéƒ¨ç½²ä¸»æœºï¼‰çš„é€‰é¡¹ï¼Œç”±äºæˆ‘ä»¬åªæ·»åŠ æœ¬æœºä½œä¸ºéƒ¨ç½²ä¸»æœºä½¿ç”¨ï¼Œå› æ­¤è¿™é‡Œé€‰æ‹© Customï¼Œå…¶ä»–ä¸ç”¨ä»»ä½•è®¾ç½®ï¼Œç›´æ¥æ»‘å€’æœ€åº•éƒ¨æ‰¾åˆ°ä¸€ä¸ªæ‰§è¡Œ docker å‘½ä»¤çš„åŒºåŸŸï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://ww2.sinaimg.cn/large/006tNbRwjw1f6jdkffiqhj31ee150k0c.jpg&#34; alt=&#34;add rancher host&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ docker run -d --privileged -v /var/run/docker.sock:/var/run/docker.sock -v /var/lib/rancher:/var/lib/rancher rancher/agent:v1.0.2 http://172.17.0.2:8080/v1/scripts/676576FFEC2212A68391:1470416400000:tfqxfdglHL6Qw8dpLVtbOesYY4
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä½ ä¼šå‘ç°æ‰§è¡Œå¯èƒ½ä¼šæŠ¥é”™ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;docker: Error response from daemon: Mounts denied:
The path /var/lib/rancher
is not shared from OS X and is not known to Docker.
You can configure shared paths from Docker -&amp;gt; Preferences... -&amp;gt; File Sharing.
See https://docs.docker.com/docker-for-mac/osxfs/#namespaces for more info.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç›®å‰æœ‰å¯èƒ½æ˜¯ä¸€ä¸ª Docker çš„ Bugï¼Œå› ä¸º &lt;code&gt;/var/lib/rancher&lt;/code&gt; æ˜¯æŒ‚è½½åˆ°å·²ç»é»˜è®¤æ·»åŠ  &lt;code&gt;/private&lt;/code&gt; æ–‡ä»¶å…±äº«ï¼Œä½†æ˜¯å®ƒè¿˜æ˜¯æŠ¥é”™ï¼Œå¦‚æœä½ åœ¨ Docker è®¾ç½®çš„ File Sharing æ·»åŠ çš„è¯å®ƒä¹Ÿä¸ä¼šè®©ä½ æ·»åŠ ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åšä¸€ç‚¹å°ä¿®æ”¹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ docker run -d --privileged -v /var/run/docker.sock:/var/run/docker.sock -v ${HOME}/docker/rancher/var/lib/rancher:/var/lib/rancher rancher/agent:v1.0.2 http://172.17.0.2:8080/v1/scripts/676576FFEC2212A68391:1470416400000:tfqxfdglHL6Qw8dpLVtbOesYY4
5cf22a10cf28b4182b6e205fa631146e86d67c3c9d86901ff8cf7ab087319a29
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æœ€åç‚¹å‡»é¡µé¢çš„ Close åä¼šè·³è½¬åˆ° Host çš„åˆ—è¡¨ï¼Œä½ å°±èƒ½æƒŠå–œçš„å‘ç°æ·»åŠ æˆåŠŸäº†ï¼&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://ww2.sinaimg.cn/large/006tNbRwjw1f6jdidcojkj315y0m4dik.jpg&#34; alt=&#34;rancher host&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;ç»“å°¾&#34;&gt;ç»“å°¾&lt;/h2&gt;

&lt;p&gt;æœ¬ç¯‡åªå…ˆè§£å†³è¿™ä¸€ä¸ªé—®é¢˜ï¼Œæ›´å¤šä½¿ç”¨çš„èµ„æ–™è¯·çœ‹&lt;a href=&#34;http://rancher.hidocker.io/&#34;&gt;Rancher å®æˆ˜çº¢å®ä¹¦&lt;/a&gt;ã€‚&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>