<!doctype html><html lang=zh dir=auto></html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>å¦‚ä½•è·å– Element çš„ XPath [PHP/Javascript] | icyleaf</title><meta name=keywords content="PHP,Javascript"><meta name=description content="è¿™ä¸¤å¤©ç ”ç©¶ HTML çš„ DOM éœ€è¦å¯»æ‰¾æŸä¸ª Element å…ƒç´ çš„å®Œæ•´ XPath è·¯å¾„ï¼Œç”±äºä½¿ç”¨çš„æ˜¯ PHP Simple HTML DOM Parser å¼€æºåº“ï¼Œè¿™ä¸ªåº“ç±»çš„ä½¿ç”¨æ–¹æ³•å‡ ä¹å…¼å®¹ Javascript çš„ DOM è¯­æ³•å¹¶é™„å¸¦ DOM é€‰æ‹©å™¨ã€‚è™½ç„¶åŠŸèƒ½å¼º"><meta name=author content="icyleaf"><link rel=canonical href=https://icyleaf.com/2010/04/how-to-get-xpath-of-an-element-for-php-and-javascript/><link rel=icon href=https://icyleaf.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://icyleaf.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://icyleaf.com/favicon-32x32.png><link rel=icon type=image/png sizes=192x192 href=https://icyleaf.com/android-chrome-192x192.png><link rel=icon type=image/png sizes=512x512 href=https://icyleaf.com/android-chrome-512x512.png><link rel=apple-touch-icon href=https://icyleaf.com/apple-touch-icon.png><link rel=mask-icon href=https://icyleaf.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=stylesheet href=https://icyleaf.com/css/main.min.css><link rel=stylesheet href=https://icyleaf.com/font/iconfont.min.css><link rel=stylesheet href=https://icyleaf.com/font-ali/iconfont.min.css><link rel=stylesheet href=https://icyleaf.com/photoswipe/photoswipe.min.css><link rel=canonical href=https://icyleaf.com/2010/04/how-to-get-xpath-of-an-element-for-php-and-javascript/><meta property="og:title" content="å¦‚ä½•è·å– Element çš„ XPath [PHP/Javascript]"><meta property="og:description" content="è¿™ä¸¤å¤©ç ”ç©¶ HTML çš„ DOM éœ€è¦å¯»æ‰¾æŸä¸ª Element å…ƒç´ çš„å®Œæ•´ XPath è·¯å¾„ï¼Œç”±äºä½¿ç”¨çš„æ˜¯ PHP Simple HTML DOM Parser å¼€æºåº“ï¼Œè¿™ä¸ªåº“ç±»çš„ä½¿ç”¨æ–¹æ³•å‡ ä¹å…¼å®¹ Javascript çš„ DOM è¯­æ³•å¹¶é™„å¸¦ DOM é€‰æ‹©å™¨ã€‚è™½ç„¶åŠŸèƒ½å¼º"><meta property="og:type" content="article"><meta property="og:url" content="https://icyleaf.com/2010/04/how-to-get-xpath-of-an-element-for-php-and-javascript/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2010-04-02T12:34:56+08:00"><meta property="article:modified_time" content="2010-04-02T12:34:56+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="å¦‚ä½•è·å– Element çš„ XPath [PHP/Javascript]"><meta name=twitter:description content="è¿™ä¸¤å¤©ç ”ç©¶ HTML çš„ DOM éœ€è¦å¯»æ‰¾æŸä¸ª Element å…ƒç´ çš„å®Œæ•´ XPath è·¯å¾„ï¼Œç”±äºä½¿ç”¨çš„æ˜¯ PHP Simple HTML DOM Parser å¼€æºåº“ï¼Œè¿™ä¸ªåº“ç±»çš„ä½¿ç”¨æ–¹æ³•å‡ ä¹å…¼å®¹ Javascript çš„ DOM è¯­æ³•å¹¶é™„å¸¦ DOM é€‰æ‹©å™¨ã€‚è™½ç„¶åŠŸèƒ½å¼º"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://icyleaf.com/posts/"},{"@type":"ListItem","position":2,"name":"å¦‚ä½•è·å– Element çš„ XPath [PHP/Javascript]","item":"https://icyleaf.com/2010/04/how-to-get-xpath-of-an-element-for-php-and-javascript/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"å¦‚ä½•è·å– Element çš„ XPath [PHP/Javascript]","name":"å¦‚ä½•è·å– Element çš„ XPath [PHP\/Javascript]","description":"è¿™ä¸¤å¤©ç ”ç©¶ HTML çš„ DOM éœ€è¦å¯»æ‰¾æŸä¸ª Element å…ƒç´ çš„å®Œæ•´ XPath è·¯å¾„ï¼Œç”±äºä½¿ç”¨çš„æ˜¯ PHP Simple HTML DOM Parser å¼€æºåº“ï¼Œè¿™ä¸ªåº“ç±»çš„ä½¿ç”¨æ–¹æ³•å‡ ä¹å…¼å®¹ Javascript çš„ DOM è¯­æ³•å¹¶é™„å¸¦ DOM é€‰æ‹©å™¨ã€‚è™½ç„¶åŠŸèƒ½å¼º","keywords":["PHP","Javascript"],"articleBody":"è¿™ä¸¤å¤©ç ”ç©¶ HTML çš„ DOM éœ€è¦å¯»æ‰¾æŸä¸ª Element å…ƒç´ çš„å®Œæ•´ XPath è·¯å¾„ï¼Œç”±äºä½¿ç”¨çš„æ˜¯ PHP Simple HTML DOM Parser å¼€æºåº“ï¼Œè¿™ä¸ªåº“ç±»çš„ä½¿ç”¨æ–¹æ³•å‡ ä¹å…¼å®¹ Javascript çš„ DOM è¯­æ³•å¹¶é™„å¸¦ DOM é€‰æ‹©å™¨ã€‚è™½ç„¶åŠŸèƒ½å¼ºå¤§ä½†æ˜¯å¹¶ä¸èƒ½ç›´æ¥è·å– Element çš„ XPathã€‚è¿™ä¸ªæ€ä¹ˆåŠå‘¢ï¼Œä¾ç¨€è®°å¾— Firebug æœ‰ä¸€ä¸ªåŠŸèƒ½ï¼Œé€‰æ‹©æŸä¸ªå…ƒç´ åœ¨å®ƒçš„æ§åˆ¶å°å¯ä»¥æ˜¾ç¤º XPathã€‚å—¯ï¼Œç€æ‰‹å®è·µä¸€ä¸‹å‘ç°ä¸ä»…å¯ä»¥æ˜¾ç¤ºè€Œä¸”è¿˜å¯ä»¥å¤åˆ¶ XPathã€‚\näºæ˜¯æƒ³ï¼Œå¦‚æœå¯ä»¥æ‰¾åˆ° Javascript ç‰ˆçš„ç›¸å…³ä»£ç å°±ä¸€å®šå¯ä»¥æ”¹æˆ PHP ç‰ˆæœ¬çš„ï¼Œç»“æœåœ¨ Google æœç´¢æ‰¾åˆ°äº†â€¦\n1var elt = document.getElementById('table'); 2var xpath = getElementXPath(elt);alert(xpath); 3 4// Get full XPath of an element 5function getElementXPath(elt){ 6\tvar path = \"\"; 7\tfor (; elt \u0026\u0026 elt.nodeType == 1; elt = elt.parentNode) 8\t{ 9\tidx = getElementIdx(elt); 10\txname = elt.tagName; 11\tif (idx \u003e 1) xname += \"[\" + idx + \"]\"; 12\tpath = \"/\" + xname + path; 13\t} 14\treturn path; 15} 16 17// Get Idx of an element 18function getElementIdx(elt){ 19\tvar count = 1; 20\tfor (var sib = elt.previousSibling; sib ; sib = sib.previousSibling) 21\t{ 22\tif(sib.nodeType == 1 \u0026\u0026 sib.tagName == elt.tagName) count++ 23\t} 24\treturn count; 25} PHP æ”¹è¿›ç‰ˆï¼š\n1// Use it before import PHP Simple HTML DOM Parser 2$html = file_get_html('http://www.google.com/'); 3 4// find a sample element by id 5$elt1 = $html-\u003efind('#footer', 0); 6 7// find a sample element by tag name 8$elt2= $html-\u003efind('div', 10); 9 10// it will return if found it: [@id=\"footer\"] 11$xpath = getElementXPath($elt1); 12 13// it will return if found it: html/body/div[10] 14$xpath = getElementXPath($elt2); 15 16function getElementXPath($elt){ 17\t$path = ''; 18\t$first = TRUE; 19\tfor(; ($elt AND $elt-\u003enodetype == 1); $elt = $elt-\u003eparent()) 20\t{ 21\t$xname = $elt-\u003etag; 22\t$idx = getElementIdx($elt); 23\tif ($first AND isset($elt-\u003eattr['id'])) 24\t{ 25\t$path = '//*[@id=\"' . $elt-\u003eattr['id'] . '\"]'; 26\tbreak; 27\t} 28 29\tif ($idx \u003e 1) 30\t{ 31\t%xname .= '[' . $idx . ']'; 32\t} 33 34\t$path = '/'.$xname.$path; 35\t$first = FALSE; 36\t} 37 38\treturn $path; 39} 40 41function getElementIdx($elt){ 42\t$count = 1; 43\tfor($sib = $elt-\u003eprev_sibling(); $sib ; $sib = $sib-\u003eprev_sibling()) 44\t{ 45\tif($sib-\u003enodetype == 1 \u0026\u0026 $sib-\u003etag == $elt-\u003etag) 46\t{ 47\t$count++; 48\t} 49\t} 50\treturn $count; 51} å¤§å®¶åŒæ ·å¯ä»¥æŠŠä¸Šé¢çš„ä»£ç ç›´æ¥ crack åˆ° PHP Simple HTML DOM Parser åº“ä¸­ã€‚\n","wordCount":"527","inLanguage":"zh","datePublished":"2010-04-02T12:34:56+08:00","dateModified":"2010-04-02T12:34:56+08:00","author":{"@type":"Person","name":"icyleaf"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://icyleaf.com/2010/04/how-to-get-xpath-of-an-element-for-php-and-javascript/"},"publisher":{"@type":"Organization","name":"icyleaf","logo":{"@type":"ImageObject","url":"https://icyleaf.com/favicon.ico"}}}</script></head><body><div class=wrapper><nav class=navbar><progress class=content_progress max=0 value=0></progress><div class=container><div class="navbar-header header-logo"><a href=https://icyleaf.com/>icyleaf</a></div><div class=navbar-right><span class=menu><a class=menu-item href=https://icyleaf.com/about title>About</a>
<a class=menu-item href=https://icyleaf.com/projects title>Projects</a>
<a class=menu-item href=https://icyleaf.com/index.xml title>Feed</a>
<span class=divide></span>
<a href=javascript:void(0); class=theme-switch><i class="iconfont icon-dark-mode"></i></a></span></div></div></nav><nav class=navbar-mobile id=nav-mobile style=display:none><progress class=content_progress max=0 value=0></progress><div class=container><div class=navbar><div class="navbar-header header-logo"><a href=https://icyleaf.com/>icyleaf</a></div><div class=navbar-right><div><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-dark-mode"></i></a></div><div class=menu-toggle><span></span><span></span><span></span></div></div></div><div class=menu id=mobile-menu><nav class=mb-md><a class=menu-item href=https://icyleaf.com/about title><h3>About</h3><div class=menu-active></div></a><a class=menu-item href=https://icyleaf.com/projects title><h3>Projects</h3><div class=menu-active></div></a><a class=menu-item href=https://icyleaf.com/index.xml title><h3>Feed</h3><div class=menu-active></div></a></nav></div></div></nav><main class=main><div class=container><article class=post-warp itemscope itemtype=http://schema.org/Article><header class=post-header><h1 class=post-title itemprop=description>å¦‚ä½•è·å– Element çš„ XPath [PHP/Javascript]</h1><div class=post-meta><time datetime=2010-04-02 itemprop=datePublished>2010-04-02</time>
Â·
<span class=tags>PHP, Javascript</span>
Â·
<span class=post-word-count>527 words Â· 2 minutes</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>ç›®å½•</h2><div class="post-toc-content always-active"><nav id=TableOfContents></nav></div></div><div class=post-content><div id=post-gallery><p>è¿™ä¸¤å¤©ç ”ç©¶ HTML çš„ DOM éœ€è¦å¯»æ‰¾æŸä¸ª Element å…ƒç´ çš„å®Œæ•´ XPath è·¯å¾„ï¼Œç”±äºä½¿ç”¨çš„æ˜¯ <a href=http://simplehtmldom.sourceforge.net/manual.htm>PHP Simple HTML DOM Parser</a> å¼€æºåº“ï¼Œè¿™ä¸ªåº“ç±»çš„ä½¿ç”¨æ–¹æ³•å‡ ä¹å…¼å®¹ Javascript çš„ DOM è¯­æ³•å¹¶é™„å¸¦ DOM é€‰æ‹©å™¨ã€‚è™½ç„¶åŠŸèƒ½å¼ºå¤§ä½†æ˜¯å¹¶ä¸èƒ½ç›´æ¥è·å– Element çš„ XPathã€‚è¿™ä¸ªæ€ä¹ˆåŠå‘¢ï¼Œä¾ç¨€è®°å¾— Firebug æœ‰ä¸€ä¸ªåŠŸèƒ½ï¼Œé€‰æ‹©æŸä¸ªå…ƒç´ åœ¨å®ƒçš„æ§åˆ¶å°å¯ä»¥æ˜¾ç¤º XPathã€‚å—¯ï¼Œç€æ‰‹å®è·µä¸€ä¸‹å‘ç°ä¸ä»…å¯ä»¥æ˜¾ç¤ºè€Œä¸”è¿˜å¯ä»¥å¤åˆ¶ XPathã€‚</p><p>äºæ˜¯æƒ³ï¼Œå¦‚æœå¯ä»¥æ‰¾åˆ° Javascript ç‰ˆçš„ç›¸å…³ä»£ç å°±ä¸€å®šå¯ä»¥æ”¹æˆ PHP ç‰ˆæœ¬çš„ï¼Œç»“æœåœ¨ Google æœç´¢æ‰¾åˆ°äº†&mldr;</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=ln> 1</span><span class=cl><span class=kd>var</span> <span class=nx>elt</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;table&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl><span class=kd>var</span> <span class=nx>xpath</span> <span class=o>=</span> <span class=nx>getElementXPath</span><span class=p>(</span><span class=nx>elt</span><span class=p>);</span><span class=nx>alert</span><span class=p>(</span><span class=nx>xpath</span><span class=p>);</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl>
</span></span><span class=line><span class=ln> 4</span><span class=cl><span class=c1>// Get full XPath of an element
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>getElementXPath</span><span class=p>(</span><span class=nx>elt</span><span class=p>){</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>	<span class=kd>var</span> <span class=nx>path</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>	<span class=k>for</span> <span class=p>(;</span> <span class=nx>elt</span> <span class=o>&amp;&amp;</span> <span class=nx>elt</span><span class=p>.</span><span class=nx>nodeType</span> <span class=o>==</span> <span class=mi>1</span><span class=p>;</span> <span class=nx>elt</span> <span class=o>=</span> <span class=nx>elt</span><span class=p>.</span><span class=nx>parentNode</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>		<span class=nx>idx</span> <span class=o>=</span> <span class=nx>getElementIdx</span><span class=p>(</span><span class=nx>elt</span><span class=p>);</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>		<span class=nx>xname</span> <span class=o>=</span> <span class=nx>elt</span><span class=p>.</span><span class=nx>tagName</span><span class=p>;</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>		<span class=k>if</span> <span class=p>(</span><span class=nx>idx</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>)</span> <span class=nx>xname</span> <span class=o>+=</span> <span class=s2>&#34;[&#34;</span> <span class=o>+</span> <span class=nx>idx</span> <span class=o>+</span> <span class=s2>&#34;]&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>		<span class=nx>path</span> <span class=o>=</span> <span class=s2>&#34;/&#34;</span> <span class=o>+</span> <span class=nx>xname</span> <span class=o>+</span> <span class=nx>path</span><span class=p>;</span>
</span></span><span class=line><span class=ln>13</span><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=ln>14</span><span class=cl>	<span class=k>return</span> <span class=nx>path</span><span class=p>;</span>
</span></span><span class=line><span class=ln>15</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>16</span><span class=cl>
</span></span><span class=line><span class=ln>17</span><span class=cl><span class=c1>// Get Idx of an element
</span></span></span><span class=line><span class=ln>18</span><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>getElementIdx</span><span class=p>(</span><span class=nx>elt</span><span class=p>){</span>
</span></span><span class=line><span class=ln>19</span><span class=cl>	<span class=kd>var</span> <span class=nx>count</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=ln>20</span><span class=cl>	<span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>sib</span> <span class=o>=</span> <span class=nx>elt</span><span class=p>.</span><span class=nx>previousSibling</span><span class=p>;</span> <span class=nx>sib</span> <span class=p>;</span> <span class=nx>sib</span> <span class=o>=</span> <span class=nx>sib</span><span class=p>.</span><span class=nx>previousSibling</span><span class=p>)</span>
</span></span><span class=line><span class=ln>21</span><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=ln>22</span><span class=cl>		<span class=k>if</span><span class=p>(</span><span class=nx>sib</span><span class=p>.</span><span class=nx>nodeType</span> <span class=o>==</span> <span class=mi>1</span> <span class=o>&amp;&amp;</span> <span class=nx>sib</span><span class=p>.</span><span class=nx>tagName</span> <span class=o>==</span> <span class=nx>elt</span><span class=p>.</span><span class=nx>tagName</span><span class=p>)</span>  <span class=nx>count</span><span class=o>++</span>
</span></span><span class=line><span class=ln>23</span><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=ln>24</span><span class=cl>	<span class=k>return</span> <span class=nx>count</span><span class=p>;</span>
</span></span><span class=line><span class=ln>25</span><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>PHP æ”¹è¿›ç‰ˆï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=ln> 1</span><span class=cl><span class=c1>// Use it before import PHP Simple HTML DOM Parser
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=c1></span><span class=nv>$html</span> <span class=o>=</span> <span class=nx>file_get_html</span><span class=p>(</span><span class=s1>&#39;http://www.google.com/&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl>
</span></span><span class=line><span class=ln> 4</span><span class=cl><span class=c1>// find a sample element by id
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=c1></span><span class=nv>$elt1</span> <span class=o>=</span> <span class=nv>$html</span><span class=o>-&gt;</span><span class=na>find</span><span class=p>(</span><span class=s1>&#39;#footer&#39;</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>
</span></span><span class=line><span class=ln> 7</span><span class=cl><span class=c1>// find a sample element by tag name
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=c1></span><span class=nv>$elt2</span><span class=o>=</span> <span class=nv>$html</span><span class=o>-&gt;</span><span class=na>find</span><span class=p>(</span><span class=s1>&#39;div&#39;</span><span class=p>,</span> <span class=mi>10</span><span class=p>);</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>
</span></span><span class=line><span class=ln>10</span><span class=cl><span class=c1>// it will return if found it: [@id=&#34;footer&#34;]
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=c1></span><span class=nv>$xpath</span> <span class=o>=</span> <span class=nx>getElementXPath</span><span class=p>(</span><span class=nv>$elt1</span><span class=p>);</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>
</span></span><span class=line><span class=ln>13</span><span class=cl><span class=c1>// it will return if found it: html/body/div[10]
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=c1></span><span class=nv>$xpath</span> <span class=o>=</span> <span class=nx>getElementXPath</span><span class=p>(</span><span class=nv>$elt2</span><span class=p>);</span>
</span></span><span class=line><span class=ln>15</span><span class=cl>
</span></span><span class=line><span class=ln>16</span><span class=cl><span class=k>function</span> <span class=nf>getElementXPath</span><span class=p>(</span><span class=nv>$elt</span><span class=p>){</span>
</span></span><span class=line><span class=ln>17</span><span class=cl>	<span class=nv>$path</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>18</span><span class=cl>	<span class=nv>$first</span> <span class=o>=</span> <span class=k>TRUE</span><span class=p>;</span>
</span></span><span class=line><span class=ln>19</span><span class=cl>	<span class=k>for</span><span class=p>(;</span> <span class=p>(</span><span class=nv>$elt</span> <span class=k>AND</span> <span class=nv>$elt</span><span class=o>-&gt;</span><span class=na>nodetype</span> <span class=o>==</span> <span class=mi>1</span><span class=p>);</span> <span class=nv>$elt</span> <span class=o>=</span> <span class=nv>$elt</span><span class=o>-&gt;</span><span class=na>parent</span><span class=p>())</span>
</span></span><span class=line><span class=ln>20</span><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=ln>21</span><span class=cl>		<span class=nv>$xname</span> <span class=o>=</span> <span class=nv>$elt</span><span class=o>-&gt;</span><span class=na>tag</span><span class=p>;</span>
</span></span><span class=line><span class=ln>22</span><span class=cl>		<span class=nv>$idx</span> <span class=o>=</span> <span class=nx>getElementIdx</span><span class=p>(</span><span class=nv>$elt</span><span class=p>);</span>
</span></span><span class=line><span class=ln>23</span><span class=cl>		<span class=k>if</span> <span class=p>(</span><span class=nv>$first</span> <span class=k>AND</span> <span class=nx>isset</span><span class=p>(</span><span class=nv>$elt</span><span class=o>-&gt;</span><span class=na>attr</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>]))</span>
</span></span><span class=line><span class=ln>24</span><span class=cl>		<span class=p>{</span>
</span></span><span class=line><span class=ln>25</span><span class=cl>			<span class=nv>$path</span> <span class=o>=</span> <span class=s1>&#39;//*[@id=&#34;&#39;</span> <span class=o>.</span> <span class=nv>$elt</span><span class=o>-&gt;</span><span class=na>attr</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>]</span> <span class=o>.</span> <span class=s1>&#39;&#34;]&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>26</span><span class=cl>			<span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=ln>27</span><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=ln>28</span><span class=cl>
</span></span><span class=line><span class=ln>29</span><span class=cl>		<span class=k>if</span> <span class=p>(</span><span class=nv>$idx</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=ln>30</span><span class=cl>		<span class=p>{</span>
</span></span><span class=line><span class=ln>31</span><span class=cl>			<span class=o>%</span><span class=nx>xname</span> <span class=o>.=</span> <span class=s1>&#39;[&#39;</span> <span class=o>.</span> <span class=nv>$idx</span> <span class=o>.</span> <span class=s1>&#39;]&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>32</span><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=ln>33</span><span class=cl>
</span></span><span class=line><span class=ln>34</span><span class=cl>		<span class=nv>$path</span> <span class=o>=</span> <span class=s1>&#39;/&#39;</span><span class=o>.</span><span class=nv>$xname</span><span class=o>.</span><span class=nv>$path</span><span class=p>;</span>
</span></span><span class=line><span class=ln>35</span><span class=cl>		<span class=nv>$first</span> <span class=o>=</span> <span class=k>FALSE</span><span class=p>;</span>
</span></span><span class=line><span class=ln>36</span><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=ln>37</span><span class=cl>
</span></span><span class=line><span class=ln>38</span><span class=cl>	<span class=k>return</span> <span class=nv>$path</span><span class=p>;</span>
</span></span><span class=line><span class=ln>39</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>40</span><span class=cl>
</span></span><span class=line><span class=ln>41</span><span class=cl><span class=k>function</span> <span class=nf>getElementIdx</span><span class=p>(</span><span class=nv>$elt</span><span class=p>){</span>
</span></span><span class=line><span class=ln>42</span><span class=cl>	<span class=nv>$count</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=ln>43</span><span class=cl>	<span class=k>for</span><span class=p>(</span><span class=nv>$sib</span> <span class=o>=</span> <span class=nv>$elt</span><span class=o>-&gt;</span><span class=na>prev_sibling</span><span class=p>();</span> <span class=nv>$sib</span> <span class=p>;</span> <span class=nv>$sib</span> <span class=o>=</span> <span class=nv>$sib</span><span class=o>-&gt;</span><span class=na>prev_sibling</span><span class=p>())</span>
</span></span><span class=line><span class=ln>44</span><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=ln>45</span><span class=cl>		<span class=k>if</span><span class=p>(</span><span class=nv>$sib</span><span class=o>-&gt;</span><span class=na>nodetype</span> <span class=o>==</span> <span class=mi>1</span> <span class=o>&amp;&amp;</span> <span class=nv>$sib</span><span class=o>-&gt;</span><span class=na>tag</span> <span class=o>==</span> <span class=nv>$elt</span><span class=o>-&gt;</span><span class=na>tag</span><span class=p>)</span>
</span></span><span class=line><span class=ln>46</span><span class=cl>		<span class=p>{</span>
</span></span><span class=line><span class=ln>47</span><span class=cl>			<span class=nv>$count</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=ln>48</span><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=ln>49</span><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=ln>50</span><span class=cl>	<span class=k>return</span> <span class=nv>$count</span><span class=p>;</span>
</span></span><span class=line><span class=ln>51</span><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>å¤§å®¶åŒæ ·å¯ä»¥æŠŠä¸Šé¢çš„ä»£ç ç›´æ¥ crack åˆ° PHP Simple HTML DOM Parser åº“ä¸­ã€‚</p></div></div><div class=post-nav><a href=https://icyleaf.com/2010/01/douban-api-package/ class=prev rel=prev title="Douban API Package å‘å¸ƒï¼"><i class="iconfont icon-left"></i>&nbsp;Douban API Package å‘å¸ƒï¼</a>
<a href=https://icyleaf.com/2010/05/nginx-with-fastcgi-build-kohana/ class=next rel=next title="Nginx+FastCGI ç¯å¢ƒæ­å»º Kohana">Nginx+FastCGI ç¯å¢ƒæ­å»º Kohana&nbsp;<i class="iconfont icon-right"></i></a></div><div class=post-comment><script src=https://giscus.app/client.js data-repo=icyleaf/icyleaf.com data-repo-id="MDEwOlJlcG9zaXRvcnk1NDg4MDA5Mg==" data-category=Announcements data-category-id=DIC_kwDOA0VnXM4CQ0mH data-mapping=title data-strict=0 data-reactions-enabled="MDEwOlJlcG9zaXRvcnk1NDg4MDA5Mg==" data-emit-metadata=0 data-input-position=top data-theme=preferred_color_scheme data-lang=zh-CN data-loading=lazy crossorigin=anonymous async></script></div></article></div></main><footer class=footer><div class=copyright>&copy;
<span itemprop=copyrightYear>2005 - 2022</span>
<span>ğŸº</span>
<span class=author itemprop=copyrightHolder><a href=https://icyleaf.com/>icyleaf</a></span></div></footer><script defer src=https://fastly.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.min.js crossorigin=anonymous></script>
<script defer src=https://icyleaf.com/js/vendor_main.min.js></script>
<script type=module>
  
  import PhotoSwipeLightbox from '\/photoswipe\/photoswipe-lightbox.esm.js';

  const lightbox = new PhotoSwipeLightbox({
    gallery: '#post-gallery',
    children: 'a.gallery-item',
    pswpModule: () => import('\/photoswipe\/photoswipe.esm.js'),
  });
  lightbox.init();
</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-TKQBZ7R259"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-TKQBZ7R259")</script></div></body></html>