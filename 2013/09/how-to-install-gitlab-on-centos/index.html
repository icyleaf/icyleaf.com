<!doctype html><html lang=zh-cn></html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>å¦‚ä½•åœ¨ CentOS ä¸Šå®‰è£… Gitlab | icyleaf</title><meta name=keywords content="Linux,CentOS,Git"><meta name=description content="Barl Metal å®‰è£…æœåŠ¡ä¾èµ–è¿˜æ˜¯å¾ˆç—›è‹¦çš„ï¼ŒCentOS ä¸Šæ˜¯ç—›è‹¦é¢å…·"><meta name=author content="icyleaf"><link rel=canonical href=https://icyleaf.com/2013/09/how-to-install-gitlab-on-centos/><link rel=icon href=https://icyleaf.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://icyleaf.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://icyleaf.com/favicon-32x32.png><link rel=icon type=image/png sizes=192x192 href=https://icyleaf.com/android-chrome-192x192.png><link rel=icon type=image/png sizes=512x512 href=https://icyleaf.com/android-chrome-512x512.png><link rel=apple-touch-icon href=https://icyleaf.com/apple-touch-icon.png><link rel=mask-icon href=https://icyleaf.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=stylesheet href=https://icyleaf.com/css/main.min.css><link rel=stylesheet href=https://icyleaf.com/font/iconfont.min.css><link rel=stylesheet href=https://icyleaf.com/font-ali/iconfont.min.css><link rel=stylesheet href=https://icyleaf.com/photoswipe/photoswipe.min.css><link rel=canonical href=https://icyleaf.com/2013/09/how-to-install-gitlab-on-centos/><meta property="og:title" content="å¦‚ä½•åœ¨ CentOS ä¸Šå®‰è£… Gitlab"><meta property="og:description" content="Barl Metal å®‰è£…æœåŠ¡ä¾èµ–è¿˜æ˜¯å¾ˆç—›è‹¦çš„ï¼ŒCentOS ä¸Šæ˜¯ç—›è‹¦é¢å…·"><meta property="og:type" content="article"><meta property="og:url" content="https://icyleaf.com/2013/09/how-to-install-gitlab-on-centos/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2013-09-17T12:34:56+08:00"><meta property="article:modified_time" content="2013-09-17T12:34:56+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="å¦‚ä½•åœ¨ CentOS ä¸Šå®‰è£… Gitlab"><meta name=twitter:description content="Barl Metal å®‰è£…æœåŠ¡ä¾èµ–è¿˜æ˜¯å¾ˆç—›è‹¦çš„ï¼ŒCentOS ä¸Šæ˜¯ç—›è‹¦é¢å…·"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://icyleaf.com/posts/"},{"@type":"ListItem","position":2,"name":"å¦‚ä½•åœ¨ CentOS ä¸Šå®‰è£… Gitlab","item":"https://icyleaf.com/2013/09/how-to-install-gitlab-on-centos/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"å¦‚ä½•åœ¨ CentOS ä¸Šå®‰è£… Gitlab","name":"å¦‚ä½•åœ¨ CentOS ä¸Šå®‰è£… Gitlab","description":"Barl Metal å®‰è£…æœåŠ¡ä¾èµ–è¿˜æ˜¯å¾ˆç—›è‹¦çš„ï¼ŒCentOS ä¸Šæ˜¯ç—›è‹¦é¢å…·","keywords":["Linux","CentOS","Git"],"articleBody":"2013 å¹´ 08 æœˆçš„ OpenParty â€œèŠ±äº‹å¦‚æœŸâ€ æ´»åŠ¨ä¸Šï¼Œæ™“ä¸œåœ¨ä»–çš„æœºå™¨ä¸Šæ¼”ç¤ºäº†è‡ªå»º Gitlab çš„é¡¹ç›®ï¼Œçœ‹åˆ° Gitlab ç›®å‰å·²ç»æ¯”è¾ƒæˆç†Ÿï¼Œè€Œä¸åƒæ—©æœŸå¯’ç¢œçš„ç•Œé¢ï¼Œè¿™ä¸ªæ—¶å€™çœ‹å®‰è£…ä¸€ä¸‹ä¹Ÿæ˜¯ä¸é”™çš„äº‹æƒ…ï¼Œä¸è¿‡ä»–ä»¬çš„é¡¹ç›®æ–‡æ¡£åªæä¾›äº† Ubuntu ç³»ç»Ÿçš„å®‰è£…æ–‡æ¡£ï¼Œå¯¹äº CentOS æ²¡æœ‰æåˆ°ï¼Œéå®˜æ–¹çš„æ–‡æ¡£æœ‰æ¯”è¾ƒè€ä¹…ï¼Œå‡­ç€ä¹‹å‰ç†Ÿæ‚‰ Ubuntu å’Œå­¦ä¹  CentOSï¼Œé‚£å°±å¼€å§‹å®‰è£…å§ï¼š\nä»¥ä¸‹æ•™ç¨‹åœ¨ CentOS 6 x86_64 ç‰ˆæœ¬ä¸‹æ“ä½œã€‚\né¦–å…ˆå®‰è£… EPEL å’Œç¼–è¯‘ä¾èµ–åº“ $ rpm -ivh http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm å¦‚æœä½ æ˜¯é 64 ä½ï¼Œå»ä¸Šé¢çš„ç½‘å€æ‰¾åˆ°é€‚åˆä½ å‘è¡Œç‰ˆçš„æœ€æ–°ç‰ˆæœ¬çš„ epel rpm\n$ yum -y update $ yum -y install gcc gcc-c++ make autoconf libyaml-devel gdbm-devel ncurses-devel openssl-devel zlib-devel readline-devel curl-devel expat-devel gettext-devel tk-devel libxml2-devel libffi-devel libxslt-devel libicu-devel sendmail patch libyaml* pcre-devel sqlite-devel vim å®‰è£… Python 2.7+ Gitlab è¦æ±‚ Python 2.5.5+ ä»¥åŠ Ruby 1.9+\nç³»ç»Ÿ Python é»˜è®¤æ˜¯ 2.6.xï¼Œå¦‚æœä½ æƒ³æŠŠ Python å‡çº§åˆ°ç›®å‰æ¯”è¾ƒæµè¡Œçš„ 2.7.x å°±å‚ç…§ä¸‹é¢æ­¥éª¤ï¼Œå¦åˆ™ç›´æ¥è·³è¿‡ã€‚ï¼ˆGitlab ç›®å‰ä¸æ”¯æŒ Python 3.0ï¼‰\n$ mkdir /tmp/gitlab \u0026\u0026 cd /tmp/gitlab $ curl --progress http://python.org/ftp/python/2.7.5/Python-2.7.5.tgz | tar xvf $ cd Python-2.7.5 $ ./configure --prefix=/usr/local $ make \u0026\u0026 make altinstall å®‰è£…å¥½ä¹‹åï¼Œéœ€è¦åšä¸¤ä»¶äº‹æƒ…ï¼Œæ›¿æ¢é»˜è®¤ python çš„ç‰ˆæœ¬è‡³æœ€æ–°ç‰ˆæœ¬ï¼Œ\n$ sudo ln -s /usr/local/bin/python2.7 /usr/local/bin/python å› ä¸ºç³»ç»Ÿé»˜è®¤ PATH çš„å¯»å€è·¯å¾„æ˜¯ /usr/local/bin\næœ€åçœ‹ä¸‹ Python ç‰ˆæœ¬æ˜¯å¦æ˜¯åˆšåˆšå®‰è£…çš„ç‰ˆæœ¬ï¼š\n$ python --version ç”±äº yum æ˜¯ python çš„ä¸€ä¸ª moduleï¼Œæ‰€ä»¥è¿™å—ä¿®æ”¹å¯èƒ½ä¼šå¼•èµ·æ— æ³•è°ƒç”¨ yum è„šæœ¬ï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶ /usr/bin/yum çš„ç¬¬ä¸€è¡Œä¸º !#/usr/bin/python2.6\nå®‰è£… Ruby 2.0 Ruby 1.9 å’Œ 2.0 çš„ç‰¹æ€§å·®åˆ«ä¸å¤§ï¼Œç´¢æ€§å‡çº§è‡³æœ€æ–° 2.0 ç‰ˆæœ¬å³å¯\n$ cd /tmp/gitlab $ curl --progress http://cache.ruby-lang.org/pub/ruby/2.0/ruby-2.0.0-p247.tar.gz | tar xz $ cd ruby-2.0.0-p247 $ ./configure $ make $ make install ruby 2.0 å·²ç»å†…ç½® gem (v2.0.3)ï¼Œåªéœ€è¦å®‰è£… bundler\n$ gem install bundler è‹¥åœ¨æ‰§è¡Œ sudo ruby æˆ– sudo gem æ‰¾ä¸åˆ°å‘½ä»¤ï¼Œå› ä¸ºç¼–è¯‘çš„è·¯å¾„é…ç½®åˆ°äº† /usr/local/binï¼Œæˆ‘ä»¬åªéœ€è¦åšä¸‹è½¯é“¾æ¥åˆ° root ç”¨æˆ·å¯ä»¥æ‰¾åˆ°çš„ $PATH è·¯å¾„ï¼š\n$ ln -s /usr/local/bin/ruby /usr/bin/ruby $ ln -s /usr/local/bin/gem /usr/bin/gem $ ln -s /usr/local/bin/bundle /usr/bin/bundle å®‰è£… Git å’Œ Gitolite $ yum -y install git-all gitolite å®‰è£… Nginx $ yum -y install nginx $ service nginx start nginx éœ€è¦ä» EPEL ä¸­å®‰è£…ï¼Œé»˜è®¤ç³»ç»Ÿæ²¡æœ‰ nginx åŒ…ã€‚\nå®‰è£… Mysql å’Œ Redis Gitlab è¦æ±‚å¼ºåˆ¶å®‰è£… redis å¤„ç†ä¸€äº›æ•°æ®ï¼Œå¦å¤–æ”¯æŒ MySQL å’Œ PostgreSQLï¼Œè¿™é‡Œä¸»è¦ä»¥ MySQL ä¸ºä¾‹\n$ yum -y install mysql mysql-devel mysql-server redis é…ç½® Mysql å’Œ gitlab éœ€è¦çš„ç”¨æˆ·å’Œæ•°æ®åº“\n$ service mysqld start $ mysql -u root $ mysql\u003e CREATE USER 'gitlab'@'localhost' IDENTIFIED BY 'gitlab'; $ mysql\u003e CREATE DATABASE IF NOT EXISTS `gitlabhq_production` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`; $ mysql\u003e GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, INDEX, ALTER ON `gitlabhq_production`.* TO 'gitlab'@'localhost'; $ mysql\u003e \\q Redis ä½¿ç”¨é»˜è®¤é…ç½®å³å¯ï¼Œç›´æ¥å¯åŠ¨\n$ service redis start æ·»åŠ  Gitlab ç”¨æˆ· $ useradd -c 'GitLab' git CentOS çš„å‘½ä»¤æ²¡æœ‰åŠæ³•ç›´æ¥ç¦æ­¢ç”¨æˆ·çš„è®¿é—®çš„å‚æ•°ï¼Œéœ€è¦ç”¨ä¸‹é¢å‘½ä»¤ï¼š\n$ passwd -l git å®‰è£… Gitlab-shell ä½¿ç”¨ root è´¦æˆ·åˆ‡æ¢åˆ° git è´¦æˆ·ä¸‹æ“ä½œï¼Œå¯ä»¥æ¯”å®˜æ–¹æ•™ç¨‹çœå»ä¸€äº›éº»çƒ¦çš„è¾“å…¥\n$ su git \u0026\u0026 cd /home/git $ git clone https://github.com/gitlabhq/gitlab-shell.git $ cd gitlab-shell é€šè¿‡ git tag æŸ¥çœ‹æœ€æ–°ç‰ˆæœ¬å¹¶åˆ‡æ¢ä¹‹\n$ git checkout v1.7.1 ç¼–è¾‘é…ç½®æ–‡ä»¶ä¿®æ”¹ä½ è¦è®¾å®šçš„åŸŸåï¼ˆdomainï¼‰ï¼Œæ¯”å¦‚ http://gitlab.dev/\n$ vim config.yml å®Œæˆä¹‹åæ‰§è¡Œå®‰è£…è„šæœ¬\n$ ./bin/install å®‰è£… Gitlab $ cd /home/git $ git clone https://github.com/gitlabhq/gitlabhq.git gitlab $ cd /home/git/gitlab é€šè¿‡ git tag æŸ¥çœ‹æœ€æ–°ç‰ˆæœ¬å¹¶åˆ‡æ¢ä¹‹\n$ git checkout 6.0.1 è¿™é‡Œéœ€è¦é…ç½®çš„ä¸œè¥¿å¤šä¸€äº›ï¼Œè¿™é‡Œå‚è€ƒå®˜æ–¹çš„æ–‡æ¡£ï¼Œä¹Ÿå¯ä»¥å®‰è£…æˆ‘ä¸‹é¢çš„æ­¥éª¤æ¥ï¼š\n$ cd /home/git/gitlab å¤åˆ¶é…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹ host ç›¸å…³çš„é…ç½®é¡¹ï¼Œä¸»è¦æ˜¯ domain è¦å’Œä¸Šé¢çš„ http://gitlab.dev\n$ cp config.yml{.example,} $ vim config/gitlab.yml ç¡®è®¤ gitlab ä»¥ä¸‹ç›®å½•çš„æƒé™æ˜¯å¦æ­£ç¡®\n$ mkdir tmp/pids/ $ mkdir tmp/sockets/ $ chown -R git log/ $ chown -R git tmp/ $ chmod -R u+rwX log/ $ chmod -R u+rwX tmp/ $ chmod -R u+rwX tmp/pids/ $ chmod -R u+rwX tmp/sockets/ åˆ›å»º satellites ç›®å½•ï¼Œè¿™ä¸ªç›®å½•æ˜¯ä¿å­˜å„ä¸ªç”¨æˆ·çš„ä»“åº“\n$ mkdir /home/git/gitlab-satellites åˆ›å»º uploads ç›®å½•ï¼ˆä¸ºä»€ä¹ˆ gitlab ä¸åœ¨é¡¹ç›®ä¸­åˆ›å»ºå‘¢= =ï¼ï¼‰\n$ mkdir public/uploads $ chmod -R u+rwX public/uploads å¤åˆ¶ unicorn é…ç½®æ–‡ä»¶\n$ cp config/unicorn.rb{.example,} è®¾ç½® ruby web å®¹å™¨çš„å‚æ•°ï¼Œæ¯”å¦‚ 2GB RAM æœåŠ¡å™¨å¯ä»¥è®¾ç½® 3 ä¸ª workerã€‚\nå¦‚æœç³»ç»Ÿå…¶ä»–æœåŠ¡å ç”¨äº† unicorn çš„ç«¯å£ï¼Œè®°å¾—æ”¹åã€‚\n$ vim config/unicorn.rb è®¾ç½®ä¸€äº› git å…¨å±€å‚æ•°\n$ git config --global user.name \"GitLab\" $ git config --global user.email \"gitlab@localhost\" $ git config --global core.autocrlf input é…ç½® gitlab æ•°æ®åº“è®¾ç½®\n$ cp config/database.yml{.mysql,} $ vim config/database.yml $ chmod o-rwx config/database.yml å®‰è£…å¿…éœ€çš„ Ruby Gems\n$ cd /home/git/gitlab $ [sudo] gem install charlock_holmes --version '0.6.9.4' $ bundle install --deployment --without development test postgres aws åˆå§‹åŒ–æ•°æ®åº“æ•°æ®ï¼ˆæ‰§è¡Œè¾“å…¥ Yes ç»§ç»­åˆ›å»ºï¼‰\n$ bundle exec rake gitlab:setup RAILS_ENV=production è®¾ç½® init è„šæœ¬\n$ sudo cp lib/support/init.d/gitlab /etc/init.d/gitlab $ sudo chmod +x /etc/init.d/gitlab æ£€æŸ¥ Gitlab çŠ¶æ€ $ bundle exec rake gitlab:env:info RAILS_ENV=production å¯åŠ¨ gitlab æœåŠ¡\n$ sudo service gitlab start å†èµ·æ£€æŸ¥ï¼Œä¿è¯æ‰€æœ‰é¡¹ç›®éƒ½æ˜¯ç»¿è‰²\n$ bundle exec rake gitlab:check RAILS_ENV=production é…ç½® nginx æ ¹æ® nginx çš„å®‰è£…è·¯å¾„é€‚å½“ä¿®æ”¹ä¸‹é¢çš„è·¯å¾„å³å¯ï¼Œæˆ‘ä»¬å…ˆæŠŠ gitlab æä¾›çš„é…ç½®æ–‡ä»¶æ‹·è´è¿‡å»\n$ sudo mkdir -p /etc/nginx/conf/sites/ $ sudo cp lib/support/nginx/gitlab /etc/nginx/conf/sites/gitlab.conf æ ¹æ® nginx ç‰ˆæœ¬å’Œä¸åŒå‘è¡Œç‰ˆçš„ä¸åŒï¼Œé…ç½®ç»“æ„å¯èƒ½ä¸åŒæ ¹æ®ä½ çš„å®é™…æƒ…å†µåŠ è½½ gitlab.conf\nä¿®æ”¹ gitlab.conf çš„ YOUR_SERVER_FQDN ä¸ºä¸Šé¢è®¾ç½®çš„ domainã€‚ æœ€åä¿®æ”¹ nginx.conf æˆ–è€… default.conf åŠ è½½ /etc/nginx/conf/site ä¸‹æ‰€æœ‰ conf æ–‡ä»¶\nhttp { include /etc/nginx/conf/site/*.conf; server { â€¦ } } ä¿å­˜åï¼Œé‡å¯å„ä¸ªæœåŠ¡\n$ sudo service nginx reload $ sudo service gitlab restart å¼€å§‹ Gitlab ä¹‹æ—… é…ç½®å¥½ hosts å³å¯è®¿é—® gitlab.dev\n$ echo \"127.0.0.1 gitlab.dev\" \u003e\u003e /etc/hosts é»˜è®¤çš„ç”¨æˆ·åå¯†ç ï¼š\nadmin@local.host 5iveL!fe å„ç§å‘ 1. é”™è¯¯æ—¥å¿—æŠ¥æƒé™é”™è¯¯ 2013/11/07 00:42:21 [crit] 15875#0: *2 stat() \"/home/git/gitlab/public/favicon.ico.html\" failed (13: Permission denied), client: 33.33.33.1, server: gitlab.web.lo, request: \"GET /favicon.ico HTTP/1.1\", host: \"gitlab.web.lo\" 2013/11/07 00:42:21 [crit] 15875#0: *2 connect() to unix:/home/git/gitlab/tmp/sockets/gitlab.socket failed (13: Permission denied) while connecting to upstream, client: 33.33.33.1, server: gitlab.web.lo, request: \"GET /favicon.ico HTTP/1.1\", upstream: \"http://unix:/home/git/gitlab/tmp/sockets/gitlab.socket:/favicon.ico\", host: \"gitlab.web.lo\" 2013/11/07 00:42:31 [crit] 15875#0: *2 stat() \"/home/git/gitlab/public/\" failed (13: Permission denied), client: 33.33.33.1, server: gitlab.web.lo, request: \"GET / HTTP/1.1\", host: \"gitlab.web.lo\" 2013/11/07 00:42:31 [crit] 15875#0: *2 stat() \"/home/git/gitlab/public//index.html\" failed (13: Permission denied), client: 33.33.33.1, server: gitlab.web.lo, request: \"GET / HTTP/1.1\", host: \"gitlab.web.lo\" 2013/11/07 00:42:31 [crit] 15875#0: *2 stat() \"/home/git/gitlab/public/.html\" failed (13: Permission denied), client: 33.33.33.1, server: gitlab.web.lo, request: \"GET / HTTP/1.1\", host: \"gitlab.web.lo\" 2013/11/07 00:42:31 [crit] 15875#0: *2 connect() to unix:/home/git/gitlab/tmp/sockets/gitlab.socket failed (13: Permission denied) while connecting to upstream, client: 33.33.33.1, server: gitlab.web.lo, request: \"GET / HTTP/1.1\", upstream: \"http://unix:/home/git/gitlab/tmp/sockets/gitlab.socket:/\", host: \"gitlab.web.lo\" 2013/11/07 00:42:31 [crit] 15875#0: *2 stat() \"/home/git/gitlab/public/favicon.ico\" failed (13: Permission denied), client: 33.33.33.1, server: gitlab.web.lo, request: \"GET /favicon.ico HTTP/1.1\", host: \"gitlab.web.lo\" 2013/11/07 00:42:31 [crit] 15875#0: *2 stat() \"/home/git/gitlab/public/favicon.ico/index.html\" failed (13: Permission denied), client: 33.33.33.1, server: gitlab.web.lo, request: \"GET /favicon.ico HTTP/1.1\", host: \"gitlab.web.lo\" 2013/11/07 00:42:31 [crit] 15875#0: *2 stat() \"/home/git/gitlab/public/favicon.ico.html\" failed (13: Permission denied), client: 33.33.33.1, server: gitlab.web.lo, request: \"GET /favicon.ico HTTP/1.1\", host: \"gitlab.web.lo\" 2013/11/07 00:42:31 [crit] 15875#0: *2 connect() to unix:/home/git/gitlab/tmp/sockets/gitlab.socket failed (13: Permission denied) while connecting to upstream, client: 33.33.33.1, server: gitlab.web.lo, request: \"GET /favicon.ico HTTP/1.1\", upstream: \"http://unix:/home/git/gitlab/tmp/sockets/gitlab.socket:/favicon.ico\", host: \"gitlab.web.lo\" è§£å†³æ–¹æ¡ˆ:\n$ (sudo) chmod o+x /home/git 2. 8080 ç«¯å£è¢«å ç”¨ è¿™æ ·ä¸»è¦æ˜¯å› ä¸º nginx çš„é…ç½®æ˜¯åš unicorn çš„ä»£ç†è½¬å‘ï¼Œå®é™…ä¸Š gitlab æ˜¯ç”± unicorn å®¹å™¨é©±åŠ¨ï¼Œè€Œåœ¨é…ç½®é‡Œé»˜è®¤ç»‘å®šçš„æ˜¯ 8080 ç«¯å£\n$ vim /home/git/gitlab/config/unicorn.rb æ‰¾åˆ° listen \"127.0.0.1:8080\", :tcp_nopush =\u003e true ä¿®æ”¹æˆå…¶ä»–æœªå ç”¨çš„ç«¯å£å·å³å¯ã€‚\n","wordCount":"1873","inLanguage":"zh-cn","datePublished":"2013-09-17T12:34:56+08:00","dateModified":"2013-09-17T12:34:56+08:00","author":{"@type":"Person","name":"icyleaf"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://icyleaf.com/2013/09/how-to-install-gitlab-on-centos/"},"publisher":{"@type":"Organization","name":"icyleaf","logo":{"@type":"ImageObject","url":"https://icyleaf.com/favicon.ico"}}}</script></head><body><div class=wrapper><nav class=navbar><progress class=content_progress max=0 value=0></progress><div class=container><div class="navbar-header header-logo"><a href=https://icyleaf.com/>icyleaf</a></div><div class=navbar-right><span class=menu><a class=menu-item href=https://icyleaf.com/series/homelab title>homelab ç³»åˆ—</a>
<a class=menu-item href=https://icyleaf.com/projects title>å¼€æºé¡¹ç›®</a>
<a class=menu-item href=https://icyleaf.com/gears title>æˆ‘çš„è®¾å¤‡</a>
<a class=menu-item href=https://icyleaf.com/about title>å…³äº</a>
<span class=divide></span>
<a href=javascript:void(0); class=theme-switch><i class="iconfont icon-dark-mode"></i></a></span></div></div></nav><nav class=navbar-mobile id=nav-mobile style=display:none><progress class=content_progress max=0 value=0></progress><div class=container><div class=navbar><div class="navbar-header header-logo"><a href=https://icyleaf.com/>icyleaf</a></div><div class=navbar-right><div><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-dark-mode"></i></a></div><div class=menu-toggle><span></span><span></span><span></span></div></div></div><div class=menu id=mobile-menu><nav class=mb-md><a class=menu-item href=https://icyleaf.com/series/homelab title><h3>homelab ç³»åˆ—</h3><div class=menu-active></div></a><a class=menu-item href=https://icyleaf.com/projects title><h3>å¼€æºé¡¹ç›®</h3><div class=menu-active></div></a><a class=menu-item href=https://icyleaf.com/gears title><h3>æˆ‘çš„è®¾å¤‡</h3><div class=menu-active></div></a><a class=menu-item href=https://icyleaf.com/about title><h3>å…³äº</h3><div class=menu-active></div></a></nav></div></div></nav><main class=main><div class=container><article class=post-warp itemscope itemtype=http://schema.org/Article><header class=post-header><h1 class=post-title itemprop=description>å¦‚ä½•åœ¨ CentOS ä¸Šå®‰è£… Gitlab</h1><div class=post-description>Barl Metal å®‰è£…æœåŠ¡ä¾èµ–è¿˜æ˜¯å¾ˆç—›è‹¦çš„ï¼ŒCentOS ä¸Šæ˜¯ç—›è‹¦é¢å…·</div><div class=post-meta><time datetime=2013-09-17 itemprop=datePublished>2013-09-17</time>
Â·
<span class=tags>Linux, CentOS, Git</span>
Â·
<span class=post-word-count>1873 words Â· 8 minutes</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>ç›®å½•</h2><div class="post-toc-content always-active"><nav id=TableOfContents><ul><li><a href=#é¦–å…ˆå®‰è£…-epel-å’Œç¼–è¯‘ä¾èµ–åº“>é¦–å…ˆå®‰è£… EPEL å’Œç¼–è¯‘ä¾èµ–åº“</a></li><li><a href=#å®‰è£…-python-27>å®‰è£… Python 2.7+</a></li><li><a href=#å®‰è£…-ruby-20>å®‰è£… Ruby 2.0</a></li><li><a href=#å®‰è£…-git-å’Œ-gitolite>å®‰è£… Git å’Œ Gitolite</a></li><li><a href=#å®‰è£…-nginx>å®‰è£… Nginx</a></li><li><a href=#å®‰è£…-mysql-å’Œ-redis>å®‰è£… Mysql å’Œ Redis</a></li><li><a href=#æ·»åŠ -gitlab-ç”¨æˆ·>æ·»åŠ  Gitlab ç”¨æˆ·</a></li><li><a href=#å®‰è£…-gitlab-shell>å®‰è£… Gitlab-shell</a></li><li><a href=#å®‰è£…-gitlab>å®‰è£… Gitlab</a></li><li><a href=#æ£€æŸ¥-gitlab-çŠ¶æ€>æ£€æŸ¥ Gitlab çŠ¶æ€</a></li><li><a href=#é…ç½®-nginx>é…ç½® nginx</a></li><li><a href=#å¼€å§‹-gitlab-ä¹‹æ—…>å¼€å§‹ Gitlab ä¹‹æ—…</a></li><li><a href=#å„ç§å‘>å„ç§å‘</a><ul><li><a href=#1-é”™è¯¯æ—¥å¿—æŠ¥æƒé™é”™è¯¯>1. é”™è¯¯æ—¥å¿—æŠ¥æƒé™é”™è¯¯</a></li><li><a href=#2-8080-ç«¯å£è¢«å ç”¨>2. 8080 ç«¯å£è¢«å ç”¨</a></li></ul></li></ul></nav></div></div><div class=post-content><div id=post-gallery><p>2013 å¹´ 08 æœˆçš„ OpenParty &ldquo;<a href=http://www.beijing-open-party.org/event/25>èŠ±äº‹å¦‚æœŸ</a>&rdquo; æ´»åŠ¨ä¸Šï¼Œ<a href=https://github.com/vecio>æ™“ä¸œ</a>åœ¨ä»–çš„æœºå™¨ä¸Šæ¼”ç¤ºäº†è‡ªå»º Gitlab çš„é¡¹ç›®ï¼Œçœ‹åˆ° Gitlab ç›®å‰å·²ç»æ¯”è¾ƒæˆç†Ÿï¼Œè€Œä¸åƒæ—©æœŸå¯’ç¢œçš„ç•Œé¢ï¼Œè¿™ä¸ªæ—¶å€™çœ‹å®‰è£…ä¸€ä¸‹ä¹Ÿæ˜¯ä¸é”™çš„äº‹æƒ…ï¼Œä¸è¿‡ä»–ä»¬çš„é¡¹ç›®æ–‡æ¡£åªæä¾›äº† Ubuntu ç³»ç»Ÿçš„<a href=https://github.com/gitlabhq/gitlabhq#installation>å®‰è£…æ–‡æ¡£</a>ï¼Œå¯¹äº CentOS æ²¡æœ‰æåˆ°ï¼Œéå®˜æ–¹çš„æ–‡æ¡£æœ‰æ¯”è¾ƒè€ä¹…ï¼Œå‡­ç€ä¹‹å‰ç†Ÿæ‚‰ Ubuntu å’Œå­¦ä¹  CentOSï¼Œé‚£å°±å¼€å§‹å®‰è£…å§ï¼š</p><p>ä»¥ä¸‹æ•™ç¨‹åœ¨ <code>CentOS 6 x86_64</code> ç‰ˆæœ¬ä¸‹æ“ä½œã€‚</p><h2 id=é¦–å…ˆå®‰è£…-epel-å’Œç¼–è¯‘ä¾èµ–åº“>é¦–å…ˆå®‰è£… EPEL å’Œç¼–è¯‘ä¾èµ–åº“</h2><pre tabindex=0><code>$ rpm -ivh http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm
</code></pre><blockquote><p>å¦‚æœä½ æ˜¯é 64 ä½ï¼Œå»ä¸Šé¢çš„ç½‘å€æ‰¾åˆ°é€‚åˆä½ å‘è¡Œç‰ˆçš„æœ€æ–°ç‰ˆæœ¬çš„ epel rpm</p></blockquote><pre tabindex=0><code>$ yum -y update
$ yum -y install gcc gcc-c++ make autoconf libyaml-devel gdbm-devel ncurses-devel openssl-devel zlib-devel readline-devel curl-devel expat-devel gettext-devel  tk-devel libxml2-devel libffi-devel libxslt-devel libicu-devel sendmail patch libyaml* pcre-devel sqlite-devel vim
</code></pre><h2 id=å®‰è£…-python-27>å®‰è£… Python 2.7+</h2><p>Gitlab è¦æ±‚ Python 2.5.5+ ä»¥åŠ Ruby 1.9+</p><p>ç³»ç»Ÿ Python é»˜è®¤æ˜¯ 2.6.xï¼Œå¦‚æœä½ æƒ³æŠŠ Python å‡çº§åˆ°ç›®å‰æ¯”è¾ƒæµè¡Œçš„ 2.7.x å°±å‚ç…§ä¸‹é¢æ­¥éª¤ï¼Œå¦åˆ™ç›´æ¥è·³è¿‡ã€‚ï¼ˆGitlab ç›®å‰ä¸æ”¯æŒ Python 3.0ï¼‰</p><pre tabindex=0><code>$ mkdir /tmp/gitlab &amp;&amp; cd /tmp/gitlab
$ curl --progress http://python.org/ftp/python/2.7.5/Python-2.7.5.tgz | tar xvf
$ cd Python-2.7.5
$ ./configure --prefix=/usr/local
$ make &amp;&amp; make altinstall
</code></pre><p>å®‰è£…å¥½ä¹‹åï¼Œéœ€è¦åšä¸¤ä»¶äº‹æƒ…ï¼Œæ›¿æ¢é»˜è®¤ python çš„ç‰ˆæœ¬è‡³æœ€æ–°ç‰ˆæœ¬ï¼Œ</p><pre tabindex=0><code>$ sudo ln -s /usr/local/bin/python2.7 /usr/local/bin/python
</code></pre><blockquote><p>å› ä¸ºç³»ç»Ÿé»˜è®¤ <code>PATH</code> çš„å¯»å€è·¯å¾„æ˜¯ <code>/usr/local/bin</code></p></blockquote><p>æœ€åçœ‹ä¸‹ Python ç‰ˆæœ¬æ˜¯å¦æ˜¯åˆšåˆšå®‰è£…çš„ç‰ˆæœ¬ï¼š</p><pre tabindex=0><code>$ python --version
</code></pre><blockquote><p>ç”±äº <code>yum</code> æ˜¯ python çš„ä¸€ä¸ª moduleï¼Œæ‰€ä»¥è¿™å—ä¿®æ”¹å¯èƒ½ä¼šå¼•èµ·æ— æ³•è°ƒç”¨ yum è„šæœ¬ï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶ <code>/usr/bin/yum</code> çš„ç¬¬ä¸€è¡Œä¸º <code>!#/usr/bin/python2.6</code></p></blockquote><h2 id=å®‰è£…-ruby-20>å®‰è£… Ruby 2.0</h2><p>Ruby 1.9 å’Œ 2.0 çš„ç‰¹æ€§å·®åˆ«ä¸å¤§ï¼Œç´¢æ€§å‡çº§è‡³æœ€æ–° 2.0 ç‰ˆæœ¬å³å¯</p><pre tabindex=0><code>$ cd /tmp/gitlab
$ curl --progress http://cache.ruby-lang.org/pub/ruby/2.0/ruby-2.0.0-p247.tar.gz | tar xz
$ cd ruby-2.0.0-p247
$ ./configure
$ make
$ make install
</code></pre><p>ruby 2.0 å·²ç»å†…ç½® gem (v2.0.3)ï¼Œåªéœ€è¦å®‰è£… bundler</p><pre tabindex=0><code>$ gem install bundler
</code></pre><blockquote><p>è‹¥åœ¨æ‰§è¡Œ <code>sudo ruby</code> æˆ– <code>sudo gem</code> æ‰¾ä¸åˆ°å‘½ä»¤ï¼Œå› ä¸ºç¼–è¯‘çš„è·¯å¾„é…ç½®åˆ°äº† <code>/usr/local/bin</code>ï¼Œæˆ‘ä»¬åªéœ€è¦åšä¸‹è½¯é“¾æ¥åˆ° root ç”¨æˆ·å¯ä»¥æ‰¾åˆ°çš„ <code>$PATH</code> è·¯å¾„ï¼š</p></blockquote><pre tabindex=0><code>$ ln -s /usr/local/bin/ruby /usr/bin/ruby
$ ln -s /usr/local/bin/gem /usr/bin/gem
$ ln -s /usr/local/bin/bundle /usr/bin/bundle
</code></pre><h2 id=å®‰è£…-git-å’Œ-gitolite>å®‰è£… Git å’Œ Gitolite</h2><pre tabindex=0><code>$ yum -y install git-all gitolite
</code></pre><h2 id=å®‰è£…-nginx>å®‰è£… Nginx</h2><pre tabindex=0><code>$ yum -y install nginx
$ service nginx start
</code></pre><blockquote><p>nginx éœ€è¦ä» EPEL ä¸­å®‰è£…ï¼Œé»˜è®¤ç³»ç»Ÿæ²¡æœ‰ nginx åŒ…ã€‚</p></blockquote><h2 id=å®‰è£…-mysql-å’Œ-redis>å®‰è£… Mysql å’Œ Redis</h2><p>Gitlab è¦æ±‚å¼ºåˆ¶å®‰è£… redis å¤„ç†ä¸€äº›æ•°æ®ï¼Œå¦å¤–æ”¯æŒ MySQL å’Œ PostgreSQLï¼Œè¿™é‡Œä¸»è¦ä»¥ MySQL ä¸ºä¾‹</p><pre tabindex=0><code>$ yum -y install mysql mysql-devel mysql-server redis
</code></pre><p>é…ç½® Mysql å’Œ gitlab éœ€è¦çš„ç”¨æˆ·å’Œæ•°æ®åº“</p><pre tabindex=0><code>$ service mysqld start
$ mysql -u root
$ mysql&gt; CREATE USER &#39;gitlab&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;gitlab&#39;;
$ mysql&gt; CREATE DATABASE IF NOT EXISTS `gitlabhq_production` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`;
$ mysql&gt; GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, INDEX, ALTER ON `gitlabhq_production`.* TO &#39;gitlab&#39;@&#39;localhost&#39;;
$ mysql&gt; \q
</code></pre><p>Redis ä½¿ç”¨é»˜è®¤é…ç½®å³å¯ï¼Œç›´æ¥å¯åŠ¨</p><pre tabindex=0><code>$ service redis start
</code></pre><h2 id=æ·»åŠ -gitlab-ç”¨æˆ·>æ·»åŠ  Gitlab ç”¨æˆ·</h2><pre tabindex=0><code>$ useradd -c &#39;GitLab&#39; git
</code></pre><p>CentOS çš„å‘½ä»¤æ²¡æœ‰åŠæ³•ç›´æ¥ç¦æ­¢ç”¨æˆ·çš„è®¿é—®çš„å‚æ•°ï¼Œéœ€è¦ç”¨ä¸‹é¢å‘½ä»¤ï¼š</p><pre tabindex=0><code>$ passwd -l git
</code></pre><h2 id=å®‰è£…-gitlab-shell>å®‰è£… Gitlab-shell</h2><p>ä½¿ç”¨ root è´¦æˆ·åˆ‡æ¢åˆ° git è´¦æˆ·ä¸‹æ“ä½œï¼Œå¯ä»¥æ¯”å®˜æ–¹æ•™ç¨‹çœå»ä¸€äº›éº»çƒ¦çš„è¾“å…¥</p><pre tabindex=0><code>$ su git &amp;&amp; cd /home/git
$ git clone https://github.com/gitlabhq/gitlab-shell.git
$ cd gitlab-shell
</code></pre><p>é€šè¿‡ <code>git tag</code> æŸ¥çœ‹æœ€æ–°ç‰ˆæœ¬å¹¶åˆ‡æ¢ä¹‹</p><pre tabindex=0><code>$ git checkout v1.7.1
</code></pre><p>ç¼–è¾‘é…ç½®æ–‡ä»¶ä¿®æ”¹ä½ è¦è®¾å®šçš„åŸŸåï¼ˆdomainï¼‰ï¼Œæ¯”å¦‚ <code>http://gitlab.dev/</code></p><pre tabindex=0><code>$ vim config.yml
</code></pre><p>å®Œæˆä¹‹åæ‰§è¡Œå®‰è£…è„šæœ¬</p><pre tabindex=0><code>$ ./bin/install
</code></pre><h2 id=å®‰è£…-gitlab>å®‰è£… Gitlab</h2><pre tabindex=0><code>$ cd /home/git
$ git clone https://github.com/gitlabhq/gitlabhq.git gitlab
$ cd /home/git/gitlab
</code></pre><p>é€šè¿‡ <code>git tag</code> æŸ¥çœ‹æœ€æ–°ç‰ˆæœ¬å¹¶åˆ‡æ¢ä¹‹</p><pre tabindex=0><code>$ git checkout 6.0.1
</code></pre><p>è¿™é‡Œéœ€è¦é…ç½®çš„ä¸œè¥¿å¤šä¸€äº›ï¼Œè¿™é‡Œå‚è€ƒ<a href=https://github.com/gitlabhq/gitlabhq/blob/master/doc/install/installation.md#configure-it>å®˜æ–¹çš„æ–‡æ¡£</a>ï¼Œä¹Ÿå¯ä»¥å®‰è£…æˆ‘ä¸‹é¢çš„æ­¥éª¤æ¥ï¼š</p><pre tabindex=0><code>$ cd /home/git/gitlab
</code></pre><p>å¤åˆ¶é…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹ host ç›¸å…³çš„é…ç½®é¡¹ï¼Œä¸»è¦æ˜¯ domain è¦å’Œä¸Šé¢çš„ <code>http://gitlab.dev</code></p><pre tabindex=0><code>$ cp config.yml{.example,}
$ vim config/gitlab.yml
</code></pre><p>ç¡®è®¤ gitlab ä»¥ä¸‹ç›®å½•çš„æƒé™æ˜¯å¦æ­£ç¡®</p><pre tabindex=0><code>$ mkdir tmp/pids/
$ mkdir tmp/sockets/
$ chown -R git log/
$ chown -R git tmp/
$ chmod -R u+rwX log/
$ chmod -R u+rwX tmp/
$ chmod -R u+rwX tmp/pids/
$ chmod -R u+rwX tmp/sockets/
</code></pre><p>åˆ›å»º satellites ç›®å½•ï¼Œè¿™ä¸ªç›®å½•æ˜¯ä¿å­˜å„ä¸ªç”¨æˆ·çš„ä»“åº“</p><pre tabindex=0><code>$ mkdir /home/git/gitlab-satellites
</code></pre><p>åˆ›å»º uploads ç›®å½•ï¼ˆä¸ºä»€ä¹ˆ gitlab ä¸åœ¨é¡¹ç›®ä¸­åˆ›å»ºå‘¢= =ï¼ï¼‰</p><pre tabindex=0><code>$ mkdir public/uploads
$ chmod -R u+rwX  public/uploads
</code></pre><p>å¤åˆ¶ unicorn é…ç½®æ–‡ä»¶</p><pre tabindex=0><code>$ cp config/unicorn.rb{.example,}
</code></pre><p>è®¾ç½® ruby web å®¹å™¨çš„å‚æ•°ï¼Œæ¯”å¦‚ 2GB RAM æœåŠ¡å™¨å¯ä»¥è®¾ç½® 3 ä¸ª workerã€‚</p><blockquote><p>å¦‚æœç³»ç»Ÿå…¶ä»–æœåŠ¡å ç”¨äº† unicorn çš„ç«¯å£ï¼Œè®°å¾—æ”¹åã€‚</p></blockquote><pre tabindex=0><code>$ vim config/unicorn.rb
</code></pre><p>è®¾ç½®ä¸€äº› git å…¨å±€å‚æ•°</p><pre tabindex=0><code>$ git config --global user.name &#34;GitLab&#34;
$ git config --global user.email &#34;gitlab@localhost&#34;
$ git config --global core.autocrlf input
</code></pre><p>é…ç½® gitlab æ•°æ®åº“è®¾ç½®</p><pre tabindex=0><code>$ cp config/database.yml{.mysql,}
$ vim config/database.yml
$ chmod o-rwx config/database.yml
</code></pre><p>å®‰è£…å¿…éœ€çš„ Ruby Gems</p><pre tabindex=0><code>$ cd /home/git/gitlab
$ [sudo] gem install charlock_holmes --version &#39;0.6.9.4&#39;
$ bundle install --deployment --without development test postgres aws
</code></pre><p>åˆå§‹åŒ–æ•°æ®åº“æ•°æ®ï¼ˆæ‰§è¡Œè¾“å…¥ <code>Yes</code> ç»§ç»­åˆ›å»ºï¼‰</p><pre tabindex=0><code>$ bundle exec rake gitlab:setup RAILS_ENV=production
</code></pre><p>è®¾ç½® init è„šæœ¬</p><pre tabindex=0><code>$ sudo cp lib/support/init.d/gitlab /etc/init.d/gitlab
$ sudo chmod +x /etc/init.d/gitlab
</code></pre><h2 id=æ£€æŸ¥-gitlab-çŠ¶æ€>æ£€æŸ¥ Gitlab çŠ¶æ€</h2><pre tabindex=0><code>$ bundle exec rake gitlab:env:info RAILS_ENV=production
</code></pre><p>å¯åŠ¨ gitlab æœåŠ¡</p><pre tabindex=0><code>$ sudo service gitlab start
</code></pre><p>å†èµ·æ£€æŸ¥ï¼Œä¿è¯æ‰€æœ‰é¡¹ç›®éƒ½æ˜¯ç»¿è‰²</p><pre tabindex=0><code>$ bundle exec rake gitlab:check RAILS_ENV=production
</code></pre><h2 id=é…ç½®-nginx>é…ç½® nginx</h2><p>æ ¹æ® nginx çš„å®‰è£…è·¯å¾„é€‚å½“ä¿®æ”¹ä¸‹é¢çš„è·¯å¾„å³å¯ï¼Œæˆ‘ä»¬å…ˆæŠŠ gitlab æä¾›çš„é…ç½®æ–‡ä»¶æ‹·è´è¿‡å»</p><pre tabindex=0><code>$ sudo mkdir -p /etc/nginx/conf/sites/
$ sudo cp lib/support/nginx/gitlab /etc/nginx/conf/sites/gitlab.conf
</code></pre><blockquote><p>æ ¹æ® nginx ç‰ˆæœ¬å’Œä¸åŒå‘è¡Œç‰ˆçš„ä¸åŒï¼Œé…ç½®ç»“æ„å¯èƒ½ä¸åŒæ ¹æ®ä½ çš„å®é™…æƒ…å†µåŠ è½½ <code>gitlab.conf</code></p></blockquote><p>ä¿®æ”¹ <code>gitlab.conf</code> çš„ <code>YOUR_SERVER_FQDN</code> ä¸ºä¸Šé¢è®¾ç½®çš„ domainã€‚
æœ€åä¿®æ”¹ <code>nginx.conf</code> æˆ–è€… <code>default.conf</code> åŠ è½½ <code>/etc/nginx/conf/site</code> ä¸‹æ‰€æœ‰ conf æ–‡ä»¶</p><pre tabindex=0><code>http {

	include /etc/nginx/conf/site/*.conf;

	server {
		â€¦
	}
}
</code></pre><p>ä¿å­˜åï¼Œé‡å¯å„ä¸ªæœåŠ¡</p><pre tabindex=0><code>$ sudo service nginx reload
$ sudo service gitlab restart
</code></pre><h2 id=å¼€å§‹-gitlab-ä¹‹æ—…>å¼€å§‹ Gitlab ä¹‹æ—…</h2><p>é…ç½®å¥½ hosts å³å¯è®¿é—® <code>gitlab.dev</code></p><pre tabindex=0><code>$ echo &#34;127.0.0.1 gitlab.dev&#34; &gt;&gt; /etc/hosts
</code></pre><p>é»˜è®¤çš„ç”¨æˆ·åå¯†ç ï¼š</p><pre tabindex=0><code>admin@local.host
5iveL!fe
</code></pre><h2 id=å„ç§å‘>å„ç§å‘</h2><h3 id=1-é”™è¯¯æ—¥å¿—æŠ¥æƒé™é”™è¯¯>1. é”™è¯¯æ—¥å¿—æŠ¥æƒé™é”™è¯¯</h3><pre tabindex=0><code>2013/11/07 00:42:21 [crit] 15875#0: *2 stat() &#34;/home/git/gitlab/public/favicon.ico.html&#34; failed (13: Permission denied), client: 33.33.33.1, server: gitlab.web.lo, request: &#34;GET /favicon.ico HTTP/1.1&#34;, host: &#34;gitlab.web.lo&#34;
2013/11/07 00:42:21 [crit] 15875#0: *2 connect() to unix:/home/git/gitlab/tmp/sockets/gitlab.socket failed (13: Permission denied) while connecting to upstream, client: 33.33.33.1, server: gitlab.web.lo, request: &#34;GET /favicon.ico HTTP/1.1&#34;, upstream: &#34;http://unix:/home/git/gitlab/tmp/sockets/gitlab.socket:/favicon.ico&#34;, host: &#34;gitlab.web.lo&#34;
2013/11/07 00:42:31 [crit] 15875#0: *2 stat() &#34;/home/git/gitlab/public/&#34; failed (13: Permission denied), client: 33.33.33.1, server: gitlab.web.lo, request: &#34;GET / HTTP/1.1&#34;, host: &#34;gitlab.web.lo&#34;
2013/11/07 00:42:31 [crit] 15875#0: *2 stat() &#34;/home/git/gitlab/public//index.html&#34; failed (13: Permission denied), client: 33.33.33.1, server: gitlab.web.lo, request: &#34;GET / HTTP/1.1&#34;, host: &#34;gitlab.web.lo&#34;
2013/11/07 00:42:31 [crit] 15875#0: *2 stat() &#34;/home/git/gitlab/public/.html&#34; failed (13: Permission denied), client: 33.33.33.1, server: gitlab.web.lo, request: &#34;GET / HTTP/1.1&#34;, host: &#34;gitlab.web.lo&#34;
2013/11/07 00:42:31 [crit] 15875#0: *2 connect() to unix:/home/git/gitlab/tmp/sockets/gitlab.socket failed (13: Permission denied) while connecting to upstream, client: 33.33.33.1, server: gitlab.web.lo, request: &#34;GET / HTTP/1.1&#34;, upstream: &#34;http://unix:/home/git/gitlab/tmp/sockets/gitlab.socket:/&#34;, host: &#34;gitlab.web.lo&#34;
2013/11/07 00:42:31 [crit] 15875#0: *2 stat() &#34;/home/git/gitlab/public/favicon.ico&#34; failed (13: Permission denied), client: 33.33.33.1, server: gitlab.web.lo, request: &#34;GET /favicon.ico HTTP/1.1&#34;, host: &#34;gitlab.web.lo&#34;
2013/11/07 00:42:31 [crit] 15875#0: *2 stat() &#34;/home/git/gitlab/public/favicon.ico/index.html&#34; failed (13: Permission denied), client: 33.33.33.1, server: gitlab.web.lo, request: &#34;GET /favicon.ico HTTP/1.1&#34;, host: &#34;gitlab.web.lo&#34;
2013/11/07 00:42:31 [crit] 15875#0: *2 stat() &#34;/home/git/gitlab/public/favicon.ico.html&#34; failed (13: Permission denied), client: 33.33.33.1, server: gitlab.web.lo, request: &#34;GET /favicon.ico HTTP/1.1&#34;, host: &#34;gitlab.web.lo&#34;
2013/11/07 00:42:31 [crit] 15875#0: *2 connect() to unix:/home/git/gitlab/tmp/sockets/gitlab.socket failed (13: Permission denied) while connecting to upstream, client: 33.33.33.1, server: gitlab.web.lo, request: &#34;GET /favicon.ico HTTP/1.1&#34;, upstream: &#34;http://unix:/home/git/gitlab/tmp/sockets/gitlab.socket:/favicon.ico&#34;, host: &#34;gitlab.web.lo&#34;
</code></pre><p>è§£å†³æ–¹æ¡ˆ:</p><pre tabindex=0><code>$ (sudo) chmod o+x /home/git
</code></pre><h3 id=2-8080-ç«¯å£è¢«å ç”¨>2. 8080 ç«¯å£è¢«å ç”¨</h3><p>è¿™æ ·ä¸»è¦æ˜¯å› ä¸º nginx çš„é…ç½®æ˜¯åš unicorn çš„ä»£ç†è½¬å‘ï¼Œå®é™…ä¸Š gitlab æ˜¯ç”± unicorn å®¹å™¨é©±åŠ¨ï¼Œè€Œåœ¨é…ç½®é‡Œé»˜è®¤ç»‘å®šçš„æ˜¯ <code>8080</code> ç«¯å£</p><pre tabindex=0><code>$ vim /home/git/gitlab/config/unicorn.rb
</code></pre><p>æ‰¾åˆ° <code>listen "127.0.0.1:8080", :tcp_nopush => true</code> ä¿®æ”¹æˆå…¶ä»–æœªå ç”¨çš„ç«¯å£å·å³å¯ã€‚</p></div></div><div class=post-nav><a href=https://icyleaf.com/2013/09/network-configuration-in-centos/ class=prev rel=prev title="é…ç½® CentOS çš„ç½‘ç»œè”ç½‘è®¾ç½®"><i class="iconfont icon-left"></i>&nbsp;é…ç½® CentOS çš„ç½‘ç»œè”ç½‘è®¾ç½®</a>
<a href=https://icyleaf.com/2013/10/about-pager-on-git/ class=next rel=next title="Git å’Œ Pager çš„é‚£ç‚¹äº‹">Git å’Œ Pager çš„é‚£ç‚¹äº‹&nbsp;<i class="iconfont icon-right"></i></a></div><div class=post-comment><script>var getTheme=window.localStorage&&window.localStorage.getItem("blog-dark-mode"),getTheme=getTheme??"github-light";let theme=getTheme==="dark"?"github-dark":"github-light",s=document.createElement("script");s.src="https://utteranc.es/client.js",s.setAttribute("repo","icyleaf/icyleaf.com"),s.setAttribute("issue-term","pathname"),s.setAttribute("theme",theme),s.setAttribute("crossorigin","anonymous"),s.setAttribute("async",""),document.querySelector("div.post-comment").innerHTML="",document.querySelector("div.post-comment").appendChild(s)</script></div></article></div></main><footer class=footer><div class=copyright>&copy;
<span itemprop=copyrightYear>2005 - 2024</span>
<span>ğŸº</span>
<span class=author itemprop=copyrightHolder><a href=https://icyleaf.com/>icyleaf</a></span></div></footer><script defer src=https://fastly.jsdelivr.net/npm/jquery@3.6.4/dist/jquery.min.js crossorigin=anonymous></script><script defer src=https://icyleaf.com/js/vendor_main.min.js></script>
<script type=module>
  
  import PhotoSwipeLightbox from '\/photoswipe\/photoswipe-lightbox.esm.js';

  const lightbox = new PhotoSwipeLightbox({
    gallery: '#post-gallery',
    children: 'a.gallery-item',
    pswpModule: () => import('\/photoswipe\/photoswipe.esm.js'),
  });
  lightbox.init();
</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-TKQBZ7R259"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-TKQBZ7R259")</script></div></body></html>